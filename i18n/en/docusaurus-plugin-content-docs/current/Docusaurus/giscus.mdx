---
title: ã€Docusaurusã€‘å¦‚ä½•åœ¨ docusaurus å¢åŠ ç•™è¨€å€
sidebar_position: 3
tags: ["Docusaurus", "Giscus", "Comment"]
---

import { Img } from "@site/src/components/Width";
import image_1 from "/img/docusaurus/giscus-1.png";
import image_2 from "/img/docusaurus/giscus-2.png";
import image_3 from "/img/docusaurus/giscus-3.png";
import image_4 from "/img/docusaurus/giscus-4.png";

import image_6 from "/img/docusaurus/giscus-6.png";
import image_7 from "/img/docusaurus/giscus-7.png";
import image_8 from "/img/docusaurus/giscus-8.png";
import image_9 from "/img/docusaurus/giscus-9.png";
import image_10 from "/img/docusaurus/giscus-10.png";
import image_11 from "/img/docusaurus/giscus-11.png";
import image_12 from "/img/docusaurus/giscus-12.png";

é›–ç„¶ä¸€é–‹å§‹æ‰“æ–‡ç« åªæ˜¯ç‚ºäº†è‡ªå·±çš„å­¸ç¿’ç´€éŒ„ï¼Œä¸éå‘¢ï½é‚„æ˜¯æœƒå¸Œæœ›æœ‰äººçœ‹äº†æ–‡ç« èƒ½å¾—åˆ°å¹«åŠ©ï¼Œæƒ³èªªå¯ä»¥å»ºå€‹ç•™è¨€å€ï¼Œé€™æ¨£å°±å¯ä»¥çœ‹åˆ°ä½¿ç”¨è€…çš„å›é¥‹ã€‚

ä¸éå®˜æ–¹ä¸¦æ²’æœ‰æä¾›å…§å»ºçš„ç•™è¨€ç³»çµ±ï¼Œçˆ¬äº†ä¸€ä¸‹æ–‡ç™¼ç¾å¤§å®¶éƒ½ç”¨ **giscus** ä¾†å»ºç«‹ç•™è¨€å€ï¼Œgiscus æ˜¯ä¸€å€‹å¯é€£æ¥ GitHub Discussion çš„æ‡‰ç”¨ç¨‹å¼ï¼Œé€™ä¸€ç¯‡å°±æ˜¯ä¾†å¸¶å¤§å®¶ä¸€æ­¥æ­¥çš„å»ºç«‹è‡ªå·±çš„ç•™è¨€å€ã€‚

## Step1: Docusaurus swizzle

é¦–å…ˆï¼Œå› ç‚ºè¦å»ºç«‹ç•™è¨€å€åœ¨æ¯ç¯‡æ–‡ç« åº•éƒ¨ï¼Œæ‰€ä»¥éœ€è¦å¾—åˆ° docusaurus çš„ Layout åŸå§‹ componentsï¼Œæ‰èƒ½æŠŠ giscus çš„å…ƒä»¶åŠ åœ¨åº•éƒ¨ã€‚

è€Œ docusaurus æœ‰æä¾› [swizzling](https://docusaurus.io/docs/swizzling) çš„æ–¹æ³•ï¼Œå¯ä»¥æŠŠåŸæœ¬çœ‹ä¸åˆ°çš„é é¢ components è½‰æ›å‡ºä¾†ï¼Œè¼¸å…¥æŒ‡ä»¤

```
npm run swizzle
```

é€™é‚Šé¸æ“‡ `@docusaurus/theme-classic`ï¼Œæˆ‘å€‘è¦çš„é é¢æ¨£å¼åœ¨é€™ä¸€å€ã€‚

<Img src={image_1} />

ç„¶å¾Œé¸æ“‡ `DocItem/Layout`ï¼Œå¯ä»¥çœ‹åˆ°å¾Œé¢æœ‰æ‹¬è™Ÿ **ï¼ˆUnsafeï¼‰**ï¼Œä»£è¡¨ docusaurus ä¸å»ºè­°è½‰æ›é€™å€‹éƒ¨åˆ†çš„ç¨‹å¼ç¢¼ï¼Œå› ç‚ºæ˜¯æ ¸å¿ƒåŠŸèƒ½ï¼Œæ‰€ä»¥å¯èƒ½æœƒä¸å°å¿ƒåˆªæ‰ä¸»è¦é é¢ã€‚

ä¸éå› ç‚ºæˆ‘å€‘éœ€è¦æŠŠç•™è¨€å€åŠ åœ¨ä¸»è¦é é¢åº•ä¸‹ï¼Œæ‰€ä»¥é‚„æ˜¯æŒ‰ä¸‹ enter å°±å°äº†å“ˆå“ˆã€‚

<Img src={image_2} width='500px' />

å†ä¾†æœ‰å…©å€‹è½‰æ›æ–¹å¼ï¼Œä¸€å€‹æ˜¯ `Warp`ä¸€å€‹æ˜¯ `Eject`ã€‚

<Img src={image_3} />

`Warp` æŒ‡çš„æ˜¯æŠŠæ•´å€‹ Layout è®Šæˆä¸€å€‹ wrap çš„ componentï¼Œè½‰æ›å®Œæœƒæ˜¯åƒé€™æ¨£ï¼š

<Img src={image_4} width='500px' />

é€™å€‹æ¯”è¼ƒä¸æœƒæ”¹å‹•åˆ°è£¡é¢ç´°éƒ¨çš„åŠŸèƒ½ï¼Œä½†æ˜¯æˆ‘å€‘éœ€è¦åŠ å…¥åœ¨ç‰¹å®šçš„ä½ç½®ï¼Œæ‰€ä»¥é¸æ“‡ `Eject`ã€‚

æŒ‰ä¸‹ YES ä¹‹å¾Œï¼Œå°±æœƒæŠŠåŸå§‹ç¨‹å¼ç¢¼è½‰æ›å‡ºä¾†ï¼Œæª”æ¡ˆæœƒåœ¨ä½ çš„ `src/theme/DocItem/Layout` åº•ä¸‹ï¼Œæ‰“é–‹ `index.js` æœƒçœ‹åˆ°å®Œæ•´çš„é é¢å…ƒä»¶ã€‚

<Img src={image_6} />

æˆ‘å€‘è¦åŠ çš„ç•™è¨€å€å°±æ˜¯è¦æ”¾åœ¨ `DocItemPaginator` å…ƒä»¶çš„å¾Œé¢ã€‚

<Img src={image_7} width='550px' />

## Step2: ç”Ÿæˆ giscus å…ƒä»¶

æ¥ä¸‹ä¾†åˆ° [giscus](https://giscus.app/zh-TW) å»ºç«‹å®¢è£½åŒ–å…ƒä»¶ï¼Œçœ‹ä½ éœ€è¦ä»€éº¼åŠŸèƒ½ï¼Œä¸¦ä¸”é¸æ“‡ä½ è¦é€£æ¥çš„ Repoã€‚

é€™é‚Šéœ€è¦å…ˆåœ¨ GitHub è¼‰å…¥ giscusï¼Œç¸½å…±æœ‰å…©å€‹æ­¥é©Ÿï¼š

### 1. æ‰“é–‹ Discussion

å› ç‚º giscus æ˜¯é€£æ¥ Repo çš„ Discussionï¼Œæ‰€ä»¥è¦å…ˆåˆ° Settings > General > Features æ‰“é–‹ Discussionsã€‚

<Img src={image_8} />

ç„¶å¾Œå°±å¯åœ¨ä½ çš„ Repo çœ‹åˆ° Discussion çš„æ¬„ä½ã€‚

<Img src={image_9} />

### 2. è¼‰å…¥ giscus

å†ä¾†è¦åœ¨ GitHub è¼‰å…¥ [giscus](https://github.com/apps/giscus)ã€‚

å¯ä»¥é¸æ“‡è¦åœ¨å…¨éƒ¨çš„ Repo éƒ½è¼‰å…¥ giscus é‚„æ˜¯ç‰¹å®šçš„ Repoï¼Œæˆ‘é€™é‚Šæ˜¯é¸æ“‡ç‰¹å®šçš„ Repoã€‚

<Img src={image_10} width='350px' />

è¼‰å…¥å®Œå¾Œå°±å¯ä»¥å›åˆ° [giscus](https://giscus.app/zh-TW) ç”Ÿæˆå®¢è£½åŒ–å…ƒä»¶ï¼Œé¸æ“‡å®Œå¾Œæœƒé•·é€™æ¨£ï¼š

```html
<script
  src="https://giscus.app/client.js"
  data-repo="[åœ¨æ­¤è¼¸å…¥å„²å­˜åº«åç¨±]"
  data-repo-id="[åœ¨æ­¤è¼¸å…¥å„²å­˜åº« ID]"
  data-category="[åœ¨æ­¤è¼¸å…¥åˆ†é¡åç¨±]"
  data-category-id="[åœ¨æ­¤è¼¸å…¥åˆ†é¡ ID]"
  data-mapping="pathname"
  data-strict="0"
  data-reactions-enabled="1"
  data-emit-metadata="0"
  data-input-position="top"
  data-theme="preferred_color_scheme"
  data-lang="zh-TW"
  data-loading="lazy"
  crossorigin="anonymous"
  async
></script>
```

æ˜¯ä¸€å€‹ `<script>`ï¼Œä½†æ˜¯æˆ‘å€‘éœ€è¦å¼•å…¥ componentï¼Œæ‰€ä»¥æ ¹æ“š [giscus-component](https://github.com/giscus/giscus-component) çš„æŒ‡ç¤ºï¼Œè½‰æ›æˆï¼š

```jsx
<Giscus
  id='comments'
  repo='[åœ¨æ­¤è¼¸å…¥å„²å­˜åº«åç¨±]'
  repoId='[åœ¨æ­¤è¼¸å…¥å„²å­˜åº« ID]'
  category='[åœ¨æ­¤è¼¸å…¥åˆ†é¡åç¨±]'
  categoryId='[åœ¨æ­¤è¼¸å…¥åˆ†é¡ ID]'
  mapping='pathname'
  reactionsEnabled='1'
  emitMetadata='0'
  inputPosition='top'
  theme='preferred_color_scheme'
  lang='zh-TW'
  loading='lazy'
/>
```

_P.S.ä¹‹å¾Œå†ä¾†å¯«ä¸€å€‹è½‰æ›æ–¹ä¾¿çš„å°å·¥å…·å¥½äº†ï½_

## Step3: è¼‰å…¥ giscus å…ƒä»¶

ç”Ÿæˆå®Œå…ƒä»¶å¾Œï¼Œè¦åœ¨ docusaurus è¼‰å…¥å…ƒä»¶ï¼Œå› ç‚º docusaurus æ˜¯ç”¨ react åšçš„ï¼Œæ‰€ä»¥éœ€è¦ install `@giscus/react`ï¼Œå¦‚æœä½ æ˜¯ä½¿ç”¨å…¶ä»–æ¡†æ¶ä¹Ÿå¯ä»¥ä¸‹è¼‰ `@giscus/vue` æˆ– `@giscus/svelte`ã€‚

```
npm i @giscus/react
```

ä¸‹è¼‰å®Œå¾Œï¼Œåœ¨å…ˆå‰è½‰æ›çš„ `src/theme/DocItem/Layout/index.js` è£¡é¢å¼•å…¥ `Giscus` componentã€‚

```jsx {4-5,12,23-37} showLineNumbers
import React from "react";
...
import styles from "./styles.module.css";
import Giscus from "@giscus/react";
import { useColorMode } from "@docusaurus/theme-common";

function useDocTOC() {
...
}
export default function DocItemLayout({ children }) {
  const docTOC = useDocTOC();
  const { colorMode } = useColorMode();
  return (
    <div className='row'>
      <div className={clsx("col", !docTOC.hidden && styles.docItemCol)}>
        <DocVersionBanner />
        <div className={styles.docItemContainer}>
          <article>
            ...
          </article>
          <DocItemPaginator />
        </div>
        <br />
        <Giscus
          id='comments'
          repo='[åœ¨æ­¤è¼¸å…¥å„²å­˜åº«åç¨±]'
          repoId='[åœ¨æ­¤è¼¸å…¥å„²å­˜åº« ID]'
          category='[åœ¨æ­¤è¼¸å…¥åˆ†é¡åç¨±]'
          categoryId='[åœ¨æ­¤è¼¸å…¥åˆ†é¡ ID]'
          mapping='pathname'
          reactionsEnabled='1'
          emitMetadata='0'
          inputPosition='top'
          theme={colorMode}
          lang='zh-TW'
          loading='lazy'
        />
      </div>
      {docTOC.desktop && <div className='col col--3'>{docTOC.desktop}</div>}
    </div>
  );
}
```

é€™é‚Š `theme` çš„éƒ¨åˆ†æˆ‘å¸Œæœ›è·Ÿ Docusaurus çš„ä¸»è‰²ä¸€æ¨£ï¼Œæ‰€ä»¥å¼•å…¥ `@docusaurus/theme-common`ï¼Œç”¨ `useColor` å¾—åˆ° Docusaurus çš„ Theme color é€™æ¨£ç•™è¨€å€çš„é¡è‰²å°±æœƒè·Ÿä¸»è‰²ä¸€æ¨£å›‰ï¼

ç„¶å¾Œé‡æ–°è·‘ `npm run start` å°±æœƒåœ¨æ¯ç¯‡æ–‡ç« åº•ä¸‹çœ‹åˆ°ç•™è¨€å€å›‰ ğŸ¥³

<Img src={image_11} width='600px' />

å¯ä»¥æ¸¬è©¦çœ‹çœ‹åœ¨åº•ä¸‹ç•™è¨€ï¼Œç„¶å¾Œåˆ° Discussions å€å¡Šå»ç¢ºèªæœ‰æ²’æœ‰ç•™è¨€æˆåŠŸ

<Img src={image_12} />

æœ‰å•é¡Œéƒ½å¯ä»¥åœ¨åº•ä¸‹ç•™è¨€å–”ï½ï½

## åƒè€ƒè³‡æ–™

[How to add Giscus to your Docs site built with Docusaurus](https://dipakparmar.medium.com/how-to-add-giscus-to-your-docs-site-built-with-docusaurus-d57fa7f8e2f3)
