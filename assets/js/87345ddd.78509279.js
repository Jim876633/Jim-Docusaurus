"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([["7565"],{217:function(e,n,t){t.r(n),t.d(n,{default:()=>m,frontMatter:()=>r,metadata:()=>a,assets:()=>c,toc:()=>d,contentTitle:()=>o});var a=JSON.parse('{"id":"ithome2023/day14","title":"[Day 14] React + Jest API \u6E2C\u8A66","description":"\u9019\u908A\u6211\u4E32\u63A5 https://jsonplaceholder.typicode.com/ API \u4F86\u505A\u6E2C\u8A66\uFF0C\u4E26\u4E14\u4F7F\u7528 @tanstack/react-query","source":"@site/docs/ithome2023/day14.mdx","sourceDirName":"ithome2023","slug":"/ithome2023/day14","permalink":"/ithome2023/day14","draft":false,"unlisted":false,"tags":[{"inline":false,"label":"IT Home 2023","permalink":"/tags/ithome-2023","description":"IT Home \u9435\u4EBA\u8CFD 2023 \u5E74\u7CFB\u5217\u6587\u7AE0"}],"version":"current","lastUpdatedAt":1718173908000,"frontMatter":{"title":"[Day 14] React + Jest API \u6E2C\u8A66","tags":["ithome2023"]},"sidebar":"tutorialSidebar","previous":{"title":"[Day 13] React + Jest \u5F48\u7A97\u6E2C\u8A66 (AI)","permalink":"/ithome2023/day13"},"next":{"title":"[Day 15] React + Jest API \u6E2C\u8A66 (AI)","permalink":"/ithome2023/day15"}}'),i=t("5893"),s=t("65");let r={title:"[Day 14] React + Jest API \u6E2C\u8A66",tags:["ithome2023"]},o=void 0,c={},d=[{value:"\u7A0B\u5F0F\u78BC",id:"\u7A0B\u5F0F\u78BC",level:2},{value:"\u6E2C\u8A66 isLoading \u70BA true",id:"\u6E2C\u8A66-isloading-\u70BA-true",level:2},{value:"\u6E2C\u8A66 isLoading \u70BA false",id:"\u6E2C\u8A66-isloading-\u70BA-false",level:2}];function l(e){let n={a:"a",code:"code",h2:"h2",p:"p",pre:"pre",...(0,s.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.p,{children:["\u9019\u908A\u6211\u4E32\u63A5 ",(0,i.jsx)(n.a,{href:"https://jsonplaceholder.typicode.com/",children:"https://jsonplaceholder.typicode.com/"})," API \u4F86\u505A\u6E2C\u8A66\uFF0C\u4E26\u4E14\u4F7F\u7528 ",(0,i.jsx)(n.a,{href:"https://tanstack.com/query/",children:"@tanstack/react-query"}),"\n\u4F86\u7BA1\u7406 API \u7684\u72C0\u614B\u3002"]}),"\n",(0,i.jsx)(n.h2,{id:"\u7A0B\u5F0F\u78BC",children:"\u7A0B\u5F0F\u78BC"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-jsx",children:'import { useFetchUserData } from "@/api/fetchData";\nimport styled from "./index.module.scss";\n\nexport const ApiPage = () => {\n  const { isLoading, data } = useFetchUserData();\n\n  if (isLoading) {\n    return <p>Loading...</p>;\n  }\n\n  if (data) {\n    return (\n      <div>\n        {data.map((el) => (\n          <div test-id=\'item\' key={el.id} className={styled.list}>\n            <h3>{el.name}</h3>\n            <p>{el.email}</p>\n          </div>\n        ))}\n      </div>\n    );\n  }\n};\n'})}),"\n",(0,i.jsxs)(n.p,{children:["\u9019\u908A\u9700\u8981\u6A21\u64EC API \u72C0\u614B\uFF0C\u6E2C\u8A66\u6709 loading \u8DDF loading \u5B8C\u5F8C\u5F97\u5230\u56DE\u50B3\u7684\u8CC7\u6599\uFF0C\u6240\u4EE5\u9700\u8981\u4F7F\u7528 ",(0,i.jsx)(n.code,{children:"jest.mock"})," \u4F86\u6A21\u64EC ",(0,i.jsx)(n.code,{children:"useFetchUserData()"}),"\u3002"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-jsx",children:'describe("ApiPage", () => {\n  it("\u7576 isLoading \u70BA true \u756B\u9762\u986F\u793A \'Loading...\' \u6587\u5B57", () => {});\n  it("\u7576 isLoading \u70BA false \u756B\u9762\u986F\u793A data \u8CC7\u6599", () => {});\n});\n'})}),"\n",(0,i.jsx)(n.h2,{id:"\u6E2C\u8A66-isloading-\u70BA-true",children:"\u6E2C\u8A66 isLoading \u70BA true"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-jsx",children:'import { render, screen } from "@testing-library/react";\nimport { useFetchUserData } from "@/api/fetchData";\nimport { ApiPage } from "./index";\n\njest.mock("@/api/fetchData");\n\ndescribe("ApiPage", () => {\n  it("\u7576 isLoading \u70BA true \u756B\u9762\u986F\u793A \'Loading...\' \u6587\u5B57", () => {\n    (useFetchUserData as jest.Mock).mockReturnValue({\n      isLoading: true,\n      data: null,\n    });\n\n    render(<ApiPage />);\n    expect(screen.getByText("Loading...")).toBeInTheDocument();\n  });\n});\n\n'})}),"\n",(0,i.jsx)(n.h2,{id:"\u6E2C\u8A66-isloading-\u70BA-false",children:"\u6E2C\u8A66 isLoading \u70BA false"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-jsx",children:'import { render, screen } from "@testing-library/react";\nimport { useFetchUserData } from "@/api/fetchData";\nimport { ApiPage } from "./index";\n\njest.mock("@/api/fetchData");\n\ndescribe("ApiPage", () => {\n  it("\u7576 isLoading \u70BA false \u756B\u9762\u986F\u793A data \u8CC7\u6599", () => {\n    const mockData = [\n      { id: 1, name: "John Doe", email: "john.doe@example.com" },\n      { id: 2, name: "Jane Smith", email: "jane.smith@example.com" },\n    ];\n    (useFetchUserData as jest.Mock).mockReturnValue({\n      isLoading: false,\n      data: mockData,\n    });\n\n    render(<ApiPage />);\n    mockData.forEach((user) => {\n      expect(screen.getByText(user.name)).toBeInTheDocument();\n      expect(screen.getByText(user.email)).toBeInTheDocument();\n    });\n  });\n});\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u5728\u6E2C\u8A66 API \u6642\uFF0C\u9700\u8981\u6A21\u64EC react-query \u7684\u72C0\u614B\uFF0C\u4EE5\u53CA\u56DE\u50B3\u7684\u8CC7\u6599\u4F86\u9032\u884C\u6E2C\u8A66\uFF0C\u4F7F\u7528\u4E0A\u975E\u5E38\u7684\u4E0D\u65B9\u4FBF\uFF0C\u9084\u9700\u8981\u53E6\u5916\u5BEB\u5047\u8CC7\u6599\u4F86\u6E2C\uFF0C\u5F8C\u9762\u6703\u4ECB\u7D39\u4E00\u500B\u597D\u7528\u7684\u5957\u4EF6\u4F86\u5E6B\u52A9\u6211\u5011\u6E2C\u8A66 API\u3002"})]})}function m(e={}){let{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},65:function(e,n,t){t.d(n,{Z:function(){return o},a:function(){return r}});var a=t(7294);let i={},s=a.createContext(i);function r(e){let n=a.useContext(s);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),a.createElement(s.Provider,{value:n},e.children)}}}]);