"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[4703],{1818:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>m,frontMatter:()=>s,metadata:()=>o,toc:()=>d});var a=t(5893),i=t(1151);const s={title:"[Day 14] React + Jest API \u6e2c\u8a66",tags:["ithome2023"]},r=void 0,o={id:"ithome2023/day14",title:"[Day 14] React + Jest API \u6e2c\u8a66",description:"\u9019\u908a\u6211\u4e32\u63a5 https://jsonplaceholder.typicode.com/ API \u4f86\u505a\u6e2c\u8a66\uff0c\u4e26\u4e14\u4f7f\u7528 @tanstack/react-query",source:"@site/docs/ithome2023/day14.mdx",sourceDirName:"ithome2023",slug:"/ithome2023/day14",permalink:"/ithome2023/day14",draft:!1,unlisted:!1,tags:[{inline:!1,label:"IT Home 2023",permalink:"/tags/ithome-2023",description:"IT Home \u9435\u4eba\u8cfd 2023 \u5e74\u7cfb\u5217\u6587\u7ae0"}],version:"current",lastUpdatedAt:1718173908e3,frontMatter:{title:"[Day 14] React + Jest API \u6e2c\u8a66",tags:["ithome2023"]},sidebar:"tutorialSidebar",previous:{title:"[Day 13] React + Jest \u5f48\u7a97\u6e2c\u8a66 (AI)",permalink:"/ithome2023/day13"},next:{title:"[Day 15] React + Jest API \u6e2c\u8a66 (AI)",permalink:"/ithome2023/day15"}},c={},d=[{value:"\u7a0b\u5f0f\u78bc",id:"\u7a0b\u5f0f\u78bc",level:2},{value:"\u6e2c\u8a66 isLoading \u70ba true",id:"\u6e2c\u8a66-isloading-\u70ba-true",level:2},{value:"\u6e2c\u8a66 isLoading \u70ba false",id:"\u6e2c\u8a66-isloading-\u70ba-false",level:2}];function l(e){const n={a:"a",code:"code",h2:"h2",p:"p",pre:"pre",...(0,i.a)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(n.p,{children:["\u9019\u908a\u6211\u4e32\u63a5 ",(0,a.jsx)(n.a,{href:"https://jsonplaceholder.typicode.com/",children:"https://jsonplaceholder.typicode.com/"})," API \u4f86\u505a\u6e2c\u8a66\uff0c\u4e26\u4e14\u4f7f\u7528 ",(0,a.jsx)(n.a,{href:"https://tanstack.com/query/",children:"@tanstack/react-query"}),"\n\u4f86\u7ba1\u7406 API \u7684\u72c0\u614b\u3002"]}),"\n",(0,a.jsx)(n.h2,{id:"\u7a0b\u5f0f\u78bc",children:"\u7a0b\u5f0f\u78bc"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-jsx",children:'import { useFetchUserData } from "@/api/fetchData";\nimport styled from "./index.module.scss";\n\nexport const ApiPage = () => {\n  const { isLoading, data } = useFetchUserData();\n\n  if (isLoading) {\n    return <p>Loading...</p>;\n  }\n\n  if (data) {\n    return (\n      <div>\n        {data.map((el) => (\n          <div test-id=\'item\' key={el.id} className={styled.list}>\n            <h3>{el.name}</h3>\n            <p>{el.email}</p>\n          </div>\n        ))}\n      </div>\n    );\n  }\n};\n'})}),"\n",(0,a.jsxs)(n.p,{children:["\u9019\u908a\u9700\u8981\u6a21\u64ec API \u72c0\u614b\uff0c\u6e2c\u8a66\u6709 loading \u8ddf loading \u5b8c\u5f8c\u5f97\u5230\u56de\u50b3\u7684\u8cc7\u6599\uff0c\u6240\u4ee5\u9700\u8981\u4f7f\u7528 ",(0,a.jsx)(n.code,{children:"jest.mock"})," \u4f86\u6a21\u64ec ",(0,a.jsx)(n.code,{children:"useFetchUserData()"}),"\u3002"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-jsx",children:'describe("ApiPage", () => {\n  it("\u7576 isLoading \u70ba true \u756b\u9762\u986f\u793a \'Loading...\' \u6587\u5b57", () => {});\n  it("\u7576 isLoading \u70ba false \u756b\u9762\u986f\u793a data \u8cc7\u6599", () => {});\n});\n'})}),"\n",(0,a.jsx)(n.h2,{id:"\u6e2c\u8a66-isloading-\u70ba-true",children:"\u6e2c\u8a66 isLoading \u70ba true"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-jsx",children:'import { render, screen } from "@testing-library/react";\nimport { useFetchUserData } from "@/api/fetchData";\nimport { ApiPage } from "./index";\n\njest.mock("@/api/fetchData");\n\ndescribe("ApiPage", () => {\n  it("\u7576 isLoading \u70ba true \u756b\u9762\u986f\u793a \'Loading...\' \u6587\u5b57", () => {\n    (useFetchUserData as jest.Mock).mockReturnValue({\n      isLoading: true,\n      data: null,\n    });\n\n    render(<ApiPage />);\n    expect(screen.getByText("Loading...")).toBeInTheDocument();\n  });\n});\n\n'})}),"\n",(0,a.jsx)(n.h2,{id:"\u6e2c\u8a66-isloading-\u70ba-false",children:"\u6e2c\u8a66 isLoading \u70ba false"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-jsx",children:'import { render, screen } from "@testing-library/react";\nimport { useFetchUserData } from "@/api/fetchData";\nimport { ApiPage } from "./index";\n\njest.mock("@/api/fetchData");\n\ndescribe("ApiPage", () => {\n  it("\u7576 isLoading \u70ba false \u756b\u9762\u986f\u793a data \u8cc7\u6599", () => {\n    const mockData = [\n      { id: 1, name: "John Doe", email: "john.doe@example.com" },\n      { id: 2, name: "Jane Smith", email: "jane.smith@example.com" },\n    ];\n    (useFetchUserData as jest.Mock).mockReturnValue({\n      isLoading: false,\n      data: mockData,\n    });\n\n    render(<ApiPage />);\n    mockData.forEach((user) => {\n      expect(screen.getByText(user.name)).toBeInTheDocument();\n      expect(screen.getByText(user.email)).toBeInTheDocument();\n    });\n  });\n});\n'})}),"\n",(0,a.jsx)(n.p,{children:"\u5728\u6e2c\u8a66 API \u6642\uff0c\u9700\u8981\u6a21\u64ec react-query \u7684\u72c0\u614b\uff0c\u4ee5\u53ca\u56de\u50b3\u7684\u8cc7\u6599\u4f86\u9032\u884c\u6e2c\u8a66\uff0c\u4f7f\u7528\u4e0a\u975e\u5e38\u7684\u4e0d\u65b9\u4fbf\uff0c\u9084\u9700\u8981\u53e6\u5916\u5beb\u5047\u8cc7\u6599\u4f86\u6e2c\uff0c\u5f8c\u9762\u6703\u4ecb\u7d39\u4e00\u500b\u597d\u7528\u7684\u5957\u4ef6\u4f86\u5e6b\u52a9\u6211\u5011\u6e2c\u8a66 API\u3002"})]})}function m(e={}){const{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(l,{...e})}):l(e)}},1151:(e,n,t)=>{t.d(n,{Z:()=>o,a:()=>r});var a=t(7294);const i={},s=a.createContext(i);function r(e){const n=a.useContext(s);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),a.createElement(s.Provider,{value:n},e.children)}}}]);