"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([["288"],{1296:function(e,n,r){r.r(n),r.d(n,{default:()=>h,frontMatter:()=>a,metadata:()=>t,assets:()=>c,toc:()=>m,contentTitle:()=>s});var t=JSON.parse('{"id":"ithome2023/day10","title":"[Day 10] React + Jest \u8DEF\u5F91\u6E2C\u8A66","description":"\u9019\u4E00\u7BC7\u8981\u4F86\u4ECB\u7D39\u600E\u9EBC\u4F7F\u7528 Jest + Testing Library \u4F86\u6E2C\u8A66\u8DEF\u5F91\uFF0C\u6211\u662F\u4F7F\u7528 React Router \u4F86\u505A\u8DEF\u5F91\u7BA1\u7406\u3002","source":"@site/docs/ithome2023/day10.mdx","sourceDirName":"ithome2023","slug":"/ithome2023/day10","permalink":"/ithome2023/day10","draft":false,"unlisted":false,"tags":[{"inline":false,"label":"IT Home 2023","permalink":"/tags/ithome-2023","description":"IT Home \u9435\u4EBA\u8CFD 2023 \u5E74\u7CFB\u5217\u6587\u7AE0"}],"version":"current","lastUpdatedAt":1718173908000,"frontMatter":{"title":"[Day 10] React + Jest \u8DEF\u5F91\u6E2C\u8A66","tags":["ithome2023"]},"sidebar":"tutorialSidebar","previous":{"title":"[Day 09] React + Jest \u8868\u55AE\u9A57\u8B49\u6E2C\u8A66 (AI)","permalink":"/ithome2023/day09"},"next":{"title":"[Day 11] React + Jest \u8DEF\u5F91\u6E2C\u8A66 (AI)","permalink":"/ithome2023/day11"}}'),o=r("5893"),i=r("65");let a={title:"[Day 10] React + Jest \u8DEF\u5F91\u6E2C\u8A66",tags:["ithome2023"]},s=void 0,c={},m=[{value:"Router \u5C0E\u9801\u6E2C\u8A66",id:"router-\u5C0E\u9801\u6E2C\u8A66",level:2},{value:"Navbar \u8DEF\u5F91\u6E2C\u8A66",id:"navbar-\u8DEF\u5F91\u6E2C\u8A66",level:2},{value:"\u7D50\u8AD6",id:"\u7D50\u8AD6",level:2}];function l(e){let n={a:"a",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.a)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(n.p,{children:["\u9019\u4E00\u7BC7\u8981\u4F86\u4ECB\u7D39\u600E\u9EBC\u4F7F\u7528 Jest + Testing Library \u4F86\u6E2C\u8A66\u8DEF\u5F91\uFF0C\u6211\u662F\u4F7F\u7528 ",(0,o.jsx)(n.a,{href:"https://reactrouter.com/en/6.16.0",children:"React Router"})," \u4F86\u505A\u8DEF\u5F91\u7BA1\u7406\u3002"]}),"\n",(0,o.jsx)(n.p,{children:"\u9019\u908A\u6211\u5206\u5169\u500B\u90E8\u5206\uFF0C\u4E00\u500B\u662F router config \u7684\u5C0E\u9801\u6E2C\u8A66\uFF0C\u4E00\u500B\u662F navbar \u7684\u8DEF\u5F91\u6E2C\u8A66\u3002"}),"\n",(0,o.jsx)(n.h2,{id:"router-\u5C0E\u9801\u6E2C\u8A66",children:"Router \u5C0E\u9801\u6E2C\u8A66"}),"\n",(0,o.jsx)(n.p,{children:"router config \u7684\u7D50\u69CB\u6703\u662F\u9577\u9019\u6A23\uFF1A"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:'import { FormPage } from "@/pages/FormPage";\nimport { HomePage } from "@/pages/HomePage";\nimport { Home } from "@/pages/HomePage/Home";\nimport { Navigate } from "react-router-dom";\n\nexport const routerConfig = [\n  {\n    path: "/",\n    element: <Navigate to=\'/home\' />,\n  },\n  {\n    path: "home",\n    element: <HomePage />,\n    children: [\n      { index: true, element: <Home /> },\n      {\n        path: "form",\n        element: <FormPage />,\n      },\n    ],\n  },\n];\n'})}),"\n",(0,o.jsxs)(n.p,{children:["\u8981\u6E2C router config \u6E2C\u8A66\u7684\u662F\u5C0D\u61C9\u8DEF\u5F91\u662F\u5426\u6709\u986F\u793A\u6B63\u78BA\u7684 component\uFF0C\u9019\u908A\u4F7F\u7528 ",(0,o.jsx)(n.code,{children:"jest.mock"})," \u53BB\u6A21\u64EC\u5143\u4EF6\uFF0C\u5C31\u53EF\u4EE5\u907F\u514D\u7576\u5143\u4EF6\u5167\u5BB9\u6539\u8B8A\u6642\uFF0C\u6E2C\u8A66\u4E5F\u8981\u91CD\u5BEB\u7684\u554F\u984C\uFF0C\u6240\u4EE5\u5C0E\u9801\u6E2C\u8A66\u5176\u5BE6\u5C31\u662F\u5728\u6E2C\u8A66",(0,o.jsx)(n.strong,{children:"\u8DEF\u7531\u662F\u5426\u6709\u5C0D\u61C9\u5230\u6B63\u78BA\u7684\u5143\u4EF6\u8DEF\u5F91"}),"\u3002"]}),"\n",(0,o.jsx)(n.p,{children:"\u6E2C\u8A66\u6848\u4F8B\u63CF\u8FF0\uFF1A"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:"describe(\"router testing\", () => {\n  it(\"\u7576 router \u8DEF\u5F91\u70BA '/home' \u986F\u793A 'home page' \u6587\u5B57\", () => {});\n  it(\"\u7576 router \u8DEF\u5F91\u70BA '/home/form' \u986F\u793A 'form page' \u6587\u5B57\", () => {});\n});\n"})}),"\n",(0,o.jsx)(n.p,{children:"\u5B8C\u6574\u6E2C\u8A66\uFF1A"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:'import { render, screen } from "@testing-library/react";\nimport { RouterProvider, createMemoryRouter } from "react-router-dom";\nimport { routerConfig } from ".";\n\n// \u6A21\u64EC\u5143\u4EF6\u56DE\u50B3\njest.mock("@/pages/HomePage/Home/index.tsx", () => {\n  return {\n    Home: () => <div>home page</div>,\n  };\n});\n\njest.mock("@/pages/FormPage/index.tsx", () => {\n  return {\n    FormPage: () => <div>form Page</div>,\n  };\n});\n\n// \u6E2C\u8A66\ndescribe("router testing", () => {\n  it("\u7576 router \u8DEF\u5F91\u70BA \'/home\' \u986F\u793A \'home page\' \u6587\u5B57", () => {\n    const router = createMemoryRouter(routerConfig, {\n      initialEntries: ["/home"],\n    });\n\n    render(<RouterProvider router={router} />);\n\n    expect(screen.getByText(/home page/i)).toBeInTheDocument();\n  });\n\n  it("\u7576 router \u8DEF\u5F91\u70BA \'/home/form\' \u986F\u793A \'form page\' \u6587\u5B57", () => {\n    const router = createMemoryRouter(routerConfig, {\n      initialEntries: ["/home/form"],\n    });\n\n    render(<RouterProvider router={router} />);\n\n    expect(screen.getByText(/form page/i)).toBeInTheDocument();\n  });\n});\n'})}),"\n",(0,o.jsx)(n.p,{children:"\u53EF\u4EE5\u770B\u5230\u6BCF\u500B\u6E2C\u8A66\u6848\u4F8B\u90FD\u6709\u4E00\u500B router \u7684\u521D\u59CB\u5316\u53CA\u6E32\u67D3\u5143\u4EF6\uFF0C\u91CD\u8907\u7684\u5730\u65B9\u6211\u6703\u63D0\u51FA\u4F86\u5BEB\u4E00\u500B function"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:"const renderRouter = (path: string) => {\n  const router = createMemoryRouter(routerConfig, {\n    initialEntries: [path],\n  });\n\n  render(<RouterProvider router={router} />);\n};\n"})}),"\n",(0,o.jsx)(n.p,{children:"\u9019\u6A23\u5C31\u53EF\u4EE5\u8B93\u6E2C\u8A66\u78BC\u66F4\u7C21\u6F54\u3002"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:'describe("router testing", () => {\n  it("\u7576 router \u8DEF\u5F91\u70BA \'/home\' \u986F\u793A \'home page\' \u6587\u5B57", () => {\n    renderRouter("/home");\n\n    expect(screen.getByText(/home page/i)).toBeInTheDocument();\n  });\n\n  it("\u7576 router \u8DEF\u5F91\u70BA \'/home/form\' \u986F\u793A \'form page\' \u6587\u5B57", () => {\n    renderRouter("/home/form");\n\n    expect(screen.getByText(/form page/i)).toBeInTheDocument();\n  });\n});\n'})}),"\n",(0,o.jsx)(n.p,{children:"\u4E0D\u904E\u512A\u5316\u6E2C\u8A66\u78BC\u7684\u90E8\u5206\uFF0C\u5C31\u7B97\u6C92\u505A\u4E5F\u7121\u50B7\u5927\u96C5\uFF0C\u5C24\u5176\u662F\u6642\u7A0B\u5F88\u8D95\u6642\uFF0C\u6709\u5BEB\u6E2C\u8A66\u5C31\u5DF2\u7D93\u5F88\u4E0D\u932F\u4E86\u54C8\u54C8\u3002"}),"\n",(0,o.jsx)(n.h2,{id:"navbar-\u8DEF\u5F91\u6E2C\u8A66",children:"Navbar \u8DEF\u5F91\u6E2C\u8A66"}),"\n",(0,o.jsx)(n.p,{children:"\u90A3\u5728 navbar \u7684\u8DEF\u5F91\u6E2C\u8A66\uFF0C\u6E2C\u8A66\u7684\u662F\u9EDE\u64CA navbar \u7684\u9023\u7D50\uFF0C\u662F\u5426\u6709\u5C0E\u9801\u5230\u6B63\u78BA\u7684\u8DEF\u5F91\u3002"}),"\n",(0,o.jsx)(n.p,{children:"\u6E2C\u8A66\u6848\u4F8B\u63CF\u8FF0\uFF1A"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:"describe(\"navbar testing\", () => {\n  it(\"\u9EDE\u64CA 'home' \u9023\u7D50\uFF0C\u7DB2\u5740\u5C0E\u9801\u5230 '/home' \u8DEF\u5F91\", () => {});\n  it(\"\u9EDE\u64CA 'form' \u9023\u7D50\uFF0C\u7DB2\u5740\u5C0E\u9801\u5230 '/home/form' \u8DEF\u5F91\", () => {});\n});\n"})}),"\n",(0,o.jsxs)(n.p,{children:["\u9700\u8981\u5F15\u5165 ",(0,o.jsx)(n.a,{href:"https://www.npmjs.com/package/history",children:"history"})," \u5957\u4EF6\u4F86\u6A21\u64EC\u8DEF\u7531\u7684\u884C\u70BA\uFF0C\u4E26\u4F7F\u7528 ",(0,o.jsx)(n.code,{children:"history.location.pathname"})," \u4F86\u53D6\u5F97\u7576\u524D\u8DEF\u5F91\u3002"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"npm install --save-dev history\n"})}),"\n",(0,o.jsx)(n.p,{children:"\u5B8C\u6574\u6E2C\u8A66\uFF1A"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:'import { render, screen } from "@testing-library/react";\nimport userEvent from "@testing-library/user-event";\nimport { MemoryHistory, createMemoryHistory } from "history";\nimport { Router } from "react-router-dom";\nimport { Navbar } from ".";\n\ndescribe("navbar testing", () => {\n  let history: MemoryHistory;\n  const user = userEvent.setup();\n  beforeEach(() => {\n    history = createMemoryHistory();\n    render(\n      <Router location=\'/home\' navigator={history}>\n        <Navbar />\n      </Router>\n    );\n  });\n\n  it("\u9EDE\u64CA \'home\' \u9023\u7D50\uFF0C\u7DB2\u5740\u5C0E\u9801\u5230 \'/home\' \u8DEF\u5F91", async () => {\n    const homeLink = screen.getByText(/home/i);\n    expect(homeLink).toBeInTheDocument();\n    await user.click(homeLink);\n    expect(history.location.pathname).toBe("/home");\n  });\n\n  it("\u9EDE\u64CA \'form\' \u9023\u7D50\uFF0C\u7DB2\u5740\u5C0E\u9801\u5230 \'/home/form\' \u8DEF\u5F91", async () => {\n    const button = screen.getByText(/form/i);\n    await user.click(button);\n    expect(history.location.pathname).toBe("/home/form");\n  });\n});\n'})}),"\n",(0,o.jsx)(n.h2,{id:"\u7D50\u8AD6",children:"\u7D50\u8AD6"}),"\n",(0,o.jsx)(n.p,{children:"\u53EF\u4EE5\u770B\u5230\u6211\u628A\u9EDE\u64CA\u9023\u7D50\u7684\u884C\u70BA\u5206\u6210\u5169\u500B\u90E8\u5206\u4F86\u6E2C\u8A66"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"\u6E2C\u8A66\u5143\u4EF6\u662F\u5426\u986F\u793A\u6B63\u78BA"}),"\n",(0,o.jsx)(n.li,{children:"\u8A66\u9EDE\u64CA\u9023\u7D50\u7DB2\u5740\u662F\u5426\u6B63\u78BA"}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"\u9019\u6A23\u7684\u597D\u8655\u662F\u80FD\u8B93\u6E2C\u8A66\u9805\u76EE\u66F4\u52A0\u55AE\u7D14\uFF0C\u4E5F\u80FD\u66F4\u5FEB\u901F\u7684\u627E\u5230\u554F\u984C\u3002"})]})}function h(e={}){let{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}},65:function(e,n,r){r.d(n,{Z:function(){return s},a:function(){return a}});var t=r(7294);let o={},i=t.createContext(o);function a(e){let n=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:a(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);