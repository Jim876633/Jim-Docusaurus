"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([["1337"],{1265:function(e,n,r){r.r(n),r.d(n,{default:()=>m,frontMatter:()=>i,metadata:()=>t,assets:()=>o,toc:()=>l,contentTitle:()=>c});var t=JSON.parse('{"id":"ithome2023/day17","title":"[Day 17] React + Jest API (MSW) \u6E2C\u8A66","description":"\u4E0A\u7BC7\u8B1B\u4E86\u5982\u4F55\u5728\u958B\u767C\u4E0A\u5C0E\u5165 MSW\uFF0C\u9019\u7BC7\u8981\u4F86\u4ECB\u7D39\u5982\u4F55\u5728\u6E2C\u8A66\u4E0A\u4F7F\u7528 MSW\u3002","source":"@site/docs/ithome2023/day17.mdx","sourceDirName":"ithome2023","slug":"/ithome2023/day17","permalink":"/ithome2023/day17","draft":false,"unlisted":false,"tags":[{"inline":false,"label":"IT Home 2023","permalink":"/tags/ithome-2023","description":"IT Home \u9435\u4EBA\u8CFD 2023 \u5E74\u7CFB\u5217\u6587\u7AE0"}],"version":"current","lastUpdatedAt":1718173908000,"frontMatter":{"title":"[Day 17] React + Jest API (MSW) \u6E2C\u8A66","tags":["ithome2023"]},"sidebar":"tutorialSidebar","previous":{"title":"[Day 16] MSW \u4ECB\u7D39","permalink":"/ithome2023/day16"},"next":{"title":" [Day 18] React + Jest API (MSW) \u6E2C\u8A66 (AI)","permalink":"/ithome2023/day18"}}'),s=r("5893"),a=r("65");let i={title:"[Day 17] React + Jest API (MSW) \u6E2C\u8A66",tags:["ithome2023"]},c=void 0,o={},l=[{value:"\u6E2C\u8A66\u5C0E\u5165 MSW",id:"\u6E2C\u8A66\u5C0E\u5165-msw",level:2},{value:"\u6E2C\u8A66 API",id:"\u6E2C\u8A66-api",level:2},{value:"\u7D50\u8AD6",id:"\u7D50\u8AD6",level:2}];function d(e){let n={a:"a",code:"code",h2:"h2",p:"p",pre:"pre",...(0,a.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.p,{children:"\u4E0A\u7BC7\u8B1B\u4E86\u5982\u4F55\u5728\u958B\u767C\u4E0A\u5C0E\u5165 MSW\uFF0C\u9019\u7BC7\u8981\u4F86\u4ECB\u7D39\u5982\u4F55\u5728\u6E2C\u8A66\u4E0A\u4F7F\u7528 MSW\u3002"}),"\n",(0,s.jsx)(n.h2,{id:"\u6E2C\u8A66\u5C0E\u5165-msw",children:"\u6E2C\u8A66\u5C0E\u5165 MSW"}),"\n",(0,s.jsxs)(n.p,{children:["\u9996\u5148\u5728 ",(0,s.jsx)(n.code,{children:"src/mocks"})," \u5EFA\u7ACB\u4E00\u500B ",(0,s.jsx)(n.code,{children:"server.js"})," \u5167\u5BB9\u8DDF ",(0,s.jsx)(n.code,{children:"browser.js"})," \u4E00\u6A23\uFF1A"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:'// src/mocks/server.js\nimport { setupServer } from "msw/node";\nimport { handlers } from "./handlers";\n\nexport const server = setupServer(...handlers);\n'})}),"\n",(0,s.jsxs)(n.p,{children:["\u5DEE\u5225\u5728\u65BC ",(0,s.jsx)(n.code,{children:"server.js"})," \u8A2D\u7F6E server \u662F\u7528 ",(0,s.jsx)(n.code,{children:"msw/node"})," \u7D66 Node.js \u74B0\u5883\u4F7F\u7528\uFF0C",(0,s.jsx)(n.code,{children:"browser.js"})," \u5247\u662F\u4F7F\u7528 ",(0,s.jsx)(n.code,{children:"msw"})," \u7D66\u700F\u89BD\u5668\u74B0\u5883\u4F7F\u7528\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:["\u63A5\u8457\u5728 ",(0,s.jsx)(n.code,{children:"src/setupTests.js"})," \u5F15\u5165 ",(0,s.jsx)(n.code,{children:"server.js"}),"\uFF1A"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:'// src/setupTests.js\nimport "@testing-library/jest-dom";\nimport { server } from "./mocks/server";\n\nbeforeAll(() => server.listen());\nafterEach(() => server.resetHandlers());\nafterAll(() => server.close());\n'})}),"\n",(0,s.jsx)(n.p,{children:"\u9019\u908A\u5C31\u662F\u5728\u5168\u57DF\u7684\u6E2C\u8A66\u8A2D\u7F6E\u4E2D\uFF0C\u5728\u6BCF\u6B21\u6E2C\u8A66\u524D\u958B\u555F server\uFF0C\u6BCF\u6B21\u6E2C\u8A66\u5F8C\u91CD\u7F6E server\uFF0C\u6700\u5F8C\u5728\u6240\u6709\u6E2C\u8A66\u7D50\u675F\u5F8C\u95DC\u9589 server\uFF0C\u9019\u6A23\u5C31\u53EF\u4EE5\u5728\u8DD1\u6E2C\u8A66\u6642\u4F7F\u7528 MSW \u4E86\uFF01"}),"\n",(0,s.jsx)(n.h2,{id:"\u6E2C\u8A66-api",children:"\u6E2C\u8A66 API"}),"\n",(0,s.jsxs)(n.p,{children:["\u6211\u4EE5 ",(0,s.jsx)(n.a,{href:"https://github.com/Jim876633/ithome-2023/tree/main/day14",children:"Day14"})," \u70BA\u7BC4\u4F8B\uFF0C\u5728\u539F\u672C\u7684\u6E2C\u8A66\u4E2D\u9700\u8981\u81EA\u5DF1\u6A21\u64EC\u5047\u8CC7\u6599\uFF1A"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:'import { render, screen } from "@testing-library/react";\nimport { useFetchUserData } from "@/api/fetchData";\nimport { ApiPage } from "./index";\n\njest.mock("@/api/fetchData");\n\ndescribe("ApiPage", () => {\n  it("\u7576 isLoading \u70BA false \u756B\u9762\u986F\u793A data \u8CC7\u6599", () => {\n    const mockData = [\n      { id: 1, name: "John Doe", email: "john.doe@example.com" },\n      { id: 2, name: "Jane Smith", email: "jane.smith@example.com" },\n    ];\n    (useFetchUserData as jest.Mock).mockReturnValue({\n      isLoading: false,\n      data: mockData,\n    });\n\n    render(<ApiPage />);\n    mockData.forEach((user) => {\n      expect(screen.getByText(user.name)).toBeInTheDocument();\n      expect(screen.getByText(user.email)).toBeInTheDocument();\n    });\n  });\n});\n'})}),"\n",(0,s.jsx)(n.p,{children:"\u4F7F\u7528 MSW \u5F8C\uFF0C\u53EF\u4EE5\u76F4\u63A5\u4F7F\u7528\u5BEB\u597D\u7684 handler \u4F86\u6A21\u64EC\u5047\u8CC7\u6599\uFF1A"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:'import { render, screen } from "@testing-library/react";\nimport { useFetchUserData } from "@/api/fetchData";\nimport { ApiPage } from "./index";\nimport { fakerUserList } from "@/mocks/handlers";\n\njest.mock("@/api/fetchData");\n\ndescribe("ApiPage", () => {\n  it("\u7576 isLoading \u70BA false \u756B\u9762\u986F\u793A data \u8CC7\u6599", () => {\n    // \u9019\u908A\u76F4\u63A5\u4F7F\u7528 handler \u4E2D\u7684\u5047\u8CC7\u6599\n    const mockData = fakerUserList;\n    (useFetchUserData as jest.Mock).mockReturnValue({\n      isLoading: false,\n      data: mockData,\n    });\n\n    render(<ApiPage />);\n    mockData.forEach((user) => {\n      expect(screen.getByText(user.name)).toBeInTheDocument();\n      expect(screen.getByText(user.email)).toBeInTheDocument();\n    });\n  });\n});\n'})}),"\n",(0,s.jsx)(n.p,{children:"\u662F\u4E0D\u662F\u5C31\u65B9\u4FBF\u8A31\u591A\u4E86\u5462\uFF01"}),"\n",(0,s.jsx)(n.h2,{id:"\u7D50\u8AD6",children:"\u7D50\u8AD6"}),"\n",(0,s.jsx)(n.p,{children:"\u4E0D\u7BA1\u6709\u6C92\u6709\u5728\u958B\u767C\u4E0A\u5C0E\u5165 MSW\uFF0C\u90FD\u53EF\u4EE5\u5728\u6E2C\u8A66\u4E0A\u505A\u4F7F\u7528\uFF0C\u9664\u4E86\u53EF\u4EE5\u65B9\u4FBF\u6A21\u64EC\u56DE\u50B3\u5916\uFF0C\u4E5F\u66F4\u65B9\u4FBF\u5730\u7BA1\u7406\u9019\u4E9B\u5047\u8CC7\u6599\u3002\u4E0D\u904E\u500B\u4EBA\u9084\u662F\u559C\u6B61\u5728\u958B\u767C\u6642\u4E00\u8D77\u505A\u4F7F\u7528\uFF0C\u9019\u6A23\u5F97\u5230\u7684\u6210\u6548\u6703\u66F4\u597D\u3002"})]})}function m(e={}){let{wrapper:n}={...(0,a.a)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},65:function(e,n,r){r.d(n,{Z:function(){return c},a:function(){return i}});var t=r(7294);let s={},a=t.createContext(s);function i(e){let n=t.useContext(a);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),t.createElement(a.Provider,{value:n},e.children)}}}]);