"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[4424],{343:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>g,contentTitle:()=>b,default:()=>w,frontMatter:()=>f,metadata:()=>m,toc:()=>y});var s=n(5893),r=n(1151),a=n(5397),c=n(676);const i=n.p+"assets/images/code-file-4a7bb04c29b0d8b5f6310c4bb01dd530.jpg",l=n.p+"assets/images/code-structure-d528a79991b1c4b34239ba2e79af9536.jpg",o=n.p+"assets/images/use-sync-external-store-aae6c790b92b767f751ea0c7a3aff8c2.jpg",d=n.p+"assets/images/update-flow-967b6b62d20ac5e7a3302f0cebca6867.gif",u=n.p+"assets/images/muti-component-flow-4f3d858786b3f0a399ad53c916acecd8.gif",h=n.p+"assets/images/counter-two-component-1f91b996c01e9dff93c6bfcfb8a8cf22.gif",x=n.p+"assets/images/mvc-problem-6c68826c5322aefe4d904b59e31f7cb3.jpg",p=n.p+"assets/images/flux-flow-61e705f06287ccfbaa6e59f5b958145b.png",j=n.p+"assets/images/fb-message-block-6ff5ff6f29dbc170f194443c2085f871.png",S=n.p+"assets/images/redux-flow-49fa8c3968371d9ef6f2a1486bd40a26.gif",f={title:"\u3010React\u3011\u5f9e zustand \u539f\u59cb\u78bc\u4e86\u89e3\u72c0\u614b\u7ba1\u7406",sidebar_label:"Zustand \u539f\u59cb\u78bc\u89e3\u6790",sidebar_position:3,tags:["react","zustand","source-code"]},b=void 0,m={id:"react/zustand-source-code",title:"\u3010React\u3011\u5f9e zustand \u539f\u59cb\u78bc\u4e86\u89e3\u72c0\u614b\u7ba1\u7406",description:"Zustand \u7684\u4ecb\u7d39\u53ef\u4ee5\u5148\u770b\u9019\u7bc7\uff0c\u9019\u4e00\u7bc7\u4e3b\u8981\u662f\u900f\u904e\u95b1\u8b80 zustand \u7684\u539f\u59cb\u78bc\u4f86\u4e86\u89e3\u5b83\u7684\u904b\u4f5c\u539f\u7406\u3002\u6703\u60f3\u8981\u5beb\u9019\u7bc7\u662f\u56e0\u70ba\u4f7f\u7528\u5957\u4ef6\u5927\u5bb6\u90fd\u5df2\u7d93\u7fd2\u4ee5\u70ba\u5e38\uff0c\u4f46\u5957\u4ef6\u5230\u5e95\u5e6b\u6211\u5011\u505a\u4e86\u4ec0\u9ebc\u4e8b\u76f8\u4fe1\u5927\u90e8\u5206\u7684\u4eba\uff08\u5305\u62ec\u6211\uff09\u5e73\u5e38\u662f\u4e0d\u6703\u7279\u5225\u53bb\u4e86\u89e3\u7684\uff0c\u60f3\u8981\u770b\u5957\u4ef6\u7684\u539f\u59cb\u78bc\uff0c\u5f88\u591a\u53c8\u592a\u8271\u6f80\u96e3\u4ee5\u5480\u56bc\u3002",source:"@site/docs/react/zustand-source-code.mdx",sourceDirName:"react",slug:"/react/zustand-source-code",permalink:"/react/zustand-source-code",draft:!1,unlisted:!1,tags:[{inline:!1,label:"React",permalink:"/tags/react"},{inline:!1,label:"Zustand",permalink:"/tags/zustand"},{inline:!1,label:"Source Code",permalink:"/tags/source-code"}],version:"current",lastUpdatedAt:1718887991e3,sidebarPosition:3,frontMatter:{title:"\u3010React\u3011\u5f9e zustand \u539f\u59cb\u78bc\u4e86\u89e3\u72c0\u614b\u7ba1\u7406",sidebar_label:"Zustand \u539f\u59cb\u78bc\u89e3\u6790",sidebar_position:3,tags:["react","zustand","source-code"]},sidebar:"tutorialSidebar",previous:{title:"Zustand",permalink:"/react/zustand"},next:{title:"TypeScript",permalink:"/category/typescript"}},g={},y=[{value:"\u539f\u59cb\u78bc\u89e3\u6790",id:"\u539f\u59cb\u78bc\u89e3\u6790",level:2},{value:"create (react.ts)",id:"create-reactts",level:3},{value:"createStore (vanilla.ts)",id:"createstore-vanillats",level:3},{value:"useStore (react.ts)",id:"usestore-reactts",level:3},{value:"useSyncExternalStore",id:"usesyncexternalstore",level:3},{value:"zustand \u5167\u90e8\u8a02\u95b1\u6d41\u7a0b\u5716",id:"zustand-\u5167\u90e8\u8a02\u95b1\u6d41\u7a0b\u5716",level:3},{value:"zustand \u66f4\u65b0 state \u6d41\u7a0b\u5716",id:"zustand-\u66f4\u65b0-state-\u6d41\u7a0b\u5716",level:3},{value:"zustand \u6fc3\u7e2e\u7248",id:"zustand-\u6fc3\u7e2e\u7248",level:2},{value:"zustand \u67b6\u69cb\u6a21\u5f0f",id:"zustand-\u67b6\u69cb\u6a21\u5f0f",level:2},{value:"Flux",id:"flux",level:3},{value:"Redux",id:"redux",level:3},{value:"\u7e3d\u7d50",id:"\u7e3d\u7d50",level:2},{value:"\u53c3\u8003\u8cc7\u6599",id:"\u53c3\u8003\u8cc7\u6599",level:2}];function v(e){const t={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(t.p,{children:["Zustand \u7684\u4ecb\u7d39\u53ef\u4ee5\u5148\u770b",(0,s.jsx)(t.a,{href:"/react/zustand",children:"\u9019\u7bc7"}),"\uff0c\u9019\u4e00\u7bc7\u4e3b\u8981\u662f\u900f\u904e\u95b1\u8b80 zustand \u7684\u539f\u59cb\u78bc\u4f86\u4e86\u89e3\u5b83\u7684\u904b\u4f5c\u539f\u7406\u3002\u6703\u60f3\u8981\u5beb\u9019\u7bc7\u662f\u56e0\u70ba\u4f7f\u7528\u5957\u4ef6\u5927\u5bb6\u90fd\u5df2\u7d93\u7fd2\u4ee5\u70ba\u5e38\uff0c\u4f46\u5957\u4ef6\u5230\u5e95\u5e6b\u6211\u5011\u505a\u4e86\u4ec0\u9ebc\u4e8b\u76f8\u4fe1\u5927\u90e8\u5206\u7684\u4eba\uff08\u5305\u62ec\u6211\uff09\u5e73\u5e38\u662f\u4e0d\u6703\u7279\u5225\u53bb\u4e86\u89e3\u7684\uff0c\u60f3\u8981\u770b\u5957\u4ef6\u7684\u539f\u59cb\u78bc\uff0c\u5f88\u591a\u53c8\u592a\u8271\u6f80\u96e3\u4ee5\u5480\u56bc\u3002"]}),"\n",(0,s.jsx)(t.p,{children:"\u800c zustnad \u5c31\u662f\u4e00\u500b\u5f88\u597d\u5165\u9580\u7684\u5957\u4ef6\uff0c\u5b83\u7684\u539f\u59cb\u78bc\u4e0d\u591a\uff0c\u5927\u90e8\u5206\u90fd\u883b\u5bb9\u6613\u770b\u61c2\uff08\u6487\u9664 Typescript \u7684\u90e8\u5206\uff09\uff0c\u770b\u5b8c\u4e5f\u6703\u8b93\u4f60\u5c0d\u72c0\u614b\u7ba1\u7406\u6709\u66f4\u6df1\u7684\u4e86\u89e3\uff0c\u53ef\u4ee5\u8aaa\u662f\u521d\u6b21\u95b1\u8b80\u539f\u59cb\u78bc\u7684\u597d\u9078\u64c7\uff0c\u5c31\u8b93\u6211\u5011\u4f86\u597d\u597d\u4e86\u89e3 zustand \u662f\u5982\u4f55\u505a\u5230 React \u72c0\u614b\u7ba1\u7406\u5427\uff01"}),"\n",(0,s.jsx)(t.h2,{id:"\u539f\u59cb\u78bc\u89e3\u6790",children:"\u539f\u59cb\u78bc\u89e3\u6790"}),"\n",(0,s.jsxs)(t.p,{children:["zustand \u7684\u6838\u5fc3\u539f\u59cb\u78bc\u4e3b\u8981\u662f\u5728 ",(0,s.jsx)(t.code,{children:"src"})," \u5e95\u4e0b\u7684 ",(0,s.jsx)(t.code,{children:"react.ts"})," \u4ee5\u53ca ",(0,s.jsx)(t.code,{children:"vanilla.ts"})," \u9019\u5169\u652f\u6a94\u6848\uff0c\u9019\u908a\u4ee5 ",(0,s.jsx)(t.a,{href:"https://github.com/pmndrs/zustand/tree/v4.5.1/src",children:"v4.5.1"})," \u7684\u7248\u672c\u70ba\u4f8b\u3002"]}),"\n",(0,s.jsx)(a.Ei,{src:i,width:"300px",center:!0}),"\n",(0,s.jsx)(t.p,{children:"\u800c\u9019\u5169\u652f\u6a94\u6848\u7e3d\u5171\u6709\u4e09\u500b\u4e3b\u8981\u7684 function:"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"create"})," (react.ts)\uff1azustand \u7684\u6838\u5fc3 function\uff0c\u7528\u4f86\u5efa\u7acb store\u3002"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"useStore"})," (react.ts)\uff1a\u8655\u7406\u540c\u6b65 React \u5167\u90e8\u53ca\u5916\u90e8\u7684 state \u72c0\u614b\u3002"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"createState"})," (vanilla.ts)\uff1a\u5efa\u7acb\u5168\u57df\u7684 state \u53ca\u5efa\u7acb\u8a02\u95b1\u6a21\u5f0f\u3002"]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"\u4ed6\u5011\u4e4b\u9593\u7684\u95dc\u806f\u6027\u6703\u50cf\u9019\u6a23\uff1a"}),"\n",(0,s.jsx)(a.Ei,{src:l}),"\n",(0,s.jsx)(t.h3,{id:"create-reactts",children:"create (react.ts)"}),"\n",(0,s.jsxs)(t.p,{children:["\u9996\u5148\u4f86\u770b\u4e00\u4e0b ",(0,s.jsx)(t.a,{href:"https://github.com/pmndrs/zustand/blob/6109bc3bd0f3850c2d9546956de971f27834ac7a/src/react.ts#L124",children:"create"})," \u7684\u90e8\u5206\uff1a"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-ts",children:"export const create = (<T>(createState: StateCreator<T, [], []> | undefined) =>\n  createState ? createImpl(createState) : createImpl) as Create;\n"})}),"\n",(0,s.jsxs)(t.p,{children:["\u4ed6\u56de\u50b3\u4e86\u4e00\u500b ",(0,s.jsx)(t.code,{children:"createImpl"})," \u7684 function\uff0c\u9019\u500b function \u5b9a\u7fa9\u4e86\u4e00\u500b\u53eb api \u7684\u7269\u4ef6\uff0c\u662f\u547c\u53eb ",(0,s.jsx)(t.code,{children:"createStore"})," \u7684\u56de\u50b3\u503c\u3002"]}),"\n",(0,s.jsxs)(t.p,{children:["\u7136\u5f8c\u5efa\u7acb\u4e00\u500b ",(0,s.jsx)(t.code,{children:"useBoundStore"})," \u7684 function\uff0c\u9019\u500b function \u6703\u56de\u50b3 ",(0,s.jsx)(t.code,{children:"useStore"})," \uff0c\u4e26\u4e14\u628a api \u7269\u4ef6\u50b3\u5165 ",(0,s.jsx)(t.code,{children:"useStore"}),"\u3002"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-ts",metastring:"{10-11,13-14}",children:'const createImpl = <T>(createState: StateCreator<T, [], []>) => {\n  if (\n    import.meta.env?.MODE !== "production" &&\n    typeof createState !== "function"\n  ) {\n    console.warn(\n      "[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from \'zustand\'`."\n    );\n  }\n  const api =\n    typeof createState === "function" ? createStore(createState) : createState;\n\n  const useBoundStore: any = (selector?: any, equalityFn?: any) =>\n    useStore(api, selector, equalityFn);\n\n  Object.assign(useBoundStore, api);\n\n  return useBoundStore;\n};\n'})}),"\n",(0,s.jsx)(t.h3,{id:"createstore-vanillats",children:"createStore (vanilla.ts)"}),"\n",(0,s.jsxs)(t.p,{children:["\u63a5\u8457\u4f86\u770b\u4e00\u4e0b ",(0,s.jsx)(t.a,{href:"https://github.com/pmndrs/zustand/blob/6109bc3bd0f3850c2d9546956de971f27834ac7a/src/vanilla.ts#L109",children:"createStore"}),"\uff1a"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-ts",children:"export const createStore = ((createState) =>\n  createState ? createStoreImpl(createState) : createStoreImpl) as CreateStore;\n"})}),"\n",(0,s.jsxs)(t.p,{children:["\u4e00\u6a23\u56de\u50b3\u4e86\u4e00\u500b ",(0,s.jsx)(t.code,{children:"createStoreImpl"})," \u7684 fucntion\uff1a"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-ts",metastring:"{4-5,20,29-33}",children:'const createStoreImpl: CreateStoreImpl = (createState) => {\n  type TState = ReturnType<typeof createState>;\n  type Listener = (state: TState, prevState: TState) => void;\n  let state: TState;\n  const listeners: Set<Listener> = new Set();\n\n  const setState: StoreApi<TState>["setState"] = (partial, replace) => {\n    // TODO: Remove type assertion once https://github.com/microsoft/TypeScript/issues/37663 is resolved\n    // https://github.com/microsoft/TypeScript/issues/37663#issuecomment-759728342\n    const nextState =\n      typeof partial === "function"\n        ? (partial as (state: TState) => TState)(state)\n        : partial;\n    if (!Object.is(nextState, state)) {\n      const previousState = state;\n      state =\n        replace ?? (typeof nextState !== "object" || nextState === null)\n          ? (nextState as TState)\n          : Object.assign({}, state, nextState);\n      listeners.forEach((listener) => listener(state, previousState));\n    }\n  };\n\n  const getState: StoreApi<TState>["getState"] = () => state;\n\n  const getInitialState: StoreApi<TState>["getInitialState"] = () =>\n    initialState;\n\n  const subscribe: StoreApi<TState>["subscribe"] = (listener) => {\n    listeners.add(listener);\n    // Unsubscribe\n    return () => listeners.delete(listener);\n  };\n\n  const destroy: StoreApi<TState>["destroy"] = () => {\n    if (import.meta.env?.MODE !== "production") {\n      console.warn(\n        "[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."\n      );\n    }\n    listeners.clear();\n  };\n\n  const api = { setState, getState, getInitialState, subscribe, destroy };\n  const initialState = (state = createState(setState, getState, api));\n  return api as any;\n};\n'})}),"\n",(0,s.jsxs)(t.p,{children:["\u9996\u5148\u53ef\u4ee5\u770b\u5230\u4ed6\u5ba3\u544a\u4e86\u4e00\u500b ",(0,s.jsx)(t.code,{children:"state"})," \u8b8a\u6578\uff0c\u9019\u500b\u8b8a\u6578\u662f\u7528\u4f86\u5b58\u653e\u5168\u57df\u7684 state \u503c\uff0c\u7136\u5f8c\u5efa\u7acb\u4e86\u4e00\u500b ",(0,s.jsx)(t.code,{children:"listeners"})," \u7684 Set \u7269\u4ef6\uff0c\u7528\u4f86\u5b58\u653e\u8a02\u95b1\u7684 function\u3002"]}),"\n",(0,s.jsx)(t.p,{children:"createStore \u7684\u91cd\u9ede\u5728\u65bc\u4ed6\u5efa\u7acb\u4e86\u8207\u8a02\u95b1\u6a21\u5f0f\u76f8\u95dc\u7684 function\uff1a"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"setState"}),"\uff1a\u7528\u4f86\u66f4\u65b0 state \u7684 function\u3002"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"getState"}),"\uff1a\u53d6\u5f97\u76ee\u524d\u7684 state\u3002"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"getInitialState"}),"\uff1a\u53d6\u5f97\u521d\u59cb\u7684 state\u3002"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"subscribe"}),"\uff1a\u8a02\u95b1 state \u7684\u8b8a\u5316\u3002"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"destroy"}),"\uff1a\u92b7\u6bc0\u8a02\u95b1\u3002"]}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.code,{children:"getState"})," \u8ddf ",(0,s.jsx)(t.code,{children:"getInitialState"})," \u90fd\u883b\u597d\u7406\u89e3\u7684\uff0c\u5c31\u662f\u53d6\u5f97\u76ee\u524d\u7684 state \u8ddf\u521d\u59cb\u7684 state\u3002\n",(0,s.jsx)(t.code,{children:"setState"})," \u6709\u505a\u4e00\u5c64\u5224\u65b7\uff0c\u5982\u679c\u65b0\u7684\u503c\u8ddf\u820a\u7684\u503c\u4e0d\u540c\uff08\u4f7f\u7528 Object.is \u5224\u65b7\uff09\uff0c\u5c31\u6703\u53bb forEach listeners \u88e1\u9762\u5132\u5b58\u7684\u6240\u6709 function\uff0c\u9019\u4e9b function \u6211\u7a31\u4e4b\u70ba",(0,s.jsx)(c.Z,{children:"\u66f4\u65b0\u51fd\u5f0f"}),"\uff0c\u5f8c\u9762\u6703\u518d\u8aaa\u660e\u66f4\u65b0\u51fd\u5f0f\u662f\u4ec0\u9ebc\u3002\n",(0,s.jsx)(t.code,{children:"subscribe"})," \u5c31\u662f\u628a\u66f4\u65b0\u51fd\u5f0f\u52a0\u5165 listeners \u88e1\u9762\uff0c\u4e26\u4e14\u56de\u50b3\u4e00\u500b function \u7528\u4f86\u53d6\u6d88\u8a02\u95b1\u3002"]}),"\n",(0,s.jsx)(t.h3,{id:"usestore-reactts",children:"useStore (react.ts)"}),"\n",(0,s.jsxs)(t.p,{children:["\u6700\u5f8c\u4e00\u500b function \u662f ",(0,s.jsx)(t.a,{href:"https://github.com/pmndrs/zustand/blob/6109bc3bd0f3850c2d9546956de971f27834ac7a/src/react.ts#L53",children:"useStore"})," \u53ef\u4ee5\u8aaa\u662f zustand \u7684\u6838\u5fc3 function\uff1a"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-ts",metastring:"{16-22}",children:'export function useStore<TState, StateSlice>(\n  api: WithReact<StoreApi<TState>>,\n  selector: (state: TState) => StateSlice = identity as any,\n  equalityFn?: (a: StateSlice, b: StateSlice) => boolean\n) {\n  if (\n    import.meta.env?.MODE !== "production" &&\n    equalityFn &&\n    !didWarnAboutEqualityFn\n  ) {\n    console.warn(\n      "[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from \'zustand/traditional\'. https://github.com/pmndrs/zustand/discussions/1937"\n    );\n    didWarnAboutEqualityFn = true;\n  }\n  const slice = useSyncExternalStoreWithSelector(\n    api.subscribe,\n    api.getState,\n    api.getServerState || api.getInitialState,\n    selector,\n    equalityFn\n  );\n  useDebugValue(slice);\n  return slice;\n}\n'})}),"\n",(0,s.jsxs)(t.p,{children:["\u4ed6\u628a\u525b\u525b\u5efa\u7acb\u7684 ",(0,s.jsx)(t.code,{children:"getState"})," \u8ddf ",(0,s.jsx)(t.code,{children:"subscribe"})," \u50b3\u5165 ",(0,s.jsx)(t.code,{children:"useSyncExternalStoreWithSelector"}),"\uff0c\u4e26\u56de\u50b3\u4e86\u5b83\u7684\u7d50\u679c\u3002"]}),"\n",(0,s.jsxs)(t.p,{children:["\u90a3\u9019\u500b ",(0,s.jsx)(t.code,{children:"useSyncExternalStoreWithSelector"})," \u53c8\u662f\u600e\u9ebc\u8fa6\u5230\u7684\u5462\uff1f\u9019\u5c31\u8981\u63d0\u5230 react 18 \u65b0\u589e\u7684 hook ",(0,s.jsx)(t.a,{href:"https://ru.react.dev/reference/react/useSyncExternalStore",children:"useSyncExternalStore"}),"\u3002"]}),"\n",(0,s.jsx)(t.h3,{id:"usesyncexternalstore",children:"useSyncExternalStore"}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.code,{children:"useSyncExternalStore"})," \u662f react 18 \u65b0\u589e\u7684 hook\uff0c\u7528\u4f86\u540c\u6b65 React \u5167\u90e8\u53ca\u5916\u90e8\u7684 state \u72c0\u614b\u3002\u9019\u662f\u4ec0\u9ebc\u610f\u601d\u5462\uff1f\u6211\u5011\u90fd\u77e5\u9053 React \u5728\u66f4\u65b0 UI \u756b\u9762\u6642\uff0c\u6703\u900f\u904e useState \u4f86\u66f4\u65b0 state\uff0c\u4e26\u9032\u884c re-render\uff0c\u4f46\u5982\u679c\u6211\u4eca\u5929\u4e0d\u60f3\u7528 useState \u60f3\u8981\u96a8\u4fbf\u5efa\u7acb\u4e00\u500b\u7269\u4ef6\u5132\u5b58 state\uff0c\u90a3\u6211\u8981\u600e\u9ebc\u544a\u8a34 React \u9019\u500b\u7269\u4ef6\u5e95\u4e0b\u7684\u503c\u6539\u8b8a\u6642\uff0c\u5e6b\u6211\u91cd\u65b0\u9032\u884c\u756b\u9762\u66f4\u65b0\u5462\uff1f\u9019\u5c31\u662f ",(0,s.jsx)(t.code,{children:"useSyncExternalStore"})," \u7684\u4f5c\u7528\u62c9\uff01"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-ts",children:"const snapshot = useSyncExternalStore(\n  subscribe,\n  getSnapshot,\n  getServerSnapshot\n);\n"})}),"\n",(0,s.jsx)(t.p,{children:"\u6703\u50b3\u5165\u4e09\u500b\u53c3\u6578\uff1a"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"subscribe"}),"\uff1a\u8a02\u95b1 state \u7684\u8b8a\u5316\u3002"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"getSnapshot"}),"\uff1a\u53d6\u5f97\u7576\u524d\u6700\u65b0\u7684\u503c\u3002"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"getServerSnapshot"}),"\uff1a\u53d6\u5f97 SSR \u7684\u521d\u59cb\u72c0\u614b\uff08\u53ef\u9078\uff09\u3002"]}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["\u800c\u56e0\u70ba\u9019\u500b hook \u662f React 18 \u65b0\u589e\u7684\uff0c\u6240\u4ee5\u70ba\u4e86\u8b93\u4e4b\u524d\u7684\u7248\u672c\u4e5f\u53ef\u4ee5\u505a\u4f7f\u7528\uff0c\u6240\u4ee5\u6709\u53e6\u5916\u628a\u9019\u500b hook \u62c9\u51fa\u4e00\u500b\u7368\u7acb\u7684 package ",(0,s.jsx)(t.a,{href:"https://www.npmjs.com/package/use-sync-external-store",children:"use-sync-external-store"}),"\uff0c\u900f\u904e\u9019\u500b package \u7684\u539f\u59cb\u78bc\uff0c\u6211\u5011\u53ef\u4ee5\u4e00\u7aba\u7a76\u7adf\u9019\u500b hook \u5927\u6982\u662f\u600e\u9ebc\u5be6\u4f5c\u7684\u3002"]}),"\n",(0,s.jsx)(a.Ei,{src:o}),"\n",(0,s.jsxs)(t.p,{children:["\u539f\u59cb\u78bc\u4f4d\u7f6e\u662f\u5728 react package \u5e95\u4e0b\u7684 ",(0,s.jsx)(t.a,{href:"https://github.com/facebook/react/blob/main/packages/use-sync-external-store/src/useSyncExternalStoreShimClient.js",children:"useSyncExternalStoreShimClient.js"})," \u88e1\u9762\uff0c\u9019\u908a\u53ea\u5217\u51fa\u91cd\u9ede\u7a0b\u5f0f\u78bc\uff1a"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-ts",metastring:"{7,13-17}",children:"export function useSyncExternalStore<T>(\n  subscribe: (() => void) => () => void,\n  getSnapshot: () => T,\n  getServerSnapshot?: () => T,\n): T {\n  const value = getSnapshot();\n  const [{inst}, forceUpdate] = useState({inst: {value, getSnapshot}});\n\n  useEffect(() => {\n    if (checkIfSnapshotChanged(inst)) {\n      forceUpdate({inst});\n    }\n    const handleStoreChange = () => {\n      if (checkIfSnapshotChanged(inst)) {\n        forceUpdate({inst});\n      }\n    };\n    return subscribe(handleStoreChange);\n  }, [subscribe]);\n\n  useDebugValue(value);\n  return value;\n}\n"})}),"\n",(0,s.jsx)(t.p,{children:"\u53ef\u4ee5\u770b\u5230\u5176\u5be6\u662f\u900f\u904e useState \u53ca useEffect \u4f86\u9054\u6210\u7684\uff0cuseState \u7684\u90e8\u5206\u662f\u70ba\u4e86\u8b93 React \u91cd\u65b0 render\uff0c\u4ed6\u5be6\u4f5c\u4e86\u4e00\u500b\u5f37\u5236\u66f4\u65b0\u7684\u65b9\u6cd5\uff0c\u56e0\u70ba\u4ed6\u6bcf\u6b21 setState \u7684\u6642\u5019\u90fd\u662f\u50b3\u5165\u4e00\u500b\u65b0\u7684\u7269\u4ef6\uff0c\u800c React \u5167\u90e8\u5728\u5224\u65b7\u662f\u5426\u8981 re-render \u6642\uff0c\u5169\u500b\u7269\u4ef6\u6703\u5224\u5b9a\u70ba\u4e0d\u540c\uff0c\u6240\u4ee5\u5c31\u6703\u91cd\u65b0 render\u3002"}),"\n",(0,s.jsxs)(t.p,{children:["\u800c\u5728 useEffect \u7684\u90e8\u5206\uff0c\u5b83\u5efa\u7acb\u4e86\u4e00\u500b ",(0,s.jsx)(t.code,{children:"handleStoreChange"})," \u7684 function\uff0c\u88e1\u9762\u6703\u5148\u5224\u65b7\u76ee\u524d\u7684\u503c\u662f\u5426\u6709\u6539\u8b8a\uff0c\u5982\u679c\u6709\u6539\u8b8a\u5c31\u6703\u547c\u53eb ",(0,s.jsx)(t.code,{children:"forceUpdate"})," \u4f86\u9032\u884c\u5f37\u5236\u66f4\u65b0\uff0c\u800c\u9019\u500b ",(0,s.jsx)(t.code,{children:"handleStoreChange"})," \u4e5f\u5c31\u662f\u6211\u5011\u524d\u9762\u8aaa\u7684 ",(0,s.jsx)(c.Z,{children:"\u66f4\u65b0\u51fd\u5f0f"}),"\uff0c\u6700\u5f8c\u900f\u904e ",(0,s.jsx)(t.code,{children:"subscribe"})," \u628a\u9019\u500b function \u52a0\u5165 listeners \u88e1\u9762\u3002"]}),"\n",(0,s.jsx)(t.h3,{id:"zustand-\u5167\u90e8\u8a02\u95b1\u6d41\u7a0b\u5716",children:"zustand \u5167\u90e8\u8a02\u95b1\u6d41\u7a0b\u5716"}),"\n",(0,s.jsxs)(t.p,{children:["\u4e0b\u9762\u662f",(0,s.jsx)(c.Z,{children:"\u66f4\u65b0\u51fd\u5f0f"}),"\u88ab\u52a0\u9032 listeners \u7684\u6d41\u7a0b\uff1a"]}),"\n",(0,s.jsx)(a.Ei,{src:d,width:"700px",center:!0}),"\n",(0,s.jsx)(t.h3,{id:"zustand-\u66f4\u65b0-state-\u6d41\u7a0b\u5716",children:"zustand \u66f4\u65b0 state \u6d41\u7a0b\u5716"}),"\n",(0,s.jsx)(t.p,{children:"\u63a5\u4e0b\u4f86\u8b93\u6211\u5011\u4f86\u770b\u4e00\u4e0b\u5982\u679c\u4eca\u5929\u6709\u591a\u500b\u5143\u4ef6\u4f7f\u7528\u4e86\u540c\u4e00\u500b zustand \u7684 state \u6642\uff0c\u662f\u5982\u4f55\u9032\u884c\u66f4\u65b0\u7684\u3002\u73fe\u5728\u6709\u5169\u500b\u5143\u4ef6"}),"\n",(0,s.jsx)(a.Ei,{src:h,width:"350px",center:!0}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-jsx",metastring:'{3} title="Counter.js"',children:"import { useCountStore } from \"./store\";\nexport default function Counter() {\n  const { count, increment, decrement } = useCountStore();\n  return (\n    <div className='counter'>\n      <button onClick={decrement}>-</button>\n      <h1>{count}</h1>\n      <button onClick={increment}>+</button>\n    </div>\n  );\n}\n"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-jsx",metastring:'{3} title="Total.js"',children:'import { useCountStore } from "./store";\nexport default function Total() {\n  const { count } = useCountStore();\n  return (\n    <div>\n      <h1>Total Count: {count}</h1>\n    </div>\n  );\n}\n'})}),"\n",(0,s.jsxs)(t.p,{children:["\u9019\u5169\u500b\u5143\u4ef6\u90fd\u547c\u53eb\u4e86 ",(0,s.jsx)(t.code,{children:"useCountStore"})," \u4f86\u53d6\u5f97 count \u7684\u503c\uff0c\u524d\u9762\u63d0\u5230 ",(0,s.jsx)(t.code,{children:"useCountStore"}),"\n\u6703\u547c\u53eb ",(0,s.jsx)(t.code,{children:"useSyncExternalStore"})," \u4f86\u628a ",(0,s.jsx)(c.Z,{children:"\u66f4\u65b0\u51fd\u5f0f"})," \u52a0\u5165\u5230 listeners\n\u88e1\u9762\uff0c\u6240\u4ee5\u7576\u756b\u9762\u6e32\u67d3\u6642\uff0clisteners \u6703\u6709\u5169\u500b updator \u51fd\u5f0f\uff0c\u800c\u7576 Counter \u547c\u53eb\u4e86 ",(0,s.jsx)(t.code,{children:"increment"})," \u6216 ",(0,s.jsx)(t.code,{children:"decrement"})," \u6642\uff0c\u6703\u89f8\u767c zustand\n\u5167\u90e8\u7684 ",(0,s.jsx)(t.code,{children:"setState"}),"\uff0c\u9019\u6642\u5019\u6703\u5148\u66f4\u65b0 state \u7684\u503c\uff0c\u7136\u5f8c\u57f7\u884c listeners \u88e1\u9762\u7684\u6240\u6709 updator\n\u51fd\u5f0f\uff0c\u9019\u6a23\u5c31\u6703\u8b93\u6240\u6709\u4f7f\u7528\u4e86\u9019\u500b state \u7684\u5143\u4ef6\u90fd\u91cd\u65b0 render\u3002"]}),"\n",(0,s.jsx)(a.Ei,{src:u,center:!0}),"\n",(0,s.jsx)(t.h2,{id:"zustand-\u6fc3\u7e2e\u7248",children:"zustand \u6fc3\u7e2e\u7248"}),"\n",(0,s.jsx)(t.p,{children:"\u5982\u679c\u628a zustand \u7684\u539f\u59cb\u78bc\u53ea\u4fdd\u7559\u6838\u5fc3\u529f\u80fd\uff0c\u6703\u8b8a\u6210\u9019\u6a23\uff1a"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsx)(t.li,{children:"create"}),"\n"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-ts",children:"export const create = (createState) => {\n  const api = createStore(createState);\n  return () => useStore(api);\n};\n"})}),"\n",(0,s.jsxs)(t.ol,{start:"2",children:["\n",(0,s.jsx)(t.li,{children:"createStore"}),"\n"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-ts",children:"const createStore = (createState) => {\n  let state = {};\n  const listeners = new Set();\n\n  const setState = (partial) => {\n    const nextState = partial(state);\n    state = { ...state, ...nextState };\n    listeners.forEach((listener) => listener());\n  };\n\n  const getState = () => state;\n\n  const subscribe = (listener) => {\n    listeners.add(listener);\n    return () => listeners.delete(listener);\n  };\n\n  state = createState(setState);\n\n  const api = { setState, getState, subscribe };\n  return api;\n};\n"})}),"\n",(0,s.jsxs)(t.ol,{start:"3",children:["\n",(0,s.jsx)(t.li,{children:"useStore"}),"\n"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-ts",children:'import { useSyncExternalStore } from "react";\n\nexport function useStore(api) {\n  const entireState = useSyncExternalStore(api.subscribe, api.getState);\n\n  return entireState;\n}\n'})}),"\n",(0,s.jsx)(t.h2,{id:"zustand-\u67b6\u69cb\u6a21\u5f0f",children:"zustand \u67b6\u69cb\u6a21\u5f0f"}),"\n",(0,s.jsxs)(t.p,{children:["Zustand \u7684\u5728 ",(0,s.jsx)(t.a,{href:"https://docs.pmnd.rs/zustand/guides/flux-inspired-practice",children:"Flux inspired practice"})," \u6709\u63d0\u5230\uff1a"]}),"\n",(0,s.jsxs)(t.blockquote,{children:["\n",(0,s.jsx)(t.p,{children:"Although Zustand is an unopinionated library, we do recommend a few patterns. These are inspired by practices originally found in Flux, and more recently Redux, so if you are coming from another library, you should feel right at home."}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["\u610f\u601d\u662f Zustand \u672c\u8eab\u4e26\u6c92\u6709\u5f37\u5236\u8981\u6c42\u4f7f\u7528\u8005\u9075\u5faa\u4efb\u4f55\u7279\u5b9a\u7684\u67b6\u69cb\u6a21\u5f0f\uff0c\u4f46\u662f\u5efa\u8b70\u4f7f\u7528\u8005\u53ef\u4ee5\u53c3\u8003 Flux \u6216 Redux \u7684\u4e00\u4e9b\u5be6\u8e10\u65b9\u5f0f\u3002Redux \u5728\u5b78 React \u7684\u6642\u5019\u61c9\u8a72\u90fd\u6709\u807d\u904e\uff0c\u90a3\u9019\u500b ",(0,s.jsx)(t.strong,{children:"Flux"})," \u662f\u4ec0\u9ebc\u5462\uff1f"]}),"\n",(0,s.jsx)(t.h3,{id:"flux",children:"Flux"}),"\n",(0,s.jsx)(t.p,{children:"Flux \u662f\u4e00\u7a2e\u67b6\u69cb\u6a21\u5f0f\uff0c\u90a3\u4ec0\u9ebc\u662f\u67b6\u69cb\u6a21\u5f0f\u5462\uff1f\u6bd4\u8f03\u5e38\u807d\u5230\u7684\u4f8b\u5b50\u5c31\u662f MVC\uff0c\u67b6\u69cb\u6a21\u5f0f\u7684\u76ee\u7684\u662f\u7528\u4f86\u5e6b\u52a9\u6211\u5011\u53ef\u4ee5\u66f4\u597d\u7684\u7d44\u7e54\u7a0b\u5f0f\u78bc\uff0c\u8b93\u7a0b\u5f0f\u78bc\u66f4\u52a0\u5bb9\u6613\u7dad\u8b77\u3001\u64f4\u5145\u3002\u800c Flux \u5247\u662f\u5f9e MVC \u6240\u555f\u767c\u51fa\u4f86\u7684\u4e00\u7a2e\u67b6\u69cb\u6a21\u5f0f\u3002"}),"\n",(0,s.jsxs)(t.admonition,{title:"MVC",type:"info",children:[(0,s.jsxs)(t.p,{children:["MVC \u6a21\u5f0f\u6700\u65e9\u7531 Trygve Reenskaug \u5728 1978 \u5e74\u63d0\u51fa\uff0c\u4e26\u4e14\u5728 University of Oslo \u6709\u7559\u4e0b",(0,s.jsx)(t.a,{href:"https://www.duo.uio.no/bitstream/handle/10852/9621/Reenskaug-MVC.pdf?sequence=1&isAllowed=y",children:"\u7814\u7a76\u5831\u544a"}),"\uff0c\u4ed6\u628a\u61c9\u7528\u7a0b\u5f0f\u5206\u70ba\u4e09\u500b\u90e8\u5206\uff1a"]}),(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsx)(t.li,{children:"Model: \u8ca0\u8cac\u8655\u7406\u8cc7\u6599"}),"\n",(0,s.jsx)(t.li,{children:"View: \u8ca0\u8cac\u986f\u793a\u756b\u9762"}),"\n",(0,s.jsx)(t.li,{children:"Controller: \u8ca0\u8cac\u8655\u7406 View \u7684\u4e8b\u4ef6\uff0c\u4e5f\u6703\u8aaa\u662f View \u53ca Model \u4e4b\u9593\u7684\u6a4b\u6a11"}),"\n"]}),(0,s.jsx)(t.p,{children:"MVC \u7684\u597d\u8655\u662f\u53ef\u4ee5\u8b93\u7a0b\u5f0f\u78bc\u66f4\u52a0\u6a21\u7d44\u5316\uff0c\u6bcf\u500b\u90e8\u5206\u90fd\u6709\u81ea\u5df1\u7684\u8cac\u4efb\uff0c\u4e0d\u6703\u4e92\u76f8\u5e72\u64fe\uff0c\u4e5f\u8b93\u7a0b\u5f0f\u78bc\u66f4\u5bb9\u6613\u7dad\u8b77\u3002"})]}),"\n",(0,s.jsx)(t.p,{children:"\u96d6\u7136 MVC \u7684\u67b6\u69cb\u5b9a\u7fa9\u4e86\u4e09\u500b\u90e8\u5206\u7684\u8077\u8cac\uff0c\u4e0d\u904e\u5c0d\u65bc\u4e09\u500b\u90e8\u5206\u4e4b\u9593\u7684\u6e9d\u901a\u65b9\u5f0f\u4e26\u6c92\u6709\u660e\u78ba\u7684\u5b9a\u7fa9\uff0c\u6240\u4ee5\u5728\u5be6\u969b\u61c9\u7528\u6642\uff0c\u53ef\u80fd\u6703\u6709\u4e0d\u540c\u7684\u5be6\u4f5c\u65b9\u5f0f\uff0c\u9019\u4e5f\u662f\u70ba\u4ec0\u9ebc\u6709\u5f88\u591a\u4e0d\u540c\u7684 MVC \u8b8a\u9ad4\uff0c\u50cf\u662f MVP\u3001MVVM \u7b49\u7b49\uff0c\u800c Flux \u7684\u51fa\u73fe\u5c31\u662f\u70ba\u4e86\u89e3\u6c7a MVC \u5728\u8cc7\u6599\u6d41\u4e0a\u4e0d\u597d\u8ffd\u8e64\u7684\u554f\u984c\u3002"}),"\n",(0,s.jsxs)(t.p,{children:["Flux \u662f React \u5728 2014 \u5e74\u7684 ",(0,s.jsx)(t.a,{href:"https://www.youtube.com/watch?v=nYkdrAPrdcw&ab_channel=MetaDevelopers",children:"Hacker Way conference"})," \u4e0a\u63d0\u51fa\u7684\u6982\u5ff5\uff0c\u70ba\u7684\u5c31\u662f\u89e3\u6c7a Facebook \u5728\u4f7f\u7528 MVC \u67b6\u69cb\u6240\u9047\u5230\u7684\u554f\u984c\u3002Facebook \u6700\u521d\u662f\u4f7f\u7528\u96d9\u5411\u7d81\u5b9a\u7684\u65b9\u5f0f\u9032\u884c\u8cc7\u6599\u50b3\u905e\uff0c\u4f46\u96a8\u8457\u5c08\u6848\u8d8a\u4f86\u8d8a\u5927\uff0c\u8cc7\u6599\u6d41\u8b8a\u5f97\u8d8a\u4f86\u8d8a\u8907\u96dc\u3002"]}),"\n",(0,s.jsx)(a.Ei,{src:x}),"\n",(0,s.jsxs)(t.admonition,{title:"\u5c0f\u722d\u8b70",type:"info",children:[(0,s.jsxs)(t.p,{children:["\u9019\u5f35\u5716\u5728\u7576\u6642\u5f15\u8d77\u4e0d\u5c11\u7684",(0,s.jsx)(t.a,{href:"https://www.reddit.com/r/programming/comments/25nrb5/facebook_mvc_does_not_scale_use_flux_instead/",children:"\u8a0e\u8ad6"}),"\uff0c\u6709\u4eba\u8a8d\u70ba facebook \u7684 MVC \u5716\u662f\u932f\u7684\uff0c\u771f\u6b63\u7684 MVC \u624d\u4e0d\u6703\u53ea\u6709\u4e00\u500b controller\uff0c\u4e5f\u6709\u4eba\u8a8d\u70ba Flux \u6839\u672c\u53ea\u662f MVC \u63db\u500b\u540d\u8a5e\u3002"]}),(0,s.jsxs)(t.p,{children:["\u800c\u7576\u6642\u7684\u6f14\u8b1b\u8005 Jing Chen \u4e5f\u6709\u51fa\u4f86",(0,s.jsx)(t.a,{href:"https://www.reddit.com/r/programming/comments/25nrb5/comment/chjbo05/?utm_source=share&utm_medium=web3x&utm_name=web3xcss&utm_term=1&utm_content=share_button",children:"\u8aaa\u660e"}),"\uff0c\u9019\u5f35\u5716\u7684\u78ba\u662f\u6709\u9ede\u6295\u6a5f\u53d6\u5de7\uff0c\u4e0d\u904e\u91cd\u9ede\u9084\u662f\u5728\u65bc\u96d9\u5411\u8cc7\u6599\u6d41\u6240\u9020\u6210\u7684\u554f\u984c\uff0c\u800c Flux \u4e2d\u7684 dispatcher \u4e26\u4e0d\u7b49\u540c\u65bc controller\uff0c\u4ed6\u53ea\u662f\u4e00\u500b\u5206\u767c action \u7684 callback \u4f86\u9054\u6210\u55ae\u5411\u8cc7\u6599\u6d41\u7684\u76ee\u7684\u3002"]})]}),"\n",(0,s.jsx)(t.p,{children:"meta \u5de5\u7a0b\u5e2b\u8209\u7684\u5be6\u969b\u4f8b\u5b50\u662f\u7576\u521d\u505a message chat \u7684\u6642\u5019\uff0c\u4e00\u958b\u59cb\u53ea\u6709\u4e00\u500b\u5340\u584a\u8ddf\u8a0a\u606f\u6709\u95dc\uff0c\u4f46\u5f8c\u4f86\u8d8a\u4f86\u8d8a\u591a\u529f\u80fd\u6703\u5c0d\u8a0a\u606f\u7684\u6578\u91cf\u9020\u6210\u5f71\u97ff\u3002"}),"\n",(0,s.jsxs)(t.p,{children:["\u800c\u9047\u5230\u7684 bug \u5c31\u662f",(0,s.jsx)(t.strong,{children:"\u672a\u8b80\u8a0a\u606f"}),"\u7684\u6578\u5b57\u4e0d\u6e96\u78ba\uff0c\u56e0\u70ba\u5f88\u591a\u7684\u5340\u584a\u90fd\u6709\u53ef\u80fd\u6703\u5f71\u97ff\u5230\u672a\u8b80\u8a0a\u606f\u7684\u6578\u5b57\uff0c\u6240\u4ee5\u8981\u8ffd\u8e64\u5230\u5e95\u662f\u54ea\u500b\u5340\u584a\u9020\u6210\u7684 bug \u5c31\u8b8a\u5f97\u975e\u5e38\u56f0\u96e3\uff0c\u800c meta \u6bcf\u6b21\u9047\u5230\u9019\u500b bug \u90fd\u662f\u53bb\u89e3\u6c7a\u90a3\u4e9b edge case (\u908a\u754c\u6848\u4f8b)\uff0c\u6c92\u6709\u771f\u7684\u89e3\u6c7a\u6838\u5fc3\u554f\u984c\uff0c\u6240\u4ee5\u5c0e\u81f4\u6bcf\u6b21\u65b0\u589e\u529f\u80fd\u90fd\u6703\u6709\u65b0\u7684 bug \u7522\u751f\u3002"]}),"\n",(0,s.jsx)(a.Ei,{src:j}),"\n",(0,s.jsxs)(t.p,{children:["\u4ed6\u5011\u8a8d\u70ba\u9019\u662f\u56e0\u70ba MVC \u7684\u96d9\u5411\u7d81\u5b9a\u9020\u6210\u7684\uff0c\u7576\u8cc7\u6599\u6d41\u8b8a\u5f97\u8d8a\u4f86\u8d8a\u8907\u96dc\u6642\uff0c\u5c31\u6703\u8b8a\u5f97\u975e\u5e38\u96e3\u4ee5\u8ffd\u8e64\uff0c\u6240\u4ee5\u63d0\u51fa\u4e86 Flux \u7684",(0,s.jsx)(t.strong,{children:"\u55ae\u5411\u8cc7\u6599\u6d41"}),"\u7684\u67b6\u69cb\u3002"]}),"\n",(0,s.jsx)(t.p,{children:"Flux \u5c07\u8cc7\u6599\u6d41\u7684\u50b3\u905e\u5206\u70ba\u56db\u500b\u90e8\u5206\uff1a"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsx)(t.li,{children:"Action\uff1a\u7269\u4ef6\u7d50\u69cb\u5305\u542b\u884c\u70ba\u5b9a\u7fa9\u53ca\u50b3\u905e\u7684\u8cc7\u8a0a"}),"\n",(0,s.jsx)(t.li,{children:"Dispatcher\uff1a\u8ca0\u8cac\u5206\u767c Action \u7684\u51fd\u5f0f"}),"\n",(0,s.jsx)(t.li,{children:"Store\uff1a\u5132\u5b58\u8cc7\u6599\u53ca\u56de\u61c9 Action \u7684\u884c\u70ba"}),"\n",(0,s.jsx)(t.li,{children:"\u986f\u793a Store \u63d0\u4f9b\u7684\u8cc7\u6599\u756b\u9762"}),"\n"]}),"\n",(0,s.jsx)(a.Ei,{src:p}),"\n",(0,s.jsx)(t.h3,{id:"redux",children:"Redux"}),"\n",(0,s.jsxs)(t.p,{children:["\u5728\u63d0\u51fa Flux \u67b6\u69cb\u7684\u540c\u6642\uff0cmeta \u4e5f\u63d0\u51fa\u4e86\u4e00\u500b\u53eb ",(0,s.jsx)(t.a,{href:"https://facebookarchive.github.io/flux/",children:"Flux"})," \u7684 library\uff0c\u4e0d\u904e\u4e26\u6c92\u6709\u53d7\u5230\u592a\u591a\u7684\u95dc\u6ce8\uff0c\u76f4\u5230\u9694\u4e00\u5e74 Dan Abramov \u63d0\u51fa\u4e86\u57fa\u65bc Flux \u6982\u5ff5\u5be6\u4f5c\u7684 library ",(0,s.jsx)(t.a,{href:"https://redux.js.org/",children:"Redux"}),"\uff0c\u9019\u500b library \u5f8c\u4f86\u6210\u70ba\u4e86 React \u6700\u53d7\u6b61\u8fce\u7684\u72c0\u614b\u7ba1\u7406 library \u4e4b\u4e00\u3002"]}),"\n",(0,s.jsxs)(t.p,{children:["\u5728 Redux \u7684",(0,s.jsx)(t.a,{href:"https://redux.js.org/tutorials/fundamentals/part-2-concepts-data-flow#redux-application-data-flow",children:"\u5b98\u7db2"}),"\u53ef\u4ee5\u660e\u78ba\u7684\u770b\u5230\u6574\u500b redux \u7684\u8cc7\u6599\u6d41\uff1a"]}),"\n",(0,s.jsx)(a.Ei,{src:S}),"\n",(0,s.jsx)(t.h2,{id:"\u7e3d\u7d50",children:"\u7e3d\u7d50"}),"\n",(0,s.jsx)(t.p,{children:"\u5176\u5be6\u5149\u770b Flux \u53ca Redux \u7684\u5716\uff0c\u6703\u89ba\u5f97\u597d\u50cf\u8ddf MVC \u6c92\u6709\u4ec0\u9ebc\u5dee\u5225\uff0c\u4e5f\u662f\u5b9a\u7fa9\u500b\u5225\u7684\u8077\u8cac\uff0cView \u8ddf Model \u5206\u958b\uff0c\u4e5f\u6709\u985e\u4f3c controller \u7684\u6771\u897f\u3002\u4e0d\u904e\u91cd\u9ede\u5728\u65bc\u5b83\u66f4\u52a0\u56b4\u8b39\u7684\u5b9a\u7fa9\u4e86\u8cc7\u6599\u6d41\u7684\u65b9\u5411\uff0c\u8b93\u8cc7\u6599\u66f4\u597d\u7684\u7d71\u4e00\uff0c\u96d6\u7136 MVC \u67b6\u69cb\u4e5f\u8fa6\u5f97\u5230\u9019\u4ef6\u4e8b\uff0c\u4f46\u4e26\u4e0d\u662f\u6bcf\u500b\u4eba\u90fd\u6703\u9019\u9ebc\u505a\uff0c\u6240\u4ee5\u6211\u8a8d\u7232 Flux \u9084\u662f\u8ddf MVC \u6709\u6240\u5340\u5225\u3002"}),"\n",(0,s.jsx)(t.p,{children:"\u56de\u5230 zustand\uff0c\u4e4b\u6240\u4ee5\u80fd\u5920\u5beb\u7684\u90a3\u9ebc\u7c21\u6f54\u65b9\u908a\u4f7f\u7528\uff0c\u662f\u56e0\u70ba\u4ed6\u4e26\u4e0d\u662f\u5b8c\u5168\u7684\u5be6\u4f5c\u4e86 Flux\uff0c\u4ed6\u6368\u68c4\u4e86 Flux \u4e2d\u7684 Action \u53ca Dispatcher\uff0c\u53ea\u4fdd\u7559\u4e86 Store \u7684\u90e8\u5206\uff0c\u5728 DX (Developer Experience) \u4e0a\u7684\u9ad4\u9a57\u5c31\u6bd4\u8f03\u597d\uff0c\u800c\u96d6\u7136\u4e0d\u662f\u56b4\u8b39\u7684 Flux \u67b6\u69cb\uff0c\u4f46\u9084\u662f\u9075\u5faa\u8457\u6700\u57fa\u672c\u7684\u55ae\u5411\u8cc7\u6599\u6d41\u7684\u539f\u5247\uff0c\u8b93\u6211\u5011\u53ef\u4ee5\u66f4\u597d\u7684\u9032\u884c\u7ba1\u7406\u72c0\u614b\u3002"}),"\n",(0,s.jsx)(t.p,{children:"\u7e3d\u800c\u8a00\u4e4b\uff0c\u5982\u679c\u4e0d\u60f3\u4f7f\u7528 React \u539f\u751f\u7684 useContext\uff0c\u800c\u5b78\u7fd2 Redux \u7684\u5165\u9580\u53c8\u6709\u9ede\u592a\u9ad8\uff0czustand \u662f\u4e00\u500b\u5f88\u597d\u7684\u9078\u64c7\uff0c\u5728\u505a side project \u6216\u662f\u5c0f\u578b\u5c08\u6848\u7d55\u5c0d\u662f\u975e\u5e38\u5920\u7528\u7684\uff0c\u800c\u4e14\u4e5f\u53ef\u4ee5\u8b93\u4f60\u5c0d\u72c0\u614b\u7ba1\u7406\u6709\u66f4\u6df1\u7684\u4e86\u89e3\uff01"}),"\n",(0,s.jsx)(t.p,{children:"\u6709\u4efb\u4f55\u554f\u984c\u6216\u662f\u5167\u5bb9\u6709\u8aa4\u7684\u5730\u65b9\uff0c\u6b61\u8fce\u5728\u5e95\u4e0b\u7559\u8a00 ~"}),"\n",(0,s.jsx)(t.h2,{id:"\u53c3\u8003\u8cc7\u6599",children:"\u53c3\u8003\u8cc7\u6599"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"https://medium.com/%E6%89%8B%E5%AF%AB%E7%AD%86%E8%A8%98/a-comparison-of-react-state-management-libraries-ba61db07332b",children:"React \u72c0\u614b\u7ba1\u7406\u5957\u4ef6\u6bd4\u8f03\u8207\u539f\u7406\u5be6\u73fe feat. Redux, Zustand, Jotai, Recoil, MobX, Valtio"})}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"https://juejin.cn/post/7178318352174022717",children:"\u662f\u65f6\u5019\u653e\u5f03 redux \u4e86\uff0czustand \u662f\u5b8c\u7f8e\u66ff\u4ee3\u8005\uff08\u4e3b\u8981\u662f\u6e90\u7801\u5206\u6790\uff09"})}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"https://medium.com/wix-engineering/the-rise-of-flux-how-facebooks-shift-away-from-mvc-led-to-a-new-era-of-ui-architecture-61d78b4377b0",children:"The Rise of Flux: How Facebook\u2019s Shift Away from MVC Led to a New Era of UI Architecture"})}),"\n"]})]})}function w(e={}){const{wrapper:t}={...(0,r.a)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(v,{...e})}):v(e)}},1262:(e,t,n)=>{n.d(t,{Z:()=>a});n(7294);var s=n(2389),r=n(5893);function a(e){let{children:t,fallback:n}=e;return(0,s.Z)()?(0,r.jsx)(r.Fragment,{children:t?.()}):n??null}},676:(e,t,n)=>{n.d(t,{Z:()=>r});var s=n(5893);const r=e=>{let{children:t,color:n,block:r,bold:a,style:c}=e,i="";switch(n){case"yellow":default:i="highlight-yellow";break;case"blue":i="highlight-blue";break;case"green":i="highlight-green";break;case"red":i="highlight-red"}const l={fontWeight:a?"bold":"normal",...c};return r?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:`${i} highlight`,style:{...l},children:t}),(0,s.jsx)("p",{})]}):(0,s.jsx)("span",{className:`${i} highlight`,style:{...l},children:t})}},5397:(e,t,n)=>{n.d(t,{Ei:()=>c,gO:()=>i,nI:()=>l});var s=n(1262),r=n(5795),a=(n(7294),n(5893));const c=e=>{let{src:t,width:n="100%",center:s=!1,style:r={}}=e;const c={width:`min(100%,${n})`,display:s?"block":"inline-block",margin:s?"0 auto":"0",borderRadius:"5px",...r};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("img",{src:t,style:{...c}}),(0,a.jsx)("br",{}),(0,a.jsx)("br",{})]})},i=e=>{let{children:t,width:n="100%",center:c=!1,style:i={}}=e;return(0,a.jsx)(s.Z,{children:()=>{const{sm:e}=(0,r.Z)(),s={width:`min(100%,${n})`,margin:c?"0 auto":"0",display:"flex",flexDirection:e?"column":"row",gap:"10px",alignItems:"center",...i};return(0,a.jsx)("div",{style:{...s},children:t})}})},l=e=>{let{style:t,width:n="100%",src:s}=e;const r={width:`min(100%,${n})`,flex:1,...t};return(0,a.jsx)("div",{style:{...r},children:(0,a.jsx)(c,{src:s})})}},5795:(e,t,n)=>{n.d(t,{Z:()=>a});var s=n(7294);const r=635,a=()=>{const[e,t]=(0,s.useState)({width:window.innerWidth,height:window.innerHeight}),[n,a]=(0,s.useState)(!1);return(0,s.useLayoutEffect)((()=>{const e=()=>{const{innerWidth:e,innerHeight:n}=window,s=e<=r;t({width:e,height:n}),a(s)};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]),{sm:n,windowSize:e}}},1151:(e,t,n)=>{n.d(t,{Z:()=>i,a:()=>c});var s=n(7294);const r={},a=s.createContext(r);function c(e){const t=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),s.createElement(a.Provider,{value:t},e.children)}}}]);