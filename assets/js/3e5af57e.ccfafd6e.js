"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([["530"],{9835:function(e,t,n){n.r(t),n.d(t,{metadata:()=>s,contentTitle:()=>m,default:()=>w,assets:()=>g,toc:()=>y,frontMatter:()=>b});var s=JSON.parse('{"id":"react/zustand-source-code","title":"\u3010React\u3011\u5F9E zustand \u539F\u59CB\u78BC\u4E86\u89E3\u72C0\u614B\u7BA1\u7406","description":"Zustand \u7684\u4ECB\u7D39\u53EF\u4EE5\u5148\u770B\u9019\u7BC7\uFF0C\u9019\u4E00\u7BC7\u4E3B\u8981\u662F\u900F\u904E\u95B1\u8B80 zustand \u7684\u539F\u59CB\u78BC\u4F86\u4E86\u89E3\u5B83\u7684\u904B\u4F5C\u539F\u7406\u3002\u6703\u60F3\u8981\u5BEB\u9019\u7BC7\u662F\u56E0\u70BA\u4F7F\u7528\u5957\u4EF6\u5927\u5BB6\u90FD\u5DF2\u7D93\u7FD2\u4EE5\u70BA\u5E38\uFF0C\u4F46\u5957\u4EF6\u5230\u5E95\u5E6B\u6211\u5011\u505A\u4E86\u4EC0\u9EBC\u4E8B\u76F8\u4FE1\u5927\u90E8\u5206\u7684\u4EBA\uFF08\u5305\u62EC\u6211\uFF09\u5E73\u5E38\u662F\u4E0D\u6703\u7279\u5225\u53BB\u4E86\u89E3\u7684\uFF0C\u60F3\u8981\u770B\u5957\u4EF6\u7684\u539F\u59CB\u78BC\uFF0C\u5F88\u591A\u53C8\u592A\u8271\u6F80\u96E3\u4EE5\u5480\u56BC\u3002","source":"@site/docs/react/zustand-source-code.mdx","sourceDirName":"react","slug":"/react/zustand-source-code","permalink":"/react/zustand-source-code","draft":false,"unlisted":false,"tags":[{"inline":false,"label":"React","permalink":"/tags/react"},{"inline":false,"label":"Zustand","permalink":"/tags/zustand"},{"inline":false,"label":"Source Code","permalink":"/tags/source-code"}],"version":"current","lastUpdatedAt":1718887991000,"sidebarPosition":3,"frontMatter":{"title":"\u3010React\u3011\u5F9E zustand \u539F\u59CB\u78BC\u4E86\u89E3\u72C0\u614B\u7BA1\u7406","sidebar_label":"Zustand \u539F\u59CB\u78BC\u89E3\u6790","sidebar_position":3,"tags":["react","zustand","source-code"]},"sidebar":"tutorialSidebar","previous":{"title":"Zustand","permalink":"/react/zustand"},"next":{"title":"TypeScript","permalink":"/category/typescript"}}'),r=n("5893"),a=n("65"),c=n("9366"),i=n("1968");let l=n.p+"assets/images/code-file-4a7bb04c29b0d8b5f6310c4bb01dd530.jpg",o=n.p+"assets/images/code-structure-d528a79991b1c4b34239ba2e79af9536.jpg",d=n.p+"assets/images/use-sync-external-store-aae6c790b92b767f751ea0c7a3aff8c2.jpg",u=n.p+"assets/images/update-flow-967b6b62d20ac5e7a3302f0cebca6867.gif",h=n.p+"assets/images/muti-component-flow-4f3d858786b3f0a399ad53c916acecd8.gif",x=n.p+"assets/images/counter-two-component-1f91b996c01e9dff93c6bfcfb8a8cf22.gif",p=n.p+"assets/images/mvc-problem-6c68826c5322aefe4d904b59e31f7cb3.jpg",j=n.p+"assets/images/flux-flow-61e705f06287ccfbaa6e59f5b958145b.png",S=n.p+"assets/images/fb-message-block-6ff5ff6f29dbc170f194443c2085f871.png",f=n.p+"assets/images/redux-flow-49fa8c3968371d9ef6f2a1486bd40a26.gif",b={title:"\u3010React\u3011\u5F9E zustand \u539F\u59CB\u78BC\u4E86\u89E3\u72C0\u614B\u7BA1\u7406",sidebar_label:"Zustand \u539F\u59CB\u78BC\u89E3\u6790",sidebar_position:3,tags:["react","zustand","source-code"]},m=void 0,g={},y=[{value:"\u539F\u59CB\u78BC\u89E3\u6790",id:"\u539F\u59CB\u78BC\u89E3\u6790",level:2},{value:"create (react.ts)",id:"create-reactts",level:3},{value:"createStore (vanilla.ts)",id:"createstore-vanillats",level:3},{value:"useStore (react.ts)",id:"usestore-reactts",level:3},{value:"useSyncExternalStore",id:"usesyncexternalstore",level:3},{value:"zustand \u5167\u90E8\u8A02\u95B1\u6D41\u7A0B\u5716",id:"zustand-\u5167\u90E8\u8A02\u95B1\u6D41\u7A0B\u5716",level:3},{value:"zustand \u66F4\u65B0 state \u6D41\u7A0B\u5716",id:"zustand-\u66F4\u65B0-state-\u6D41\u7A0B\u5716",level:3},{value:"zustand \u6FC3\u7E2E\u7248",id:"zustand-\u6FC3\u7E2E\u7248",level:2},{value:"zustand \u67B6\u69CB\u6A21\u5F0F",id:"zustand-\u67B6\u69CB\u6A21\u5F0F",level:2},{value:"Flux",id:"flux",level:3},{value:"Redux",id:"redux",level:3},{value:"\u7E3D\u7D50",id:"\u7E3D\u7D50",level:2},{value:"\u53C3\u8003\u8CC7\u6599",id:"\u53C3\u8003\u8CC7\u6599",level:2}];function v(e){let t={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(t.p,{children:["Zustand \u7684\u4ECB\u7D39\u53EF\u4EE5\u5148\u770B",(0,r.jsx)(t.a,{href:"/react/zustand",children:"\u9019\u7BC7"}),"\uFF0C\u9019\u4E00\u7BC7\u4E3B\u8981\u662F\u900F\u904E\u95B1\u8B80 zustand \u7684\u539F\u59CB\u78BC\u4F86\u4E86\u89E3\u5B83\u7684\u904B\u4F5C\u539F\u7406\u3002\u6703\u60F3\u8981\u5BEB\u9019\u7BC7\u662F\u56E0\u70BA\u4F7F\u7528\u5957\u4EF6\u5927\u5BB6\u90FD\u5DF2\u7D93\u7FD2\u4EE5\u70BA\u5E38\uFF0C\u4F46\u5957\u4EF6\u5230\u5E95\u5E6B\u6211\u5011\u505A\u4E86\u4EC0\u9EBC\u4E8B\u76F8\u4FE1\u5927\u90E8\u5206\u7684\u4EBA\uFF08\u5305\u62EC\u6211\uFF09\u5E73\u5E38\u662F\u4E0D\u6703\u7279\u5225\u53BB\u4E86\u89E3\u7684\uFF0C\u60F3\u8981\u770B\u5957\u4EF6\u7684\u539F\u59CB\u78BC\uFF0C\u5F88\u591A\u53C8\u592A\u8271\u6F80\u96E3\u4EE5\u5480\u56BC\u3002"]}),"\n",(0,r.jsx)(t.p,{children:"\u800C zustnad \u5C31\u662F\u4E00\u500B\u5F88\u597D\u5165\u9580\u7684\u5957\u4EF6\uFF0C\u5B83\u7684\u539F\u59CB\u78BC\u4E0D\u591A\uFF0C\u5927\u90E8\u5206\u90FD\u883B\u5BB9\u6613\u770B\u61C2\uFF08\u6487\u9664 Typescript \u7684\u90E8\u5206\uFF09\uFF0C\u770B\u5B8C\u4E5F\u6703\u8B93\u4F60\u5C0D\u72C0\u614B\u7BA1\u7406\u6709\u66F4\u6DF1\u7684\u4E86\u89E3\uFF0C\u53EF\u4EE5\u8AAA\u662F\u521D\u6B21\u95B1\u8B80\u539F\u59CB\u78BC\u7684\u597D\u9078\u64C7\uFF0C\u5C31\u8B93\u6211\u5011\u4F86\u597D\u597D\u4E86\u89E3 zustand \u662F\u5982\u4F55\u505A\u5230 React \u72C0\u614B\u7BA1\u7406\u5427\uFF01"}),"\n",(0,r.jsx)(t.h2,{id:"\u539F\u59CB\u78BC\u89E3\u6790",children:"\u539F\u59CB\u78BC\u89E3\u6790"}),"\n",(0,r.jsxs)(t.p,{children:["zustand \u7684\u6838\u5FC3\u539F\u59CB\u78BC\u4E3B\u8981\u662F\u5728 ",(0,r.jsx)(t.code,{children:"src"})," \u5E95\u4E0B\u7684 ",(0,r.jsx)(t.code,{children:"react.ts"})," \u4EE5\u53CA ",(0,r.jsx)(t.code,{children:"vanilla.ts"})," \u9019\u5169\u652F\u6A94\u6848\uFF0C\u9019\u908A\u4EE5 ",(0,r.jsx)(t.a,{href:"https://github.com/pmndrs/zustand/tree/v4.5.1/src",children:"v4.5.1"})," \u7684\u7248\u672C\u70BA\u4F8B\u3002"]}),"\n",(0,r.jsx)(c.Ei,{src:l,width:"300px",center:!0}),"\n",(0,r.jsx)(t.p,{children:"\u800C\u9019\u5169\u652F\u6A94\u6848\u7E3D\u5171\u6709\u4E09\u500B\u4E3B\u8981\u7684 function:"}),"\n",(0,r.jsxs)(t.ol,{children:["\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.code,{children:"create"})," (react.ts)\uFF1Azustand \u7684\u6838\u5FC3 function\uFF0C\u7528\u4F86\u5EFA\u7ACB store\u3002"]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.code,{children:"useStore"})," (react.ts)\uFF1A\u8655\u7406\u540C\u6B65 React \u5167\u90E8\u53CA\u5916\u90E8\u7684 state \u72C0\u614B\u3002"]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.code,{children:"createState"})," (vanilla.ts)\uFF1A\u5EFA\u7ACB\u5168\u57DF\u7684 state \u53CA\u5EFA\u7ACB\u8A02\u95B1\u6A21\u5F0F\u3002"]}),"\n"]}),"\n",(0,r.jsx)(t.p,{children:"\u4ED6\u5011\u4E4B\u9593\u7684\u95DC\u806F\u6027\u6703\u50CF\u9019\u6A23\uFF1A"}),"\n",(0,r.jsx)(c.Ei,{src:o}),"\n",(0,r.jsx)(t.h3,{id:"create-reactts",children:"create (react.ts)"}),"\n",(0,r.jsxs)(t.p,{children:["\u9996\u5148\u4F86\u770B\u4E00\u4E0B ",(0,r.jsx)(t.a,{href:"https://github.com/pmndrs/zustand/blob/6109bc3bd0f3850c2d9546956de971f27834ac7a/src/react.ts#L124",children:"create"})," \u7684\u90E8\u5206\uFF1A"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-ts",children:"export const create = (<T>(createState: StateCreator<T, [], []> | undefined) =>\n  createState ? createImpl(createState) : createImpl) as Create;\n"})}),"\n",(0,r.jsxs)(t.p,{children:["\u4ED6\u56DE\u50B3\u4E86\u4E00\u500B ",(0,r.jsx)(t.code,{children:"createImpl"})," \u7684 function\uFF0C\u9019\u500B function \u5B9A\u7FA9\u4E86\u4E00\u500B\u53EB api \u7684\u7269\u4EF6\uFF0C\u662F\u547C\u53EB ",(0,r.jsx)(t.code,{children:"createStore"})," \u7684\u56DE\u50B3\u503C\u3002"]}),"\n",(0,r.jsxs)(t.p,{children:["\u7136\u5F8C\u5EFA\u7ACB\u4E00\u500B ",(0,r.jsx)(t.code,{children:"useBoundStore"})," \u7684 function\uFF0C\u9019\u500B function \u6703\u56DE\u50B3 ",(0,r.jsx)(t.code,{children:"useStore"})," \uFF0C\u4E26\u4E14\u628A api \u7269\u4EF6\u50B3\u5165 ",(0,r.jsx)(t.code,{children:"useStore"}),"\u3002"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-ts",metastring:"{10-11,13-14}",children:'const createImpl = <T>(createState: StateCreator<T, [], []>) => {\n  if (\n    import.meta.env?.MODE !== "production" &&\n    typeof createState !== "function"\n  ) {\n    console.warn(\n      "[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from \'zustand\'`."\n    );\n  }\n  const api =\n    typeof createState === "function" ? createStore(createState) : createState;\n\n  const useBoundStore: any = (selector?: any, equalityFn?: any) =>\n    useStore(api, selector, equalityFn);\n\n  Object.assign(useBoundStore, api);\n\n  return useBoundStore;\n};\n'})}),"\n",(0,r.jsx)(t.h3,{id:"createstore-vanillats",children:"createStore (vanilla.ts)"}),"\n",(0,r.jsxs)(t.p,{children:["\u63A5\u8457\u4F86\u770B\u4E00\u4E0B ",(0,r.jsx)(t.a,{href:"https://github.com/pmndrs/zustand/blob/6109bc3bd0f3850c2d9546956de971f27834ac7a/src/vanilla.ts#L109",children:"createStore"}),"\uFF1A"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-ts",children:"export const createStore = ((createState) =>\n  createState ? createStoreImpl(createState) : createStoreImpl) as CreateStore;\n"})}),"\n",(0,r.jsxs)(t.p,{children:["\u4E00\u6A23\u56DE\u50B3\u4E86\u4E00\u500B ",(0,r.jsx)(t.code,{children:"createStoreImpl"})," \u7684 fucntion\uFF1A"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-ts",metastring:"{4-5,20,29-33}",children:'const createStoreImpl: CreateStoreImpl = (createState) => {\n  type TState = ReturnType<typeof createState>;\n  type Listener = (state: TState, prevState: TState) => void;\n  let state: TState;\n  const listeners: Set<Listener> = new Set();\n\n  const setState: StoreApi<TState>["setState"] = (partial, replace) => {\n    // TODO: Remove type assertion once https://github.com/microsoft/TypeScript/issues/37663 is resolved\n    // https://github.com/microsoft/TypeScript/issues/37663#issuecomment-759728342\n    const nextState =\n      typeof partial === "function"\n        ? (partial as (state: TState) => TState)(state)\n        : partial;\n    if (!Object.is(nextState, state)) {\n      const previousState = state;\n      state =\n        replace ?? (typeof nextState !== "object" || nextState === null)\n          ? (nextState as TState)\n          : Object.assign({}, state, nextState);\n      listeners.forEach((listener) => listener(state, previousState));\n    }\n  };\n\n  const getState: StoreApi<TState>["getState"] = () => state;\n\n  const getInitialState: StoreApi<TState>["getInitialState"] = () =>\n    initialState;\n\n  const subscribe: StoreApi<TState>["subscribe"] = (listener) => {\n    listeners.add(listener);\n    // Unsubscribe\n    return () => listeners.delete(listener);\n  };\n\n  const destroy: StoreApi<TState>["destroy"] = () => {\n    if (import.meta.env?.MODE !== "production") {\n      console.warn(\n        "[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."\n      );\n    }\n    listeners.clear();\n  };\n\n  const api = { setState, getState, getInitialState, subscribe, destroy };\n  const initialState = (state = createState(setState, getState, api));\n  return api as any;\n};\n'})}),"\n",(0,r.jsxs)(t.p,{children:["\u9996\u5148\u53EF\u4EE5\u770B\u5230\u4ED6\u5BA3\u544A\u4E86\u4E00\u500B ",(0,r.jsx)(t.code,{children:"state"})," \u8B8A\u6578\uFF0C\u9019\u500B\u8B8A\u6578\u662F\u7528\u4F86\u5B58\u653E\u5168\u57DF\u7684 state \u503C\uFF0C\u7136\u5F8C\u5EFA\u7ACB\u4E86\u4E00\u500B ",(0,r.jsx)(t.code,{children:"listeners"})," \u7684 Set \u7269\u4EF6\uFF0C\u7528\u4F86\u5B58\u653E\u8A02\u95B1\u7684 function\u3002"]}),"\n",(0,r.jsx)(t.p,{children:"createStore \u7684\u91CD\u9EDE\u5728\u65BC\u4ED6\u5EFA\u7ACB\u4E86\u8207\u8A02\u95B1\u6A21\u5F0F\u76F8\u95DC\u7684 function\uFF1A"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.code,{children:"setState"}),"\uFF1A\u7528\u4F86\u66F4\u65B0 state \u7684 function\u3002"]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.code,{children:"getState"}),"\uFF1A\u53D6\u5F97\u76EE\u524D\u7684 state\u3002"]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.code,{children:"getInitialState"}),"\uFF1A\u53D6\u5F97\u521D\u59CB\u7684 state\u3002"]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.code,{children:"subscribe"}),"\uFF1A\u8A02\u95B1 state \u7684\u8B8A\u5316\u3002"]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.code,{children:"destroy"}),"\uFF1A\u92B7\u6BC0\u8A02\u95B1\u3002"]}),"\n"]}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.code,{children:"getState"})," \u8DDF ",(0,r.jsx)(t.code,{children:"getInitialState"})," \u90FD\u883B\u597D\u7406\u89E3\u7684\uFF0C\u5C31\u662F\u53D6\u5F97\u76EE\u524D\u7684 state \u8DDF\u521D\u59CB\u7684 state\u3002\n",(0,r.jsx)(t.code,{children:"setState"})," \u6709\u505A\u4E00\u5C64\u5224\u65B7\uFF0C\u5982\u679C\u65B0\u7684\u503C\u8DDF\u820A\u7684\u503C\u4E0D\u540C\uFF08\u4F7F\u7528 Object.is \u5224\u65B7\uFF09\uFF0C\u5C31\u6703\u53BB forEach listeners \u88E1\u9762\u5132\u5B58\u7684\u6240\u6709 function\uFF0C\u9019\u4E9B function \u6211\u7A31\u4E4B\u70BA",(0,r.jsx)(i.Z,{children:"\u66F4\u65B0\u51FD\u5F0F"}),"\uFF0C\u5F8C\u9762\u6703\u518D\u8AAA\u660E\u66F4\u65B0\u51FD\u5F0F\u662F\u4EC0\u9EBC\u3002\n",(0,r.jsx)(t.code,{children:"subscribe"})," \u5C31\u662F\u628A\u66F4\u65B0\u51FD\u5F0F\u52A0\u5165 listeners \u88E1\u9762\uFF0C\u4E26\u4E14\u56DE\u50B3\u4E00\u500B function \u7528\u4F86\u53D6\u6D88\u8A02\u95B1\u3002"]}),"\n",(0,r.jsx)(t.h3,{id:"usestore-reactts",children:"useStore (react.ts)"}),"\n",(0,r.jsxs)(t.p,{children:["\u6700\u5F8C\u4E00\u500B function \u662F ",(0,r.jsx)(t.a,{href:"https://github.com/pmndrs/zustand/blob/6109bc3bd0f3850c2d9546956de971f27834ac7a/src/react.ts#L53",children:"useStore"})," \u53EF\u4EE5\u8AAA\u662F zustand \u7684\u6838\u5FC3 function\uFF1A"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-ts",metastring:"{16-22}",children:'export function useStore<TState, StateSlice>(\n  api: WithReact<StoreApi<TState>>,\n  selector: (state: TState) => StateSlice = identity as any,\n  equalityFn?: (a: StateSlice, b: StateSlice) => boolean\n) {\n  if (\n    import.meta.env?.MODE !== "production" &&\n    equalityFn &&\n    !didWarnAboutEqualityFn\n  ) {\n    console.warn(\n      "[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from \'zustand/traditional\'. https://github.com/pmndrs/zustand/discussions/1937"\n    );\n    didWarnAboutEqualityFn = true;\n  }\n  const slice = useSyncExternalStoreWithSelector(\n    api.subscribe,\n    api.getState,\n    api.getServerState || api.getInitialState,\n    selector,\n    equalityFn\n  );\n  useDebugValue(slice);\n  return slice;\n}\n'})}),"\n",(0,r.jsxs)(t.p,{children:["\u4ED6\u628A\u525B\u525B\u5EFA\u7ACB\u7684 ",(0,r.jsx)(t.code,{children:"getState"})," \u8DDF ",(0,r.jsx)(t.code,{children:"subscribe"})," \u50B3\u5165 ",(0,r.jsx)(t.code,{children:"useSyncExternalStoreWithSelector"}),"\uFF0C\u4E26\u56DE\u50B3\u4E86\u5B83\u7684\u7D50\u679C\u3002"]}),"\n",(0,r.jsxs)(t.p,{children:["\u90A3\u9019\u500B ",(0,r.jsx)(t.code,{children:"useSyncExternalStoreWithSelector"})," \u53C8\u662F\u600E\u9EBC\u8FA6\u5230\u7684\u5462\uFF1F\u9019\u5C31\u8981\u63D0\u5230 react 18 \u65B0\u589E\u7684 hook ",(0,r.jsx)(t.a,{href:"https://ru.react.dev/reference/react/useSyncExternalStore",children:"useSyncExternalStore"}),"\u3002"]}),"\n",(0,r.jsx)(t.h3,{id:"usesyncexternalstore",children:"useSyncExternalStore"}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.code,{children:"useSyncExternalStore"})," \u662F react 18 \u65B0\u589E\u7684 hook\uFF0C\u7528\u4F86\u540C\u6B65 React \u5167\u90E8\u53CA\u5916\u90E8\u7684 state \u72C0\u614B\u3002\u9019\u662F\u4EC0\u9EBC\u610F\u601D\u5462\uFF1F\u6211\u5011\u90FD\u77E5\u9053 React \u5728\u66F4\u65B0 UI \u756B\u9762\u6642\uFF0C\u6703\u900F\u904E useState \u4F86\u66F4\u65B0 state\uFF0C\u4E26\u9032\u884C re-render\uFF0C\u4F46\u5982\u679C\u6211\u4ECA\u5929\u4E0D\u60F3\u7528 useState \u60F3\u8981\u96A8\u4FBF\u5EFA\u7ACB\u4E00\u500B\u7269\u4EF6\u5132\u5B58 state\uFF0C\u90A3\u6211\u8981\u600E\u9EBC\u544A\u8A34 React \u9019\u500B\u7269\u4EF6\u5E95\u4E0B\u7684\u503C\u6539\u8B8A\u6642\uFF0C\u5E6B\u6211\u91CD\u65B0\u9032\u884C\u756B\u9762\u66F4\u65B0\u5462\uFF1F\u9019\u5C31\u662F ",(0,r.jsx)(t.code,{children:"useSyncExternalStore"})," \u7684\u4F5C\u7528\u62C9\uFF01"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-ts",children:"const snapshot = useSyncExternalStore(\n  subscribe,\n  getSnapshot,\n  getServerSnapshot\n);\n"})}),"\n",(0,r.jsx)(t.p,{children:"\u6703\u50B3\u5165\u4E09\u500B\u53C3\u6578\uFF1A"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.code,{children:"subscribe"}),"\uFF1A\u8A02\u95B1 state \u7684\u8B8A\u5316\u3002"]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.code,{children:"getSnapshot"}),"\uFF1A\u53D6\u5F97\u7576\u524D\u6700\u65B0\u7684\u503C\u3002"]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.code,{children:"getServerSnapshot"}),"\uFF1A\u53D6\u5F97 SSR \u7684\u521D\u59CB\u72C0\u614B\uFF08\u53EF\u9078\uFF09\u3002"]}),"\n"]}),"\n",(0,r.jsxs)(t.p,{children:["\u800C\u56E0\u70BA\u9019\u500B hook \u662F React 18 \u65B0\u589E\u7684\uFF0C\u6240\u4EE5\u70BA\u4E86\u8B93\u4E4B\u524D\u7684\u7248\u672C\u4E5F\u53EF\u4EE5\u505A\u4F7F\u7528\uFF0C\u6240\u4EE5\u6709\u53E6\u5916\u628A\u9019\u500B hook \u62C9\u51FA\u4E00\u500B\u7368\u7ACB\u7684 package ",(0,r.jsx)(t.a,{href:"https://www.npmjs.com/package/use-sync-external-store",children:"use-sync-external-store"}),"\uFF0C\u900F\u904E\u9019\u500B package \u7684\u539F\u59CB\u78BC\uFF0C\u6211\u5011\u53EF\u4EE5\u4E00\u7ABA\u7A76\u7ADF\u9019\u500B hook \u5927\u6982\u662F\u600E\u9EBC\u5BE6\u4F5C\u7684\u3002"]}),"\n",(0,r.jsx)(c.Ei,{src:d}),"\n",(0,r.jsxs)(t.p,{children:["\u539F\u59CB\u78BC\u4F4D\u7F6E\u662F\u5728 react package \u5E95\u4E0B\u7684 ",(0,r.jsx)(t.a,{href:"https://github.com/facebook/react/blob/main/packages/use-sync-external-store/src/useSyncExternalStoreShimClient.js",children:"useSyncExternalStoreShimClient.js"})," \u88E1\u9762\uFF0C\u9019\u908A\u53EA\u5217\u51FA\u91CD\u9EDE\u7A0B\u5F0F\u78BC\uFF1A"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-ts",metastring:"{7,13-17}",children:"export function useSyncExternalStore<T>(\n  subscribe: (() => void) => () => void,\n  getSnapshot: () => T,\n  getServerSnapshot?: () => T,\n): T {\n  const value = getSnapshot();\n  const [{inst}, forceUpdate] = useState({inst: {value, getSnapshot}});\n\n  useEffect(() => {\n    if (checkIfSnapshotChanged(inst)) {\n      forceUpdate({inst});\n    }\n    const handleStoreChange = () => {\n      if (checkIfSnapshotChanged(inst)) {\n        forceUpdate({inst});\n      }\n    };\n    return subscribe(handleStoreChange);\n  }, [subscribe]);\n\n  useDebugValue(value);\n  return value;\n}\n"})}),"\n",(0,r.jsx)(t.p,{children:"\u53EF\u4EE5\u770B\u5230\u5176\u5BE6\u662F\u900F\u904E useState \u53CA useEffect \u4F86\u9054\u6210\u7684\uFF0CuseState \u7684\u90E8\u5206\u662F\u70BA\u4E86\u8B93 React \u91CD\u65B0 render\uFF0C\u4ED6\u5BE6\u4F5C\u4E86\u4E00\u500B\u5F37\u5236\u66F4\u65B0\u7684\u65B9\u6CD5\uFF0C\u56E0\u70BA\u4ED6\u6BCF\u6B21 setState \u7684\u6642\u5019\u90FD\u662F\u50B3\u5165\u4E00\u500B\u65B0\u7684\u7269\u4EF6\uFF0C\u800C React \u5167\u90E8\u5728\u5224\u65B7\u662F\u5426\u8981 re-render \u6642\uFF0C\u5169\u500B\u7269\u4EF6\u6703\u5224\u5B9A\u70BA\u4E0D\u540C\uFF0C\u6240\u4EE5\u5C31\u6703\u91CD\u65B0 render\u3002"}),"\n",(0,r.jsxs)(t.p,{children:["\u800C\u5728 useEffect \u7684\u90E8\u5206\uFF0C\u5B83\u5EFA\u7ACB\u4E86\u4E00\u500B ",(0,r.jsx)(t.code,{children:"handleStoreChange"})," \u7684 function\uFF0C\u88E1\u9762\u6703\u5148\u5224\u65B7\u76EE\u524D\u7684\u503C\u662F\u5426\u6709\u6539\u8B8A\uFF0C\u5982\u679C\u6709\u6539\u8B8A\u5C31\u6703\u547C\u53EB ",(0,r.jsx)(t.code,{children:"forceUpdate"})," \u4F86\u9032\u884C\u5F37\u5236\u66F4\u65B0\uFF0C\u800C\u9019\u500B ",(0,r.jsx)(t.code,{children:"handleStoreChange"})," \u4E5F\u5C31\u662F\u6211\u5011\u524D\u9762\u8AAA\u7684 ",(0,r.jsx)(i.Z,{children:"\u66F4\u65B0\u51FD\u5F0F"}),"\uFF0C\u6700\u5F8C\u900F\u904E ",(0,r.jsx)(t.code,{children:"subscribe"})," \u628A\u9019\u500B function \u52A0\u5165 listeners \u88E1\u9762\u3002"]}),"\n",(0,r.jsx)(t.h3,{id:"zustand-\u5167\u90E8\u8A02\u95B1\u6D41\u7A0B\u5716",children:"zustand \u5167\u90E8\u8A02\u95B1\u6D41\u7A0B\u5716"}),"\n",(0,r.jsxs)(t.p,{children:["\u4E0B\u9762\u662F",(0,r.jsx)(i.Z,{children:"\u66F4\u65B0\u51FD\u5F0F"}),"\u88AB\u52A0\u9032 listeners \u7684\u6D41\u7A0B\uFF1A"]}),"\n",(0,r.jsx)(c.Ei,{src:u,width:"700px",center:!0}),"\n",(0,r.jsx)(t.h3,{id:"zustand-\u66F4\u65B0-state-\u6D41\u7A0B\u5716",children:"zustand \u66F4\u65B0 state \u6D41\u7A0B\u5716"}),"\n",(0,r.jsx)(t.p,{children:"\u63A5\u4E0B\u4F86\u8B93\u6211\u5011\u4F86\u770B\u4E00\u4E0B\u5982\u679C\u4ECA\u5929\u6709\u591A\u500B\u5143\u4EF6\u4F7F\u7528\u4E86\u540C\u4E00\u500B zustand \u7684 state \u6642\uFF0C\u662F\u5982\u4F55\u9032\u884C\u66F4\u65B0\u7684\u3002\u73FE\u5728\u6709\u5169\u500B\u5143\u4EF6"}),"\n",(0,r.jsx)(c.Ei,{src:x,width:"350px",center:!0}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-jsx",metastring:'{3} title="Counter.js"',children:"import { useCountStore } from \"./store\";\nexport default function Counter() {\n  const { count, increment, decrement } = useCountStore();\n  return (\n    <div className='counter'>\n      <button onClick={decrement}>-</button>\n      <h1>{count}</h1>\n      <button onClick={increment}>+</button>\n    </div>\n  );\n}\n"})}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-jsx",metastring:'{3} title="Total.js"',children:'import { useCountStore } from "./store";\nexport default function Total() {\n  const { count } = useCountStore();\n  return (\n    <div>\n      <h1>Total Count: {count}</h1>\n    </div>\n  );\n}\n'})}),"\n",(0,r.jsxs)(t.p,{children:["\u9019\u5169\u500B\u5143\u4EF6\u90FD\u547C\u53EB\u4E86 ",(0,r.jsx)(t.code,{children:"useCountStore"})," \u4F86\u53D6\u5F97 count \u7684\u503C\uFF0C\u524D\u9762\u63D0\u5230 ",(0,r.jsx)(t.code,{children:"useCountStore"}),"\n\u6703\u547C\u53EB ",(0,r.jsx)(t.code,{children:"useSyncExternalStore"})," \u4F86\u628A ",(0,r.jsx)(i.Z,{children:"\u66F4\u65B0\u51FD\u5F0F"})," \u52A0\u5165\u5230 listeners\n\u88E1\u9762\uFF0C\u6240\u4EE5\u7576\u756B\u9762\u6E32\u67D3\u6642\uFF0Clisteners \u6703\u6709\u5169\u500B updator \u51FD\u5F0F\uFF0C\u800C\u7576 Counter \u547C\u53EB\u4E86 ",(0,r.jsx)(t.code,{children:"increment"})," \u6216 ",(0,r.jsx)(t.code,{children:"decrement"})," \u6642\uFF0C\u6703\u89F8\u767C zustand\n\u5167\u90E8\u7684 ",(0,r.jsx)(t.code,{children:"setState"}),"\uFF0C\u9019\u6642\u5019\u6703\u5148\u66F4\u65B0 state \u7684\u503C\uFF0C\u7136\u5F8C\u57F7\u884C listeners \u88E1\u9762\u7684\u6240\u6709 updator\n\u51FD\u5F0F\uFF0C\u9019\u6A23\u5C31\u6703\u8B93\u6240\u6709\u4F7F\u7528\u4E86\u9019\u500B state \u7684\u5143\u4EF6\u90FD\u91CD\u65B0 render\u3002"]}),"\n",(0,r.jsx)(c.Ei,{src:h,center:!0}),"\n",(0,r.jsx)(t.h2,{id:"zustand-\u6FC3\u7E2E\u7248",children:"zustand \u6FC3\u7E2E\u7248"}),"\n",(0,r.jsx)(t.p,{children:"\u5982\u679C\u628A zustand \u7684\u539F\u59CB\u78BC\u53EA\u4FDD\u7559\u6838\u5FC3\u529F\u80FD\uFF0C\u6703\u8B8A\u6210\u9019\u6A23\uFF1A"}),"\n",(0,r.jsxs)(t.ol,{children:["\n",(0,r.jsx)(t.li,{children:"create"}),"\n"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-ts",children:"export const create = (createState) => {\n  const api = createStore(createState);\n  return () => useStore(api);\n};\n"})}),"\n",(0,r.jsxs)(t.ol,{start:"2",children:["\n",(0,r.jsx)(t.li,{children:"createStore"}),"\n"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-ts",children:"const createStore = (createState) => {\n  let state = {};\n  const listeners = new Set();\n\n  const setState = (partial) => {\n    const nextState = partial(state);\n    state = { ...state, ...nextState };\n    listeners.forEach((listener) => listener());\n  };\n\n  const getState = () => state;\n\n  const subscribe = (listener) => {\n    listeners.add(listener);\n    return () => listeners.delete(listener);\n  };\n\n  state = createState(setState);\n\n  const api = { setState, getState, subscribe };\n  return api;\n};\n"})}),"\n",(0,r.jsxs)(t.ol,{start:"3",children:["\n",(0,r.jsx)(t.li,{children:"useStore"}),"\n"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-ts",children:'import { useSyncExternalStore } from "react";\n\nexport function useStore(api) {\n  const entireState = useSyncExternalStore(api.subscribe, api.getState);\n\n  return entireState;\n}\n'})}),"\n",(0,r.jsx)(t.h2,{id:"zustand-\u67B6\u69CB\u6A21\u5F0F",children:"zustand \u67B6\u69CB\u6A21\u5F0F"}),"\n",(0,r.jsxs)(t.p,{children:["Zustand \u7684\u5728 ",(0,r.jsx)(t.a,{href:"https://docs.pmnd.rs/zustand/guides/flux-inspired-practice",children:"Flux inspired practice"})," \u6709\u63D0\u5230\uFF1A"]}),"\n",(0,r.jsxs)(t.blockquote,{children:["\n",(0,r.jsx)(t.p,{children:"Although Zustand is an unopinionated library, we do recommend a few patterns. These are inspired by practices originally found in Flux, and more recently Redux, so if you are coming from another library, you should feel right at home."}),"\n"]}),"\n",(0,r.jsxs)(t.p,{children:["\u610F\u601D\u662F Zustand \u672C\u8EAB\u4E26\u6C92\u6709\u5F37\u5236\u8981\u6C42\u4F7F\u7528\u8005\u9075\u5FAA\u4EFB\u4F55\u7279\u5B9A\u7684\u67B6\u69CB\u6A21\u5F0F\uFF0C\u4F46\u662F\u5EFA\u8B70\u4F7F\u7528\u8005\u53EF\u4EE5\u53C3\u8003 Flux \u6216 Redux \u7684\u4E00\u4E9B\u5BE6\u8E10\u65B9\u5F0F\u3002Redux \u5728\u5B78 React \u7684\u6642\u5019\u61C9\u8A72\u90FD\u6709\u807D\u904E\uFF0C\u90A3\u9019\u500B ",(0,r.jsx)(t.strong,{children:"Flux"})," \u662F\u4EC0\u9EBC\u5462\uFF1F"]}),"\n",(0,r.jsx)(t.h3,{id:"flux",children:"Flux"}),"\n",(0,r.jsx)(t.p,{children:"Flux \u662F\u4E00\u7A2E\u67B6\u69CB\u6A21\u5F0F\uFF0C\u90A3\u4EC0\u9EBC\u662F\u67B6\u69CB\u6A21\u5F0F\u5462\uFF1F\u6BD4\u8F03\u5E38\u807D\u5230\u7684\u4F8B\u5B50\u5C31\u662F MVC\uFF0C\u67B6\u69CB\u6A21\u5F0F\u7684\u76EE\u7684\u662F\u7528\u4F86\u5E6B\u52A9\u6211\u5011\u53EF\u4EE5\u66F4\u597D\u7684\u7D44\u7E54\u7A0B\u5F0F\u78BC\uFF0C\u8B93\u7A0B\u5F0F\u78BC\u66F4\u52A0\u5BB9\u6613\u7DAD\u8B77\u3001\u64F4\u5145\u3002\u800C Flux \u5247\u662F\u5F9E MVC \u6240\u555F\u767C\u51FA\u4F86\u7684\u4E00\u7A2E\u67B6\u69CB\u6A21\u5F0F\u3002"}),"\n",(0,r.jsxs)(t.admonition,{title:"MVC",type:"info",children:[(0,r.jsxs)(t.p,{children:["MVC \u6A21\u5F0F\u6700\u65E9\u7531 Trygve Reenskaug \u5728 1978 \u5E74\u63D0\u51FA\uFF0C\u4E26\u4E14\u5728 University of Oslo \u6709\u7559\u4E0B",(0,r.jsx)(t.a,{href:"https://www.duo.uio.no/bitstream/handle/10852/9621/Reenskaug-MVC.pdf?sequence=1&isAllowed=y",children:"\u7814\u7A76\u5831\u544A"}),"\uFF0C\u4ED6\u628A\u61C9\u7528\u7A0B\u5F0F\u5206\u70BA\u4E09\u500B\u90E8\u5206\uFF1A"]}),(0,r.jsxs)(t.ol,{children:["\n",(0,r.jsx)(t.li,{children:"Model: \u8CA0\u8CAC\u8655\u7406\u8CC7\u6599"}),"\n",(0,r.jsx)(t.li,{children:"View: \u8CA0\u8CAC\u986F\u793A\u756B\u9762"}),"\n",(0,r.jsx)(t.li,{children:"Controller: \u8CA0\u8CAC\u8655\u7406 View \u7684\u4E8B\u4EF6\uFF0C\u4E5F\u6703\u8AAA\u662F View \u53CA Model \u4E4B\u9593\u7684\u6A4B\u6A11"}),"\n"]}),(0,r.jsx)(t.p,{children:"MVC \u7684\u597D\u8655\u662F\u53EF\u4EE5\u8B93\u7A0B\u5F0F\u78BC\u66F4\u52A0\u6A21\u7D44\u5316\uFF0C\u6BCF\u500B\u90E8\u5206\u90FD\u6709\u81EA\u5DF1\u7684\u8CAC\u4EFB\uFF0C\u4E0D\u6703\u4E92\u76F8\u5E72\u64FE\uFF0C\u4E5F\u8B93\u7A0B\u5F0F\u78BC\u66F4\u5BB9\u6613\u7DAD\u8B77\u3002"})]}),"\n",(0,r.jsx)(t.p,{children:"\u96D6\u7136 MVC \u7684\u67B6\u69CB\u5B9A\u7FA9\u4E86\u4E09\u500B\u90E8\u5206\u7684\u8077\u8CAC\uFF0C\u4E0D\u904E\u5C0D\u65BC\u4E09\u500B\u90E8\u5206\u4E4B\u9593\u7684\u6E9D\u901A\u65B9\u5F0F\u4E26\u6C92\u6709\u660E\u78BA\u7684\u5B9A\u7FA9\uFF0C\u6240\u4EE5\u5728\u5BE6\u969B\u61C9\u7528\u6642\uFF0C\u53EF\u80FD\u6703\u6709\u4E0D\u540C\u7684\u5BE6\u4F5C\u65B9\u5F0F\uFF0C\u9019\u4E5F\u662F\u70BA\u4EC0\u9EBC\u6709\u5F88\u591A\u4E0D\u540C\u7684 MVC \u8B8A\u9AD4\uFF0C\u50CF\u662F MVP\u3001MVVM \u7B49\u7B49\uFF0C\u800C Flux \u7684\u51FA\u73FE\u5C31\u662F\u70BA\u4E86\u89E3\u6C7A MVC \u5728\u8CC7\u6599\u6D41\u4E0A\u4E0D\u597D\u8FFD\u8E64\u7684\u554F\u984C\u3002"}),"\n",(0,r.jsxs)(t.p,{children:["Flux \u662F React \u5728 2014 \u5E74\u7684 ",(0,r.jsx)(t.a,{href:"https://www.youtube.com/watch?v=nYkdrAPrdcw&ab_channel=MetaDevelopers",children:"Hacker Way conference"})," \u4E0A\u63D0\u51FA\u7684\u6982\u5FF5\uFF0C\u70BA\u7684\u5C31\u662F\u89E3\u6C7A Facebook \u5728\u4F7F\u7528 MVC \u67B6\u69CB\u6240\u9047\u5230\u7684\u554F\u984C\u3002Facebook \u6700\u521D\u662F\u4F7F\u7528\u96D9\u5411\u7D81\u5B9A\u7684\u65B9\u5F0F\u9032\u884C\u8CC7\u6599\u50B3\u905E\uFF0C\u4F46\u96A8\u8457\u5C08\u6848\u8D8A\u4F86\u8D8A\u5927\uFF0C\u8CC7\u6599\u6D41\u8B8A\u5F97\u8D8A\u4F86\u8D8A\u8907\u96DC\u3002"]}),"\n",(0,r.jsx)(c.Ei,{src:p}),"\n",(0,r.jsxs)(t.admonition,{title:"\u5C0F\u722D\u8B70",type:"info",children:[(0,r.jsxs)(t.p,{children:["\u9019\u5F35\u5716\u5728\u7576\u6642\u5F15\u8D77\u4E0D\u5C11\u7684",(0,r.jsx)(t.a,{href:"https://www.reddit.com/r/programming/comments/25nrb5/facebook_mvc_does_not_scale_use_flux_instead/",children:"\u8A0E\u8AD6"}),"\uFF0C\u6709\u4EBA\u8A8D\u70BA facebook \u7684 MVC \u5716\u662F\u932F\u7684\uFF0C\u771F\u6B63\u7684 MVC \u624D\u4E0D\u6703\u53EA\u6709\u4E00\u500B controller\uFF0C\u4E5F\u6709\u4EBA\u8A8D\u70BA Flux \u6839\u672C\u53EA\u662F MVC \u63DB\u500B\u540D\u8A5E\u3002"]}),(0,r.jsxs)(t.p,{children:["\u800C\u7576\u6642\u7684\u6F14\u8B1B\u8005 Jing Chen \u4E5F\u6709\u51FA\u4F86",(0,r.jsx)(t.a,{href:"https://www.reddit.com/r/programming/comments/25nrb5/comment/chjbo05/?utm_source=share&utm_medium=web3x&utm_name=web3xcss&utm_term=1&utm_content=share_button",children:"\u8AAA\u660E"}),"\uFF0C\u9019\u5F35\u5716\u7684\u78BA\u662F\u6709\u9EDE\u6295\u6A5F\u53D6\u5DE7\uFF0C\u4E0D\u904E\u91CD\u9EDE\u9084\u662F\u5728\u65BC\u96D9\u5411\u8CC7\u6599\u6D41\u6240\u9020\u6210\u7684\u554F\u984C\uFF0C\u800C Flux \u4E2D\u7684 dispatcher \u4E26\u4E0D\u7B49\u540C\u65BC controller\uFF0C\u4ED6\u53EA\u662F\u4E00\u500B\u5206\u767C action \u7684 callback \u4F86\u9054\u6210\u55AE\u5411\u8CC7\u6599\u6D41\u7684\u76EE\u7684\u3002"]})]}),"\n",(0,r.jsx)(t.p,{children:"meta \u5DE5\u7A0B\u5E2B\u8209\u7684\u5BE6\u969B\u4F8B\u5B50\u662F\u7576\u521D\u505A message chat \u7684\u6642\u5019\uFF0C\u4E00\u958B\u59CB\u53EA\u6709\u4E00\u500B\u5340\u584A\u8DDF\u8A0A\u606F\u6709\u95DC\uFF0C\u4F46\u5F8C\u4F86\u8D8A\u4F86\u8D8A\u591A\u529F\u80FD\u6703\u5C0D\u8A0A\u606F\u7684\u6578\u91CF\u9020\u6210\u5F71\u97FF\u3002"}),"\n",(0,r.jsxs)(t.p,{children:["\u800C\u9047\u5230\u7684 bug \u5C31\u662F",(0,r.jsx)(t.strong,{children:"\u672A\u8B80\u8A0A\u606F"}),"\u7684\u6578\u5B57\u4E0D\u6E96\u78BA\uFF0C\u56E0\u70BA\u5F88\u591A\u7684\u5340\u584A\u90FD\u6709\u53EF\u80FD\u6703\u5F71\u97FF\u5230\u672A\u8B80\u8A0A\u606F\u7684\u6578\u5B57\uFF0C\u6240\u4EE5\u8981\u8FFD\u8E64\u5230\u5E95\u662F\u54EA\u500B\u5340\u584A\u9020\u6210\u7684 bug \u5C31\u8B8A\u5F97\u975E\u5E38\u56F0\u96E3\uFF0C\u800C meta \u6BCF\u6B21\u9047\u5230\u9019\u500B bug \u90FD\u662F\u53BB\u89E3\u6C7A\u90A3\u4E9B edge case (\u908A\u754C\u6848\u4F8B)\uFF0C\u6C92\u6709\u771F\u7684\u89E3\u6C7A\u6838\u5FC3\u554F\u984C\uFF0C\u6240\u4EE5\u5C0E\u81F4\u6BCF\u6B21\u65B0\u589E\u529F\u80FD\u90FD\u6703\u6709\u65B0\u7684 bug \u7522\u751F\u3002"]}),"\n",(0,r.jsx)(c.Ei,{src:S}),"\n",(0,r.jsxs)(t.p,{children:["\u4ED6\u5011\u8A8D\u70BA\u9019\u662F\u56E0\u70BA MVC \u7684\u96D9\u5411\u7D81\u5B9A\u9020\u6210\u7684\uFF0C\u7576\u8CC7\u6599\u6D41\u8B8A\u5F97\u8D8A\u4F86\u8D8A\u8907\u96DC\u6642\uFF0C\u5C31\u6703\u8B8A\u5F97\u975E\u5E38\u96E3\u4EE5\u8FFD\u8E64\uFF0C\u6240\u4EE5\u63D0\u51FA\u4E86 Flux \u7684",(0,r.jsx)(t.strong,{children:"\u55AE\u5411\u8CC7\u6599\u6D41"}),"\u7684\u67B6\u69CB\u3002"]}),"\n",(0,r.jsx)(t.p,{children:"Flux \u5C07\u8CC7\u6599\u6D41\u7684\u50B3\u905E\u5206\u70BA\u56DB\u500B\u90E8\u5206\uFF1A"}),"\n",(0,r.jsxs)(t.ol,{children:["\n",(0,r.jsx)(t.li,{children:"Action\uFF1A\u7269\u4EF6\u7D50\u69CB\u5305\u542B\u884C\u70BA\u5B9A\u7FA9\u53CA\u50B3\u905E\u7684\u8CC7\u8A0A"}),"\n",(0,r.jsx)(t.li,{children:"Dispatcher\uFF1A\u8CA0\u8CAC\u5206\u767C Action \u7684\u51FD\u5F0F"}),"\n",(0,r.jsx)(t.li,{children:"Store\uFF1A\u5132\u5B58\u8CC7\u6599\u53CA\u56DE\u61C9 Action \u7684\u884C\u70BA"}),"\n",(0,r.jsx)(t.li,{children:"\u986F\u793A Store \u63D0\u4F9B\u7684\u8CC7\u6599\u756B\u9762"}),"\n"]}),"\n",(0,r.jsx)(c.Ei,{src:j}),"\n",(0,r.jsx)(t.h3,{id:"redux",children:"Redux"}),"\n",(0,r.jsxs)(t.p,{children:["\u5728\u63D0\u51FA Flux \u67B6\u69CB\u7684\u540C\u6642\uFF0Cmeta \u4E5F\u63D0\u51FA\u4E86\u4E00\u500B\u53EB ",(0,r.jsx)(t.a,{href:"https://facebookarchive.github.io/flux/",children:"Flux"})," \u7684 library\uFF0C\u4E0D\u904E\u4E26\u6C92\u6709\u53D7\u5230\u592A\u591A\u7684\u95DC\u6CE8\uFF0C\u76F4\u5230\u9694\u4E00\u5E74 Dan Abramov \u63D0\u51FA\u4E86\u57FA\u65BC Flux \u6982\u5FF5\u5BE6\u4F5C\u7684 library ",(0,r.jsx)(t.a,{href:"https://redux.js.org/",children:"Redux"}),"\uFF0C\u9019\u500B library \u5F8C\u4F86\u6210\u70BA\u4E86 React \u6700\u53D7\u6B61\u8FCE\u7684\u72C0\u614B\u7BA1\u7406 library \u4E4B\u4E00\u3002"]}),"\n",(0,r.jsxs)(t.p,{children:["\u5728 Redux \u7684",(0,r.jsx)(t.a,{href:"https://redux.js.org/tutorials/fundamentals/part-2-concepts-data-flow#redux-application-data-flow",children:"\u5B98\u7DB2"}),"\u53EF\u4EE5\u660E\u78BA\u7684\u770B\u5230\u6574\u500B redux \u7684\u8CC7\u6599\u6D41\uFF1A"]}),"\n",(0,r.jsx)(c.Ei,{src:f}),"\n",(0,r.jsx)(t.h2,{id:"\u7E3D\u7D50",children:"\u7E3D\u7D50"}),"\n",(0,r.jsx)(t.p,{children:"\u5176\u5BE6\u5149\u770B Flux \u53CA Redux \u7684\u5716\uFF0C\u6703\u89BA\u5F97\u597D\u50CF\u8DDF MVC \u6C92\u6709\u4EC0\u9EBC\u5DEE\u5225\uFF0C\u4E5F\u662F\u5B9A\u7FA9\u500B\u5225\u7684\u8077\u8CAC\uFF0CView \u8DDF Model \u5206\u958B\uFF0C\u4E5F\u6709\u985E\u4F3C controller \u7684\u6771\u897F\u3002\u4E0D\u904E\u91CD\u9EDE\u5728\u65BC\u5B83\u66F4\u52A0\u56B4\u8B39\u7684\u5B9A\u7FA9\u4E86\u8CC7\u6599\u6D41\u7684\u65B9\u5411\uFF0C\u8B93\u8CC7\u6599\u66F4\u597D\u7684\u7D71\u4E00\uFF0C\u96D6\u7136 MVC \u67B6\u69CB\u4E5F\u8FA6\u5F97\u5230\u9019\u4EF6\u4E8B\uFF0C\u4F46\u4E26\u4E0D\u662F\u6BCF\u500B\u4EBA\u90FD\u6703\u9019\u9EBC\u505A\uFF0C\u6240\u4EE5\u6211\u8A8D\u7232 Flux \u9084\u662F\u8DDF MVC \u6709\u6240\u5340\u5225\u3002"}),"\n",(0,r.jsx)(t.p,{children:"\u56DE\u5230 zustand\uFF0C\u4E4B\u6240\u4EE5\u80FD\u5920\u5BEB\u7684\u90A3\u9EBC\u7C21\u6F54\u65B9\u908A\u4F7F\u7528\uFF0C\u662F\u56E0\u70BA\u4ED6\u4E26\u4E0D\u662F\u5B8C\u5168\u7684\u5BE6\u4F5C\u4E86 Flux\uFF0C\u4ED6\u6368\u68C4\u4E86 Flux \u4E2D\u7684 Action \u53CA Dispatcher\uFF0C\u53EA\u4FDD\u7559\u4E86 Store \u7684\u90E8\u5206\uFF0C\u5728 DX (Developer Experience) \u4E0A\u7684\u9AD4\u9A57\u5C31\u6BD4\u8F03\u597D\uFF0C\u800C\u96D6\u7136\u4E0D\u662F\u56B4\u8B39\u7684 Flux \u67B6\u69CB\uFF0C\u4F46\u9084\u662F\u9075\u5FAA\u8457\u6700\u57FA\u672C\u7684\u55AE\u5411\u8CC7\u6599\u6D41\u7684\u539F\u5247\uFF0C\u8B93\u6211\u5011\u53EF\u4EE5\u66F4\u597D\u7684\u9032\u884C\u7BA1\u7406\u72C0\u614B\u3002"}),"\n",(0,r.jsx)(t.p,{children:"\u7E3D\u800C\u8A00\u4E4B\uFF0C\u5982\u679C\u4E0D\u60F3\u4F7F\u7528 React \u539F\u751F\u7684 useContext\uFF0C\u800C\u5B78\u7FD2 Redux \u7684\u5165\u9580\u53C8\u6709\u9EDE\u592A\u9AD8\uFF0Czustand \u662F\u4E00\u500B\u5F88\u597D\u7684\u9078\u64C7\uFF0C\u5728\u505A side project \u6216\u662F\u5C0F\u578B\u5C08\u6848\u7D55\u5C0D\u662F\u975E\u5E38\u5920\u7528\u7684\uFF0C\u800C\u4E14\u4E5F\u53EF\u4EE5\u8B93\u4F60\u5C0D\u72C0\u614B\u7BA1\u7406\u6709\u66F4\u6DF1\u7684\u4E86\u89E3\uFF01"}),"\n",(0,r.jsx)(t.p,{children:"\u6709\u4EFB\u4F55\u554F\u984C\u6216\u662F\u5167\u5BB9\u6709\u8AA4\u7684\u5730\u65B9\uFF0C\u6B61\u8FCE\u5728\u5E95\u4E0B\u7559\u8A00 ~"}),"\n",(0,r.jsx)(t.h2,{id:"\u53C3\u8003\u8CC7\u6599",children:"\u53C3\u8003\u8CC7\u6599"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.a,{href:"https://medium.com/%E6%89%8B%E5%AF%AB%E7%AD%86%E8%A8%98/a-comparison-of-react-state-management-libraries-ba61db07332b",children:"React \u72C0\u614B\u7BA1\u7406\u5957\u4EF6\u6BD4\u8F03\u8207\u539F\u7406\u5BE6\u73FE feat. Redux, Zustand, Jotai, Recoil, MobX, Valtio"})}),"\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.a,{href:"https://juejin.cn/post/7178318352174022717",children:"\u662F\u65F6\u5019\u653E\u5F03 redux \u4E86\uFF0Czustand \u662F\u5B8C\u7F8E\u66FF\u4EE3\u8005\uFF08\u4E3B\u8981\u662F\u6E90\u7801\u5206\u6790\uFF09"})}),"\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.a,{href:"https://medium.com/wix-engineering/the-rise-of-flux-how-facebooks-shift-away-from-mvc-led-to-a-new-era-of-ui-architecture-61d78b4377b0",children:"The Rise of Flux: How Facebook\u2019s Shift Away from MVC Led to a New Era of UI Architecture"})}),"\n"]})]})}function w(e={}){let{wrapper:t}={...(0,a.a)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(v,{...e})}):v(e)}},144:function(e,t,n){n.d(t,{Z:function(){return a}});var s=n(5893);n(7294);var r=n(7227);function a(e){let{children:t,fallback:n}=e;return(0,r.Z)()?(0,s.jsx)(s.Fragment,{children:t?.()}):n??null}},1968:function(e,t,n){n.d(t,{Z:function(){return r}});var s=n(5893);let r=e=>{let{children:t,color:n,block:r,bold:a,style:c}=e,i="";switch(n){case"yellow":i="highlight-yellow";break;case"blue":i="highlight-blue";break;case"green":i="highlight-green";break;case"red":i="highlight-red";break;default:i="highlight-yellow"}let l={fontWeight:a?"bold":"normal",...c};return r?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:`${i} highlight`,style:{...l},children:t}),(0,s.jsx)("p",{})]}):(0,s.jsx)("span",{className:`${i} highlight`,style:{...l},children:t})}},9366:function(e,t,n){n.d(t,{Ei:function(){return c},gO:function(){return i},nI:function(){return l}});var s=n(5893),r=n(144),a=n(1094);n(7294);let c=e=>{let{src:t,width:n="100%",center:r=!1,style:a={}}=e,c={width:`min(100%,${n})`,display:r?"block":"inline-block",margin:r?"0 auto":"0",borderRadius:"5px",...a};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("img",{src:t,style:{...c}}),(0,s.jsx)("br",{}),(0,s.jsx)("br",{})]})},i=e=>{let{children:t,width:n="100%",center:c=!1,style:i={}}=e;return(0,s.jsx)(r.Z,{children:()=>{let{sm:e}=(0,a.Z)(),r={width:`min(100%,${n})`,margin:c?"0 auto":"0",display:"flex",flexDirection:e?"column":"row",gap:"10px",alignItems:"center",...i};return(0,s.jsx)("div",{style:{...r},children:t})}})},l=e=>{let{style:t,width:n="100%",src:r}=e,a={width:`min(100%,${n})`,flex:1,...t};return(0,s.jsx)("div",{style:{...a},children:(0,s.jsx)(c,{src:r})})}},1094:function(e,t,n){n.d(t,{Z:function(){return a}});var s=n(7294);let r=635,a=()=>{let[e,t]=(0,s.useState)({width:window.innerWidth,height:window.innerHeight}),[n,a]=(0,s.useState)(!1);return(0,s.useLayoutEffect)(()=>{let e=()=>{let{innerWidth:e,innerHeight:n}=window;t({width:e,height:n}),a(e<=r)};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[]),{sm:n,windowSize:e}}},65:function(e,t,n){n.d(t,{Z:function(){return i},a:function(){return c}});var s=n(7294);let r={},a=s.createContext(r);function c(e){let t=s.useContext(a);return s.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),s.createElement(a.Provider,{value:t},e.children)}}}]);