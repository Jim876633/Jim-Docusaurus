"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([["7853"],{7202:function(e,n,r){r.r(n),r.d(n,{metadata:()=>s,contentTitle:()=>l,default:()=>h,assets:()=>a,toc:()=>u,frontMatter:()=>c});var s=JSON.parse('{"id":"ithome2023/day04","title":"[Day 04] Jest \u9032\u968E\u6A21\u64EC\u8A9E\u6CD5","description":"\u4E0A\u4E00\u7BC7\u4ECB\u7D39\u4E86 Jest \u7684\u57FA\u672C\u8A9E\u6CD5\uFF0C\u63A5\u4E0B\u4F86\u8981\u4F86\u4ECB\u7D39 Jest \u7684\u9032\u968E\u6A21\u64EC\u8A9E\u6CD5\u3002","source":"@site/docs/ithome2023/day04.mdx","sourceDirName":"ithome2023","slug":"/ithome2023/day04","permalink":"/ithome2023/day04","draft":false,"unlisted":false,"tags":[{"inline":false,"label":"IT Home 2023","permalink":"/tags/ithome-2023","description":"IT Home \u9435\u4EBA\u8CFD 2023 \u5E74\u7CFB\u5217\u6587\u7AE0"}],"version":"current","lastUpdatedAt":1718173908000,"frontMatter":{"title":"[Day 04] Jest \u9032\u968E\u6A21\u64EC\u8A9E\u6CD5","tags":["ithome2023"]},"sidebar":"tutorialSidebar","previous":{"title":"[Day 03] JavaScript \u6E2C\u8A66\u6846\u67B6\u4ECB\u7D39 & Jest \u57FA\u672C\u8A9E\u6CD5","permalink":"/ithome2023/day03"},"next":{"title":"[Day 05] React \u6E2C\u8A66\u5B89\u88DD\u4ECB\u7D39 ( CRA / Vite / Next.js )","permalink":"/ithome2023/day05"}}'),t=r("5893"),i=r("65"),m=r("9366");let o=r.p+"assets/images/day4-1-ca4244ac8b40e7aaed72e5e024b4a5a5.png",d=r.p+"assets/images/day4-2-4bd657ca34e194393996eb17d785a4cf.png",c={title:"[Day 04] Jest \u9032\u968E\u6A21\u64EC\u8A9E\u6CD5",tags:["ithome2023"]},l=void 0,a={},u=[{value:"Timer Mock (\u6A21\u64EC\u8A08\u6642\u5668)",id:"timer-mock-\u6A21\u64EC\u8A08\u6642\u5668",level:2},{value:"jest.useFakeTimers",id:"jestusefaketimers",level:3},{value:"jest.advanceTimersByTime",id:"jestadvancetimersbytime",level:3},{value:"jest.runAllTimers",id:"jestrunalltimers",level:3},{value:"jest.clearAllTimers",id:"jestclearalltimers",level:3},{value:"jest.mock (\u6A21\u7D44\u6A21\u64EC)",id:"jestmock-\u6A21\u7D44\u6A21\u64EC",level:2},{value:"jest.spyOn (\u6A21\u7D44\u51FD\u5F0F\u6A21\u64EC)",id:"jestspyon-\u6A21\u7D44\u51FD\u5F0F\u6A21\u64EC",level:2},{value:"jest.fn (\u51FD\u5F0F\u6A21\u64EC)",id:"jestfn-\u51FD\u5F0F\u6A21\u64EC",level:2}];function j(e){let n={a:"a",code:"code",h2:"h2",h3:"h3",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.p,{children:"\u4E0A\u4E00\u7BC7\u4ECB\u7D39\u4E86 Jest \u7684\u57FA\u672C\u8A9E\u6CD5\uFF0C\u63A5\u4E0B\u4F86\u8981\u4F86\u4ECB\u7D39 Jest \u7684\u9032\u968E\u6A21\u64EC\u8A9E\u6CD5\u3002"}),"\n",(0,t.jsx)(n.h2,{id:"timer-mock-\u6A21\u64EC\u8A08\u6642\u5668",children:"Timer Mock (\u6A21\u64EC\u8A08\u6642\u5668)"}),"\n",(0,t.jsxs)(n.p,{children:["\u6709\u6642\u5019\u5728\u6E2C\u8A66 ",(0,t.jsx)(n.code,{children:"setTimeout"})," \u6216\u662F ",(0,t.jsx)(n.code,{children:"setInterval"})," \u7684\u6642\u5019\u90FD\u9700\u8981\u5BE6\u969B\u7B49\u5230\u6642\u9593\u5230\u624D\u80FD\u6E2C\u8A66\uFF0C\u50CF\u7C21\u8A0A\u9A57\u8B49\u5230\u671F\u6E2C\u8A66\uFF0C\u6BCF\u6B21\u90FD\u8981\u7B49\u500B\u4E94\u5206\u9418\u624D\u80FD\u6E2C\uFF0C\u9019\u6A23\u6E2C\u8A66\u7684\u6548\u7387\u5C31\u975E\u5E38\u4F4E\uFF0C\u9019\u6642\u5019\u5C31\u53EF\u4EE5\u4F7F\u7528 Jest \u7684 Timer Mock \u4F86\u6A21\u64EC\u8A08\u6642\u5668\u3002"]}),"\n",(0,t.jsx)(n.p,{children:'\u5047\u8A2D\u73FE\u5728\u6709\u4E00\u500B\u51FD\u5F0F\u6703\u56DE\u50B3\u4E00\u500B Promise\uFF0C\u5728 3 \u79D2\u5F8C\u56DE\u50B3 "time out"'}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",metastring:'title="timer.js"',children:'const timer = async () => {\n  return new Promise((resolve, reject) => {\n    setTimeout(() => {\n      resolve("time out"); // \u56DE\u50B3 "time out"\n    }, 3000);\n  });\n};\n\nexport default timer;\n'})}),"\n",(0,t.jsx)(n.p,{children:"\u5BE6\u969B\u5728\u4EBA\u5DE5\u6E2C\u8A66\u7684\u6642\u5019\uFF0C\u9700\u8981\u7B49\u5F85 3 \u79D2\u624D\u80FD\u6E2C\u8A66\uFF0C\u90A3\u6211\u5011\u5982\u679C\u76F4\u63A5\u7528 Jest \u8DD1\u6E2C\u8A66"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",metastring:'title="timer.test.js"',children:'import timer from "./timer";\n\ndescribe("timer", () => {\n  it(\'should resolve with "time out" after 3 seconds\', async () => {\n    const promise = timer();\n    const result = await promise; // \u7B49\u5F85 promise 3 \u79D2\u5F8C\u56DE\u50B3\n    expect(result).toBe("time out");\n  });\n});\n'})}),"\n",(0,t.jsx)(n.p,{children:"\u4E5F\u6703\u9700\u8981\u7B49 3 \u79D2\u624D\u6703\u8DD1\u5B8C"}),"\n",(0,t.jsx)(m.Ei,{src:o}),"\n",(0,t.jsx)(n.p,{children:"\u9019\u6642\u5019\u5C31\u53EF\u4EE5\u4F7F\u7528 Jest \u7684 Timer Mock \u4F86\u6A21\u64EC\u8A08\u6642\u5668\uFF0C\u628A\u539F\u672C\u7684\u6E2C\u8A66\u6539\u6210\u9019\u6A23"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",metastring:'title="timer.test.js"',children:'import timer from "./timer";\njest.useFakeTimers(); // \u4F7F\u7528 Jest \u7684 Timer Mock\n\ndescribe("timer", () => {\n  it(\'should resolve with "time out" after 3 seconds\', async () => {\n    const promise = timer();\n    jest.advanceTimersByTime(3000); // \u6A21\u64EC\u6642\u9593\u7D93\u904E 3 \u79D2\n    const result = await promise;\n    expect(result).toBe("time out");\n  });\n});\n'})}),"\n",(0,t.jsx)(n.p,{children:"\u8DD1\u6E2C\u8A66\u7684\u6642\u5019\uFF0C\u5C31\u6703\u76F4\u63A5\u8DF3\u904E\u7B49\u5F85\u6642\u9593"}),"\n",(0,t.jsx)(m.Ei,{src:d}),"\n",(0,t.jsx)(n.p,{children:"\u662F\u4E0D\u662F\u5F88\u65B9\u4FBF\u554A\uFF5E"}),"\n",(0,t.jsx)(n.p,{children:"\u518D\u4F86\u5C31\u4F86\u4ECB\u7D39\u4E00\u4E0B Timer Mock \u7684\u76F8\u95DC API"}),"\n",(0,t.jsx)(n.h3,{id:"jestusefaketimers",children:"jest.useFakeTimers"}),"\n",(0,t.jsxs)(n.p,{children:["\u555F\u7528 Time Mock\uFF0C\u5E95\u5C64\u662F\u7528 ",(0,t.jsx)(n.a,{href:"https://github.com/sinonjs/fake-timers",children:"@sinonjs/fake-timers"})," \u6240\u505A\uFF0C\u5B83\u505A\u7684\u4E8B\u60C5\u5C31\u662F\u628A\u6240\u6709\u6709\u95DC\u6642\u9593\u7684 API \u90FD",(0,t.jsx)(n.strong,{children:"\u66FF\u63DB\u6210\u6A21\u64EC\u7684\u8A08\u6642\u5668"}),"\uFF0C\u5E38\u7528\u7684\u50CF\u662F"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"setTimeout"}),"\n",(0,t.jsx)(n.li,{children:"setInterval"}),"\n",(0,t.jsx)(n.li,{children:"clearTimeout"}),"\n",(0,t.jsx)(n.li,{children:"clearInterval"}),"\n",(0,t.jsx)(n.li,{children:"Date"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"\u6240\u4EE5\u5728\u4EFB\u4F55\u6A21\u64EC\u6642\u9593\u7684\u6E2C\u8A66\u4E2D\uFF0C\u90FD\u9700\u8981\u5148\u4F7F\u7528 jest.useFakeTimers() \u4F86\u555F\u7528\u6A21\u64EC\u8A08\u6642\u5668\u3002"}),"\n",(0,t.jsxs)(n.p,{children:["\u5982\u679C\u60F3\u8981\u95DC\u9589\u6A21\u64EC\u8A08\u6642\u5668\uFF0C\u53EF\u4EE5\u4F7F\u7528 ",(0,t.jsx)(n.code,{children:"jest.useRealTimers()"})," \u4F86\u95DC\u9589\u3002"]}),"\n",(0,t.jsx)(n.h3,{id:"jestadvancetimersbytime",children:"jest.advanceTimersByTime"}),"\n",(0,t.jsxs)(n.p,{children:["\u9867\u540D\u601D\u7FA9\u5C31\u662F",(0,t.jsx)(n.strong,{children:"\u6A21\u64EC\u6642\u9593\u7D93\u904E"}),"\uFF0C\u9019\u500B API \u6703\u8B93\u6A21\u64EC\u8A08\u6642\u5668\u7D93\u904E\u6307\u5B9A\u7684\u6BEB\u79D2\u6578\uFF0C\u8B93\u8A08\u6642\u5668\u53EF\u4EE5\u8DD1\u5230\u6307\u5B9A\u7684\u6642\u9593\u9EDE\u3002"]}),"\n",(0,t.jsxs)(n.p,{children:["\u4ED6\u653E\u7F6E\u7684\u4F4D\u7F6E\u5FC5\u9808\u8981\u5728\u7A0B\u5F0F\u7684\u8A08\u6642\u5668\u88AB\u89F8\u767C\u4E4B\u5F8C\uFF0C\u4E0D\u7136\u6703\u6C92\u6709\u6548\u679C\u3002\u4EE5\u525B\u525B\u7684\u4F8B\u5B50\u70BA\u4F8B\uFF0C\u5982\u679C\u628A ",(0,t.jsx)(n.code,{children:"jest.advanceTimersByTime()"})," \u653E\u5728\u4EFB\u4F55\u5176\u4ED6\u4F4D\u7F6E\uFF0C\u6E2C\u8A66\u90FD\u6703\u5931\u6557\u3002"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:'import timer from "./timer";\njest.useFakeTimers();\n\ndescribe("timer", () => {\n  it(\'should resolve with "time out" after 3 seconds\', async () => {\n    const promise = timer(); // setTimeout \u88AB\u89F8\u767C\n    jest.advanceTimersByTime(3000); // \u2705 \u6A21\u64EC\u6642\u9593\u7D93\u904E 3 \u79D2\uFF0C\u5728 setTimeout \u88AB\u89F8\u767C\u5F8C\n    const result = await promise; // \u5F97\u5230\u7D50\u679C\n    expect(result).toBe("time out");\n  });\n});\n'})}),"\n",(0,t.jsx)(n.p,{children:"\u518D\u4F86\u5982\u679C\u6A21\u64EC\u6642\u9593\u5C0F\u65BC\u539F\u672C\u8A2D\u5B9A\u7684\u6642\u9593\uFF0C\u4E5F\u6703\u6E2C\u8A66\u5931\u6557\uFF0C\u56E0\u70BA\u5728\u6A21\u64EC\u7684\u6642\u9593\u4E0A\u6C92\u6709\u5230\u9054\u89F8\u767C setTimeout callback \u51FD\u5F0F\u7684\u6642\u9593\u9EDE\u3002"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:'it(\'should resolve with "time out" after 3 seconds\', async () => {\n  const promise = timer(); // setTimeout \u88AB\u89F8\u767C\n  jest.advanceTimersByTime(2000); // \u6A21\u64EC\u6642\u9593\u7D93\u904E 2 \u79D2\n  const result = await promise; // \u274C \u5F97\u4E0D\u5230\u56DE\u50B3\uFF0C\u6E2C\u8A66\u5931\u6557\n  expect(result).toBe("time out");\n});\n'})}),"\n",(0,t.jsx)(n.p,{children:"\u4E0D\u904E\u5982\u679C\u6A21\u64EC\u6642\u9593\u5927\u65BC\u539F\u672C\u8A2D\u5B9A\u7684\u6642\u9593\uFF0C\u5C31\u4E0D\u6703\u6709\u554F\u984C\uFF0C\u5C31\u7B97\u6642\u9593\u8D85\u904E\uFF0C\u4E5F\u6703\u7D93\u904E\u89F8\u767C\u51FD\u5F0F\u7684\u6642\u9593\u9EDE\u3002"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:'it(\'should resolve with "time out" after 3 seconds\', async () => {\n  const promise = timer(); // setTimeout \u88AB\u89F8\u767C\n  jest.advanceTimersByTime(10000); // \u6A21\u64EC\u6642\u9593\u7D93\u904E 10 \u79D2\n  const result = await promise; // \u2705 \u6703\u7D93\u904E 3 \u79D2\uFF0C\u5F97\u5230\u7D50\u679C\n  expect(result).toBe("time out");\n});\n'})}),"\n",(0,t.jsxs)(n.p,{children:["\u6700\u5F8C\u503C\u5F97\u6CE8\u610F\u7684\u662F\uFF0C\u5982\u679C\u6709\u591A\u500B\u8A08\u6642\u5668\uFF0C\u4E26\u4E14\u6642\u9593\u90FD\u662F\u76F8\u540C\u7684\uFF0C\u90A3\u9EBC\u9019\u4E9B\u8A08\u6642\u5668\u6703\u88AB",(0,t.jsx)(n.strong,{children:"\u4E00\u8D77"}),"\u89F8\u767C\uFF0C\u6240\u4EE5\u5982\u679C\u6709\u591A\u500B\u8A08\u6642\u5668\uFF0C\u4E26\u4E14\u6642\u9593\u4E0D\u540C\uFF0C\u5C31\u8981\u5206\u958B\u6A21\u64EC\u6642\u9593\u6E2C\u8A66\u3002"]}),"\n",(0,t.jsx)(n.h3,{id:"jestrunalltimers",children:"jest.runAllTimers"}),"\n",(0,t.jsxs)(n.p,{children:["\u5982\u679C\u4E0D\u60F3\u8981\u8A2D\u5B9A\u7D93\u904E\u7684\u6642\u9593\uFF0C\u53EF\u4EE5\u4F7F\u7528 ",(0,t.jsx)(n.code,{children:"jest.runAllTimers()"})," \u4F86\u6A21\u64EC\u6240\u6709\u6642\u9593\u7D93\u904E\uFF0C\u9019\u500B API \u6703\u8B93\u6240\u6709\u8A08\u6642\u5668\u90FD\u76F4\u63A5\u89F8\u767C\u51FD\u5F0F\u3002"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:'it(\'should resolve with "time out" after 3 seconds\', async () => {\n  const promise = timer();\n  jest.runAllTimer(); // \u6A21\u64EC\u6240\u6709\u6642\u9593\u7D93\u904E\n  const result = await promise;\n  expect(result).toBe("time out");\n});\n'})}),"\n",(0,t.jsx)(n.h3,{id:"jestclearalltimers",children:"jest.clearAllTimers"}),"\n",(0,t.jsxs)(n.p,{children:["\u6709\u6642\u5019\u9700\u8981\u6E05\u9664\u6240\u6709\u7684\u6A21\u64EC\u8A08\u6642\u5668\uFF0C\u53EF\u4EE5\u5728 beforeEach \u4E2D\u4F7F\u7528 ",(0,t.jsx)(n.code,{children:"jest.clearAllTimers()"})," \u4F86\u8B93\u6BCF\u6B21\u6E2C\u8A66\u90FD\u662F\u4E7E\u6DE8\u7684\u72C0\u614B\u3002"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"beforeEach(() => {\n  jest.clearAllTimers(); // \u6E05\u9664\u6240\u6709\u6A21\u64EC\u8A08\u6642\u5668\n});\n"})}),"\n",(0,t.jsx)(n.h2,{id:"jestmock-\u6A21\u7D44\u6A21\u64EC",children:"jest.mock (\u6A21\u7D44\u6A21\u64EC)"}),"\n",(0,t.jsxs)(n.p,{children:["\u5728\u5BEB\u6E2C\u8A66\u7684\u6642\u5019\uFF0C\u6700\u4E3B\u8981\u7684\u539F\u5247\u5C31\u662F",(0,t.jsx)(n.strong,{children:"\u6E2C\u8A66\u55AE\u4E00\u6027"}),"\uFF0C\u4E5F\u5C31\u662F\u8AAA\uFF0C\u6BCF\u500B\u6E2C\u8A66\u53EA\u6E2C\u8A66\u4E00\u500B\u529F\u80FD\uFF0C\u4E14\u4E0D\u6703\u56E0\u70BA\u6709\u5F15\u5165\u5176\u4ED6\u7684\u51FD\u5F0F\u6216\u662F\u6A21\u7D44\u800C\u5F71\u97FF\u6E2C\u8A66\u7D50\u679C\u3002\u6240\u4EE5\u5728\u6E2C\u8A66\u7684\u6642\u5019\uFF0C\u5E38\u5E38\u6703\u9700\u8981\u6A21\u64EC\u5176\u4ED6\u51FD\u5F0F\u6216\u6A21\u7D44\u7684\u56DE\u50B3\u503C\uFF0C\u8B93\u6211\u5011\u53EF\u4EE5\u5C08\u6CE8\u5728\u55AE\u4E00\u529F\u80FD\u7684\u6E2C\u8A66\u3002"]}),"\n",(0,t.jsx)(n.p,{children:"\u8209\u500B\u4F8B\u5B50\uFF0C\u5047\u8A2D\u4ECA\u5929\u6709\u4E00\u500B\u51FD\u5F0F"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",metastring:'title="printNumber.js"',children:'import randomNumber from "./randomNumber";\n\nfunction printRandomNumber() {\n  return "My number is " + randomNumber();\n}\n\nexport default printRandomNumber;\n'})}),"\n",(0,t.jsxs)(n.p,{children:["\u547C\u53EB ",(0,t.jsx)(n.code,{children:"printRandomNumber"})," \u6703\u5F97\u5230\u4E00\u500B\u5B57\u4E32 ",(0,t.jsx)(n.code,{children:"My number is <\u96A8\u6A5F\u6578\u5B57>"}),"\uFF0C",(0,t.jsx)(n.code,{children:"randomNumber"})," \u662F\u4E00\u500B\u56DE\u50B3\u96A8\u6A5F 0~100 \u6578\u5B57\u7684\u51FD\u5F0F\u3002"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",metastring:'title="randomNumber.js"',children:"function randomNumber() {\n  return Math.floor(Math.random() * 100);\n}\n\nexport default randomNumber;\n"})}),"\n",(0,t.jsxs)(n.p,{children:["\u73FE\u5728\u8981\u6E2C\u8A66 ",(0,t.jsx)(n.code,{children:"printRandomNumber"})," \u7684\u6642\u5019\uFF0C\u6211\u5011\u53EA\u60F3\u8981\u6E2C\u8A66\u56DE\u50B3\u7684\u5B57\u4E32\u662F\u5426\u6B63\u78BA\uFF0C\u4F46\u662F ",(0,t.jsx)(n.code,{children:"randomNumber"})," \u662F\u96A8\u6A5F\u7684\uFF0C\u6240\u4EE5\u6BCF\u6B21\u6E2C\u8A66\u90FD\u6703\u5F97\u5230\u4E0D\u540C\u7684\u7D50\u679C\uFF0C\u9019\u6642\u5019\u5C31\u53EF\u4EE5\u4F7F\u7528 ",(0,t.jsx)(n.code,{children:"jest.mock()"})," \u4F86\u6A21\u64EC ",(0,t.jsx)(n.code,{children:"./randomNumber"})," \u6A21\u7D44\uFF0C\u4E26\u4F7F\u7528 ",(0,t.jsx)(n.code,{children:"mockReturnValue"})," \u4F86\u6A21\u64EC\u56DE\u50B3\u503C\u3002"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",metastring:'title="printNumber.test.js"',children:'import printRandomNumber from "./printRandomNumber";\nimport randomNumber from "./randomNumber";\n\njest.mock("./randomNumber"); // \u6A21\u64EC ./randomNumber \u6A21\u7D44\n\ndescribe("printRandomNumber", () => {\n  it("should return \'My number is 10\'", () => {\n    randomNumber.mockReturnValue(50); // \u6A21\u64EC randomNumber \u56DE\u50B3 50\n    const result = printRandomNumber();\n    expect(result).toBe("My number is 50");\n  });\n});\n'})}),"\n",(0,t.jsx)(n.p,{children:"\u5229\u7528\u6A21\u64EC\u7684\u65B9\u5F0F\uFF0C\u628A\u4EFB\u4F55\u53EF\u80FD\u6703\u5F71\u97FF\u6E2C\u8A66\u7D50\u679C\u7684\u51FD\u5F0F\u6216\u6A21\u7D44\u90FD\u6A21\u64EC\u6389\uFF0C\u9019\u6A23\u5C31\u53EF\u4EE5\u5C08\u6CE8\u5728\u55AE\u4E00\u529F\u80FD\u7684\u6E2C\u8A66\u3002"}),"\n",(0,t.jsx)(n.h2,{id:"jestspyon-\u6A21\u7D44\u51FD\u5F0F\u6A21\u64EC",children:"jest.spyOn (\u6A21\u7D44\u51FD\u5F0F\u6A21\u64EC)"}),"\n",(0,t.jsxs)(n.p,{children:["\u525B\u525B\u4ECB\u7D39\u4E86 ",(0,t.jsx)(n.code,{children:"jest.mock"})," \u53EF\u4EE5\u6A21\u64EC\u6A21\u7D44\uFF0C\u4F46\u662F\u5982\u679C\u53EA\u60F3\u8981\u6A21\u64EC\u6A21\u7D44\u4E2D\u7684\u67D0\u500B\u51FD\u5F0F\uFF0C\u5C31\u53EF\u4EE5\u4F7F\u7528 ",(0,t.jsx)(n.code,{children:"jest.spyOn"})," \u4F86\u6A21\u64EC\u3002"]}),"\n",(0,t.jsxs)(n.p,{children:["\u4EE5\u525B\u525B\u7684\u4F8B\u5B50\u70BA\u4F8B\uFF0C\u73FE\u5728\u5728 ",(0,t.jsx)(n.code,{children:"./randomNumber"})," \u9664\u4E86 ",(0,t.jsx)(n.code,{children:"randomNumber"})," \u51FD\u5F0F\u4E4B\u5916\uFF0C\u9084\u6709\u4E00\u500B ",(0,t.jsx)(n.code,{children:"randomEvenNumber"})," \u51FD\u5F0F\uFF0C\u6703\u56DE\u50B3\u96A8\u6A5F\u7684 1~100 \u7684\u5076\u6578\u503C\u3002"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",metastring:'title="randomNumber.js"',children:"function randomNumber() {\n  return Math.floor(Math.random() * 100);\n}\n\nfunction randomEvenNumber() {\n  return Math.floor(Math.random() * 50) * 2;\n}\n\nexport default { randomNumber, randomEvenNumber };\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"printRandomNumber"})," \u51FD\u5F0F\u6539\u6210"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",metastring:'title="printNumber.js"',children:'import random from "./utils/randomNumber_jestSpyOn.js";\n\nfunction printRandomNumber() {\n  return `My number is ${random.randomNumber()}. My even number is ${random.randomEvenNumber()}`;\n}\n\nexport default printRandomNumber;\n'})}),"\n",(0,t.jsxs)(n.p,{children:["\u5728\u6E2C\u8A66\u6642\u5C31\u53EF\u4EE5\u4F7F\u7528 ",(0,t.jsx)(n.code,{children:"jest.spyOn"})," \u4F86\u6A21\u64EC ",(0,t.jsx)(n.code,{children:"./randomNumber"})," \u6A21\u7D44\u88E1\u7684\u51FD\u5F0F"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",metastring:'title="printNumber.test.js"',children:'import printRandomNumber from "./printRandomNumber_jestSpyOn";\nimport random from "./utils/randomNumber_jestSpyOn.js";\n\njest.spyOn(random, "randomNumber"); // \u6A21\u64EC randomNumber \u51FD\u5F0F\njest.spyOn(random, "randomEvenNumber"); // \u6A21\u64EC randomEvenNumber \u51FD\u5F0F\n\ndescribe("printRandomNumber function", () => {\n  it(\'if randomNumber is 50, printRandomNumber should return "My number is 50"\', () => {\n    random.randomNumber.mockReturnValue(51); // \u6A21\u64EC randomNumber \u56DE\u50B3 51\n    random.randomEvenNumber.mockReturnValue(52); // \u6A21\u64EC randomEvenNumber \u56DE\u50B3 52\n    const result = printRandomNumber();\n    expect(result).toEqual("My number is 51. My even number is 52");\n  });\n});\n'})}),"\n",(0,t.jsx)(n.h2,{id:"jestfn-\u51FD\u5F0F\u6A21\u64EC",children:"jest.fn (\u51FD\u5F0F\u6A21\u64EC)"}),"\n",(0,t.jsxs)(n.p,{children:["\u9664\u4E86 ",(0,t.jsx)(n.code,{children:"jest.spyOn"})," \u53EF\u4EE5\u6A21\u64EC\u6A21\u7D44\u88E1\u7684\u51FD\u5F0F\uFF0C",(0,t.jsx)(n.code,{children:"jest.fn"})," \u4E5F\u53EF\u4EE5\u6A21\u64EC\u51FD\u5F0F\u3002\u53EA\u8981\u628A ",(0,t.jsx)(n.code,{children:"jest.spyOn"})," \u8F49\u63DB\u6210\u4E0B\u9762\u9019\u6A23\u5C31\u53EF\u4EE5\u4E86"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",metastring:'title="printNumber.test.js"',children:'import random from "./utils/randomNumber_jestSpyOn.js";\n\nrandom.randomNumber = jest.fn(); // \u4F7F\u7528 jest.fn \u6A21\u64EC randomNumber \u51FD\u5F0F\nrandom.randomEvenNumber = jest.fn(); // \u4F7F\u7528 jest.fn \u6A21\u64EC randomEvenNumber \u51FD\u5F0F\n'})}),"\n",(0,t.jsxs)(n.p,{children:["\u9664\u6B64\u4E4B\u5916\uFF0C",(0,t.jsx)(n.code,{children:"jest.fn"})," \u4E5F\u53EF\u4EE5\u76F4\u63A5\u5EFA\u7ACB\u4E00\u500B\u65B0\u7684\u6A21\u64EC\u51FD\u5F0F\uFF0C\u50CF\u9019\u6A23\uFF1A"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:'describe("jest.mock test", () => {\n  it("mock return value is 50", () => {\n    const mockFn = jest.fn(); // \u5EFA\u7ACB\u6A21\u64EC\u51FD\u5F0F\n    mockFn.mockReturnValue(50); // \u6A21\u64EC\u56DE\u50B3\u503C\u70BA 50\n    expect(mockFn()).toEqual(50);\n  });\n});\n'})}),"\n",(0,t.jsxs)(n.p,{children:["\u8CE6\u4E88\u8B8A\u6578\u4E00\u500B ",(0,t.jsx)(n.code,{children:"jest.fn()"})," \u7684\u6A21\u64EC\u51FD\u5F0F\uFF0C\u9019\u6A23\u5C31\u53EF\u4EE5\u4F7F\u7528 ",(0,t.jsx)(n.code,{children:"mockReturnValue"})," \u7B49\u65B9\u6CD5\u4F86\u6A21\u64EC\u56DE\u50B3\u503C\u3002"]}),"\n",(0,t.jsxs)(n.p,{children:["\u9019\u6A23\u7684\u597D\u8655\u5C31\u662F\u5982\u679C\u51FD\u5F0F\u7684\u53C3\u6578\u6709\u51FD\u5F0F\uFF0C\u5C31\u53EF\u4EE5\u4F7F\u7528 ",(0,t.jsx)(n.code,{children:"jest.fn()"})," \u66FF\u63DB\u6389\u3002"]}),"\n",(0,t.jsxs)(n.p,{children:["\u4EE5\u4E0B\u9762\u70BA\u4F8B\uFF0C\u628A ",(0,t.jsx)(n.code,{children:"randomNumber"})," \u7576\u6210",(0,t.jsx)(n.code,{children:"printRandomNumber"})," \u7684\u51FD\u5F0F\u53C3\u6578\u50B3\u5165\u3002"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",metastring:'title="printNumber.js"',children:'function printRandomNumber(randomNumber) {\n  return "My number is " + randomNumber();\n}\n\nexport default printRandomNumber;\n'})}),"\n",(0,t.jsxs)(n.p,{children:["\u8981\u6E2C\u8A66\u7684\u6642\u5019\u5C31\u53EF\u4EE5\u4F7F\u7528 ",(0,t.jsx)(n.code,{children:"jest.fn()"})," \u4F86\u6A21\u64EC ",(0,t.jsx)(n.code,{children:"randomNumber"})," \u53C3\u6578\u7684\u56DE\u50B3\u503C"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",metastring:'title="printNumber.test.js"',children:'describe("printRandomNumber function", () => {\n  it(\'if randomNumber is 50, printRandomNumber should return "My number is 50"\', () => {\n    const mockRandomNumber = jest.fn(); // \u5EFA\u7ACB\u6A21\u64EC\u51FD\u5F0F\n    mockRandomNumber.mockReturnValue(50); // \u6A21\u64EC\u56DE\u50B3\u503C\u70BA 50\n    const result = printRandomNumber(mockRandomNumber); // \u5C07\u6A21\u64EC\u51FD\u5F0F\u7576\u6210\u53C3\u6578\u50B3\u5165\n    expect(result).toEqual("My number is 50");\n  });\n});\n'})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.p,{children:"\u4ECA\u5929\u8B1B\u4E86\u5F88\u591A Jest \u7684\u6A21\u64EC\u8A9E\u6CD5\uFF0C\u53EF\u4EE5\u8AAA\u6E2C\u8A66\u4E2D\u6700\u6838\u5FC3\u7684\u5C31\u662F\u6A21\u64EC\uFF0C\u597D\u7684\u6A21\u64EC\u53EF\u4EE5\u8B93\u6E2C\u8A66\u66F4\u52A0\u7684\u4E7E\u6DE8\uFF0C\u4E5F\u53EF\u4EE5\u8B93\u6E2C\u8A66\u66F4\u5C08\u6CE8\u5728\u55AE\u4E00\u529F\u80FD\u4E0A\uFF0C\u8B93\u6E2C\u8A66\u66F4\u52A0\u7684\u7A69\u5B9A\u3002"}),"\n",(0,t.jsxs)(n.p,{children:["\u96D6\u7136\u9019\u7BC7\u7684\u6A19\u984C\u662F Jest \u7684\u9032\u968E\u8A9E\u6CD5\uFF0C\u4F46\u5728\u5BE6\u969B\u6E2C\u8A66\u4E2D\u90FD\u662F\u5F88\u5E38\u6703\u7528\u5230\u7684\u8A9E\u6CD5\uFF0C\u9664\u6B64\u4E4B\u5916\uFF0C\u9084\u6709\u5F88\u591A\u7528\u6CD5\u662F\u6C92\u6709\u63D0\u5230\uFF0C\u6709\u8208\u8DA3\u7684\u53EF\u4EE5\u53C3\u8003",(0,t.jsx)(n.a,{href:"https://jestjs.io/docs/mock-functions",children:"\u5B98\u65B9\u6587\u4EF6"}),"\u3002"]}),"\n",(0,t.jsx)(n.p,{children:"\u90A3\u4ECA\u5929\u5C31\u4ECB\u7D39\u5230\u9019\u908A\uFF0C\u4E0B\u4E00\u7BC7\u4F86\u8B1B React \u7684\u6E2C\u8A66\u5B89\u88DD\u4ECB\u7D39\uFF5E"})]})}function h(e={}){let{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(j,{...e})}):j(e)}},144:function(e,n,r){r.d(n,{Z:function(){return i}});var s=r(5893);r(7294);var t=r(7227);function i(e){let{children:n,fallback:r}=e;return(0,t.Z)()?(0,s.jsx)(s.Fragment,{children:n?.()}):r??null}},9366:function(e,n,r){r.d(n,{Ei:function(){return m},gO:function(){return o},nI:function(){return d}});var s=r(5893),t=r(144),i=r(1094);r(7294);let m=e=>{let{src:n,width:r="100%",center:t=!1,style:i={}}=e,m={width:`min(100%,${r})`,display:t?"block":"inline-block",margin:t?"0 auto":"0",borderRadius:"5px",...i};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("img",{src:n,style:{...m}}),(0,s.jsx)("br",{}),(0,s.jsx)("br",{})]})},o=e=>{let{children:n,width:r="100%",center:m=!1,style:o={}}=e;return(0,s.jsx)(t.Z,{children:()=>{let{sm:e}=(0,i.Z)(),t={width:`min(100%,${r})`,margin:m?"0 auto":"0",display:"flex",flexDirection:e?"column":"row",gap:"10px",alignItems:"center",...o};return(0,s.jsx)("div",{style:{...t},children:n})}})},d=e=>{let{style:n,width:r="100%",src:t}=e,i={width:`min(100%,${r})`,flex:1,...n};return(0,s.jsx)("div",{style:{...i},children:(0,s.jsx)(m,{src:t})})}},1094:function(e,n,r){r.d(n,{Z:function(){return i}});var s=r(7294);let t=635,i=()=>{let[e,n]=(0,s.useState)({width:window.innerWidth,height:window.innerHeight}),[r,i]=(0,s.useState)(!1);return(0,s.useLayoutEffect)(()=>{let e=()=>{let{innerWidth:e,innerHeight:r}=window;n({width:e,height:r}),i(e<=t)};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[]),{sm:r,windowSize:e}}},65:function(e,n,r){r.d(n,{Z:function(){return o},a:function(){return m}});var s=r(7294);let t={},i=s.createContext(t);function m(e){let n=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:m(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);