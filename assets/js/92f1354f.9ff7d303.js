"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([["7277"],{8407:function(e,t,o){o.r(t),o.d(t,{metadata:()=>n,contentTitle:()=>c,default:()=>p,assets:()=>l,toc:()=>u,frontMatter:()=>r});var n=JSON.parse('{"id":"ithome2023/day19","title":"[Day 19] React + Jest Redux Toolkit \u6E2C\u8A66","description":"\u9019\u4E00\u7BC7\u7684\u6E2C\u8A66\u6BD4\u8F03\u504F\u5C08\u5C6C React \u7684 Redux Toolkit \u6E2C\u8A66\uFF0C\u5982\u679C\u6C92\u6709\u4F7F\u7528 Redux \u7684\u8A71\uFF0C\u53EF\u4EE5\u8DF3\u904E\u9019\u4E00\u7BC7\uFF5E","source":"@site/docs/ithome2023/day19.mdx","sourceDirName":"ithome2023","slug":"/ithome2023/day19","permalink":"/ithome2023/day19","draft":false,"unlisted":false,"tags":[{"inline":false,"label":"IT Home 2023","permalink":"/tags/ithome-2023","description":"IT Home \u9435\u4EBA\u8CFD 2023 \u5E74\u7CFB\u5217\u6587\u7AE0"}],"version":"current","lastUpdatedAt":1718173908000,"frontMatter":{"title":"[Day 19] React + Jest Redux Toolkit \u6E2C\u8A66","tags":["ithome2023"]},"sidebar":"tutorialSidebar","previous":{"title":" [Day 18] React + Jest API (MSW) \u6E2C\u8A66 (AI)","permalink":"/ithome2023/day18"},"next":{"title":"[Day 20] React + Jest Redux Toolkit \u6E2C\u8A66 (AI)","permalink":"/ithome2023/day20"}}'),d=o("5893"),i=o("65"),s=o("9366");let a=o.p+"assets/images/day19-1-55f481f8373bca7dc0afa46da83ef1a3.gif",r={title:"[Day 19] React + Jest Redux Toolkit \u6E2C\u8A66",tags:["ithome2023"]},c=void 0,l={},u=[{value:"\u7A0B\u5F0F\u78BC",id:"\u7A0B\u5F0F\u78BC",level:2},{value:"redux toolkit \u6E2C\u8A66",id:"redux-toolkit-\u6E2C\u8A66",level:2},{value:"TodoPage \u6E2C\u8A66",id:"todopage-\u6E2C\u8A66",level:2},{value:"\u7E3D\u7D50",id:"\u7E3D\u7D50",level:2}];function m(e){let t={a:"a",code:"code",h2:"h2",p:"p",pre:"pre",...(0,i.a)(),...e.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)(t.p,{children:["\u9019\u4E00\u7BC7\u7684\u6E2C\u8A66\u6BD4\u8F03\u504F\u5C08\u5C6C React \u7684 ",(0,d.jsx)(t.a,{href:"https://redux-toolkit.js.org/",children:"Redux Toolkit"})," \u6E2C\u8A66\uFF0C\u5982\u679C\u6C92\u6709\u4F7F\u7528 Redux \u7684\u8A71\uFF0C\u53EF\u4EE5\u8DF3\u904E\u9019\u4E00\u7BC7\uFF5E"]}),"\n",(0,d.jsx)(s.Ei,{src:a}),"\n",(0,d.jsx)(t.h2,{id:"\u7A0B\u5F0F\u78BC",children:"\u7A0B\u5F0F\u78BC"}),"\n",(0,d.jsxs)(t.p,{children:["\u4EE5 TodoList \u70BA\u4F8B\uFF0C\u6703\u6709\u4E00\u500B ",(0,d.jsx)(t.code,{children:"todoSlice"}),"\uFF0C\u88E1\u9762\u6709 ",(0,d.jsx)(t.code,{children:"addTodo"}),"\u3001",(0,d.jsx)(t.code,{children:"removeTodo"}),"\u3001",(0,d.jsx)(t.code,{children:"toggleTodo"})," \u4E09\u500B action\uFF0C\u6211\u5011\u6703\u6E2C\u8A66\u9019\u4E09\u500B action \u662F\u5426\u6B63\u5E38\u904B\u4F5C\u3002"]}),"\n",(0,d.jsx)(t.pre,{children:(0,d.jsx)(t.code,{className:"language-js",children:'export const todoSlice = createSlice({\n  name: "todo",\n  initialState,\n  reducers: {\n    addTodo: (state, action: PayloadAction<string>) => {\n      state.todoList.push({\n        title: action.payload,\n        id: Math.random(),\n        isDone: false,\n      });\n    },\n    removeTodo: (state, action: PayloadAction<number>) => {\n      state.todoList = state.todoList.filter(\n        (todo) => todo.id !== action.payload\n      );\n    },\n    toggleTodo: (state, action: PayloadAction<number>) => {\n      state.todoList = state.todoList.map((todo) =>\n        todo.id === action.payload ? { ...todo, isDone: !todo.isDone } : todo\n      );\n    },\n  },\n});\n'})}),"\n",(0,d.jsxs)(t.p,{children:["TodoPage \u5247\u6703\u4F7F\u7528\u5230 ",(0,d.jsx)(t.code,{children:"todoSlice"}),"\uFF0C\u4E26\u4E14\u4F7F\u7528 ",(0,d.jsx)(t.code,{children:"useSelector"})," \u53D6\u5F97 ",(0,d.jsx)(t.code,{children:"todoList"}),"\uFF0C\u4E26\u4E14\u4F7F\u7528 ",(0,d.jsx)(t.code,{children:"useDispatch"})," \u53BB dispatch action\u3002"]}),"\n",(0,d.jsx)(t.pre,{children:(0,d.jsx)(t.code,{className:"language-jsx",children:'import { addTodo, removeTodo, toggleTodo } from "@/store/todo";\nimport useAppDispatch from "@/utils/hooks/useAppDispatch";\nimport useAppSelector from "@/utils/hooks/useAppSelector";\nimport { useState } from "react";\nimport styled from "./index.module.scss";\n\nexport const TodoPage = () => {\n  const todoList = useAppSelector((state) => state.todo.todoList);\n  const dispatch = useAppDispatch();\n\n  const [todo, setTodo] = useState("");\n\n  const addTodoHandler = () => {\n    dispatch(addTodo(todo));\n    setTodo("");\n  };\n\n  return (\n    <div className={styled.container}>\n      <input\n        type=\'text\'\n        value={todo}\n        onChange={(e) => setTodo(e.target.value)}\n      />\n      <button onClick={addTodoHandler}>ADD</button>\n      {todoList.map((todo) => (\n        <li\n          key={todo.id}\n          className={\n            todo.isDone ? `${styled.todo} ${styled.done}` : styled.todo\n          }\n          onClick={() => dispatch(toggleTodo(todo.id))}\n        >\n          <input type=\'checkbox\' checked={todo.isDone} readOnly />\n          <span>{todo.title}</span>\n          <button onClick={() => dispatch(removeTodo(todo.id))}> remove</button>\n        </li>\n      ))}\n    </div>\n  );\n};\n'})}),"\n",(0,d.jsx)(t.p,{children:"\u5728\u6E2C\u8A66\u6642\uFF0C\u5C31\u6703\u5206\u5225\u5C31\u9019\u5169\u500B\u90E8\u5206\u9032\u884C\u6E2C\u8A66\u3002"}),"\n",(0,d.jsx)(t.h2,{id:"redux-toolkit-\u6E2C\u8A66",children:"redux toolkit \u6E2C\u8A66"}),"\n",(0,d.jsx)(t.pre,{children:(0,d.jsx)(t.code,{className:"language-jsx",children:'import todoSlice, { TodoState, addTodo, removeTodo, toggleTodo } from "./todo";\n\ndescribe("todoSlice", () => {\n  let initialState: { todoList: TodoState[] };\n  const todo1 = { id: 1, title: "Test Todo 1", isDone: false };\n  const todo2 = { id: 2, title: "Test Todo 2", isDone: false };\n  const todo3 = { id: 3, title: "Test Todo 3", isDone: false };\n  const state = { todoList: [todo1, todo2, todo3] };\n\n  beforeEach(() => {\n    initialState = { todoList: [] };\n  });\n\n  it("\u7576 addTodo \u51FD\u5F0F\u8F38\u5165 \'Test Todo\' todoList \u65B0\u589E\u4E00\u9805 todo title \u70BA Test Todo \u4E14 isDone \u70BA false", () => {\n    const actual = todoSlice.reducer(initialState, addTodo("Test Todo"));\n    expect(actual.todoList.length).toEqual(1);\n    expect(actual.todoList[0].title).toEqual("Test Todo");\n    expect(actual.todoList[0].isDone).toEqual(false);\n  });\n\n  it("\u7576 removeTodo \u51FD\u5F0F\u8F38\u5165 2 \u5247\u53EA\u79FB\u9664 id \u70BA 2 \u7684 todo", () => {\n    const actual = todoSlice.reducer(state, removeTodo(2));\n    expect(actual.todoList.length).toEqual(2);\n    expect(actual.todoList).toContain(todo1);\n    expect(actual.todoList).toContain(todo3);\n    expect(actual.todoList).not.toContain(todo2);\n  });\n\n  it("\u7576 toggleTodo \u51FD\u5F0F\u8F38\u5165 2 \u5247 id \u70BA 2 \u7684 todo isDone \u70BA true", () => {\n    const actual = todoSlice.reducer(state, toggleTodo(2));\n    expect(actual.todoList[1].isDone).toEqual(true);\n  });\n});\n'})}),"\n",(0,d.jsx)(t.p,{children:"\u4F9D\u64DA\u4E0D\u540C\u60C5\u6CC1\u7D66\u5165\u76F8\u5C0D\u61C9\u7684\u521D\u59CB\u503C\uFF0C\u4E26\u4E14\u6E2C\u8A66\u662F\u5426\u6709\u6B63\u78BA\u7684\u56DE\u50B3\u503C\u3002"}),"\n",(0,d.jsx)(t.h2,{id:"todopage-\u6E2C\u8A66",children:"TodoPage \u6E2C\u8A66"}),"\n",(0,d.jsx)(t.pre,{children:(0,d.jsx)(t.code,{className:"language-jsx",children:'import { render, screen } from "@testing-library/react";\nimport { Provider } from "react-redux";\nimport { store } from "@/store";\nimport { TodoPage } from ".";\nimport userEvent from "@testing-library/user-event";\n\ndescribe("TodoPage", () => {\n  const user = userEvent.setup();\n  beforeEach(() => {\n    render(\n      <Provider store={store}>\n        <TodoPage />\n      </Provider>\n    );\n  });\n\n  it("\u7576\u8F38\u5165\u300CNew Todo\u300D\u4E26\u9EDE\u64CA add \u6309\u9215\uFF0C\u986F\u793A\u300CNew Todo\u300D\u6587\u5B57", async () => {\n    const inputElement = screen.getByRole("textbox");\n    const addButtonElement = screen.getByRole("button", { name: /add/i });\n\n    await user.type(inputElement, "New Todo");\n    await user.click(addButtonElement);\n\n    const todoElement = screen.getByText("New Todo");\n    expect(todoElement).toBeInTheDocument();\n  });\n\n  it("\u7576\u9EDE\u64CA\u300CNew Todo\u300D\u6587\u5B57\uFF0Ccheckbox \u6703\u88AB\u52FE\u9078", async () => {\n    const todoElement = screen.getByText("New Todo");\n    await user.click(todoElement);\n\n    const checkboxElement = screen.getByRole("checkbox");\n    expect(checkboxElement).toBeChecked();\n  });\n\n  it("\u7576\u9EDE\u64CA remove \u6309\u9215\uFF0C\'New Todo\' \u6587\u5B57\u4E0D\u6703\u986F\u793A", async () => {\n    const removeButtonElement = screen.getByRole("button", { name: /remove/i });\n    await user.click(removeButtonElement);\n\n    const todoElement = screen.queryByText("New Todo");\n    expect(todoElement).not.toBeInTheDocument();\n  });\n});\n'})}),"\n",(0,d.jsx)(t.p,{children:"TodoPage \u5C31\u6703\u662F\u6E2C\u8A66\u4F7F\u7528\u8005\u64CD\u4F5C\u7684\u90E8\u5206\uFF0C\u662F\u5426\u6709\u6B63\u78BA\u7684 UI \u986F\u793A\u3001\u52FE\u9078\u3001\u79FB\u9664\u7B49\u7B49\u3002"}),"\n",(0,d.jsx)(t.h2,{id:"\u7E3D\u7D50",children:"\u7E3D\u7D50"}),"\n",(0,d.jsx)(t.p,{children:"Redux toolkit \u7684\u6E2C\u8A66\u4E4D\u807D\u4E4B\u4E0B\u597D\u50CF\u5F88\u96E3\u6E2C\uFF0C\u4E0D\u904E\u56E0\u70BA redux \u5C31\u662F\u5404\u7A2E\u51FD\u5F0F\u7D71\u4E00\u7BA1\u7406\uFF0C\u6240\u4EE5\u6E2C\u8A66\u8D77\u4F86\u4E5F\u4E0D\u6703\u592A\u96E3\uFF0C\u5C31\u50CF\u662F\u4E00\u822C\u7684\u51FD\u5F0F\u6E2C\u8A66\uFF0C\u53EA\u4E0D\u904E\u8981\u4F9D\u64DA\u4E0D\u540C\u7684\u60C5\u6CC1\u7D66\u5165\u4E0D\u540C\u7684\u521D\u59CB\u503C\uFF0C\u624D\u80FD\u6E2C\u8A66\u51FA\u4E0D\u540C\u7684\u7D50\u679C\u3002"})]})}function p(e={}){let{wrapper:t}={...(0,i.a)(),...e.components};return t?(0,d.jsx)(t,{...e,children:(0,d.jsx)(m,{...e})}):m(e)}},144:function(e,t,o){o.d(t,{Z:function(){return i}});var n=o(5893);o(7294);var d=o(7227);function i(e){let{children:t,fallback:o}=e;return(0,d.Z)()?(0,n.jsx)(n.Fragment,{children:t?.()}):o??null}},9366:function(e,t,o){o.d(t,{Ei:function(){return s},gO:function(){return a},nI:function(){return r}});var n=o(5893),d=o(144),i=o(1094);o(7294);let s=e=>{let{src:t,width:o="100%",center:d=!1,style:i={}}=e,s={width:`min(100%,${o})`,display:d?"block":"inline-block",margin:d?"0 auto":"0",borderRadius:"5px",...i};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("img",{src:t,style:{...s}}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{})]})},a=e=>{let{children:t,width:o="100%",center:s=!1,style:a={}}=e;return(0,n.jsx)(d.Z,{children:()=>{let{sm:e}=(0,i.Z)(),d={width:`min(100%,${o})`,margin:s?"0 auto":"0",display:"flex",flexDirection:e?"column":"row",gap:"10px",alignItems:"center",...a};return(0,n.jsx)("div",{style:{...d},children:t})}})},r=e=>{let{style:t,width:o="100%",src:d}=e,i={width:`min(100%,${o})`,flex:1,...t};return(0,n.jsx)("div",{style:{...i},children:(0,n.jsx)(s,{src:d})})}},1094:function(e,t,o){o.d(t,{Z:function(){return i}});var n=o(7294);let d=635,i=()=>{let[e,t]=(0,n.useState)({width:window.innerWidth,height:window.innerHeight}),[o,i]=(0,n.useState)(!1);return(0,n.useLayoutEffect)(()=>{let e=()=>{let{innerWidth:e,innerHeight:o}=window;t({width:e,height:o}),i(e<=d)};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[]),{sm:o,windowSize:e}}},65:function(e,t,o){o.d(t,{Z:function(){return a},a:function(){return s}});var n=o(7294);let d={},i=n.createContext(d);function s(e){let t=n.useContext(i);return n.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(d):e.components||d:s(e.components),n.createElement(i.Provider,{value:t},e.children)}}}]);